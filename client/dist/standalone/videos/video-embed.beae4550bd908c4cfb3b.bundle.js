!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/client/standalone/videos/",n(n.s=165)}([function(e,t,n){var r=n(9),i=n(8),o=n(28),s=n(14),a=n(36),u=function(e,t,n){var c,l,h,f,d=e&u.F,p=e&u.G,g=e&u.P,v=e&u.B,m=p?r:e&u.S?r[t]||(r[t]={}):(r[t]||{}).prototype,y=p?i:i[t]||(i[t]={}),_=y.prototype||(y.prototype={});for(c in p&&(n=t),n)h=((l=!d&&m&&void 0!==m[c])?m:n)[c],f=v&&l?a(h,r):g&&"function"==typeof h?a(Function.call,h):h,m&&s(m,c,h,e&u.U),y[c]!=h&&o(y,c,f),g&&_[c]!=h&&(_[c]=h)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){"use strict";(function(e){var r=n(322),i=n(323),o=n(139);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(r)return D(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function _(e,t,n,r){return H(D(t,e.length-n),e,n,r)}function b(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return b(e,t,n,r)}function E(e,t,n,r){return H(F(t),e,n,r)}function k(e,t,n,r){return H(function(e,t){for(var n,r,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i.push(n%256),i.push(r);return i}(t,e.length-n),e,n,r)}function T(e,t,n){return r.fromByteArray(0===t&&n===e.length?e:e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:s=e[i+2],128==(192&(o=e[i+1]))&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:s=e[i+2],a=e[i+3],128==(192&(o=e[i+1]))&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(r.push((l-=65536)>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?a(null,t):void 0!==n?"string"==typeof r?a(null,t).fill(n,r):a(null,t).fill(n):a(null,t)}(0,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=e.slice(t,n),h=0;h<a;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function x(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r,i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",s=t;s<n;++s)o+=(r=e[s])<16?"0"+r.toString(16):r.toString(16);return o}function O(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function L(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(e,t,n,r,o){return o||L(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,o){return o||L(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:D(new u(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function D(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(10))},function(e,t,n){e.exports=function(e,t){e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var n="7.3.0";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t,n){return(o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&i(o,n.prototype),o}).apply(null,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e,t){return t||(t=e.slice(0)),e.raw=t,e}var u=[],c=function t(n){var r,i="info",o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r("log",i,t)};return r=function(t,n){return function(r,i,o){var s=n.levels[i],a=new RegExp("^("+s+")$");if("log"!==r&&o.unshift(r.toUpperCase()+":"),o.unshift(t+":"),u&&u.push([].concat(o)),e.console){var c=e.console[r];c||"debug"!==r||(c=e.console.info||e.console.log),c&&s&&a.test(r)&&c[Array.isArray(o)?"apply":"call"](e.console,o)}}}(n,o),o.createLogger=function(e){return t(n+": "+e)},o.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},o.level=function(e){if("string"==typeof e){if(!o.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');i=e}return i},(o.history=function(){return u?[].concat(u):[]}).filter=function(e){return(u||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},o.history.clear=function(){u&&(u.length=0)},o.history.disable=function(){null!==u&&(u.length=0,u=null)},o.history.enable=function(){null===u&&(u=[])},o.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r("error",i,t)},o.warn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r("warn",i,t)},o.debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r("debug",i,t)},o}("VIDEOJS"),l=c.createLogger;function h(e){return e.replace(/\n\r?\s*/g,"")}var f=function(e){for(var t="",n=0;n<arguments.length;n++)t+=h(e[n])+(arguments[n+1]||"");return t},d=Object.prototype.toString,p=function(e){return m(e)?Object.keys(e):[]};function g(e,t){p(e).forEach(function(n){return t(e[n],n)})}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign?Object.assign.apply(Object,[e].concat(n)):(n.forEach(function(t){t&&g(t,function(t,n){e[n]=t})}),e)}function m(e){return!!e&&"object"==typeof e}function y(e){return m(e)&&"[object Object]"===d.call(e)&&e.constructor===Object}function _(t,n){if(!t||!n)return"";if("function"==typeof e.getComputedStyle){var r=e.getComputedStyle(t);return r?r[n]:""}return""}function b(){var e=a(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return b=function(){return e},e}function w(e){return"string"==typeof e&&/\S/.test(e)}function E(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function k(){return t===e.document}function T(e){return m(e)&&1===e.nodeType}function S(){try{return e.parent!==e.self}catch(e){return!0}}function C(e){return function(n,r){if(!w(n))return t[e](null);w(r)&&(r=t.querySelector(r));var i=T(r)?r:t;return i[e]&&i[e](n)}}function x(e,n,r,i){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===r&&(r={});var o=t.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(c.warn(f(b(),e,t)),o.setAttribute(e,t)):"textContent"===e?A(o,t):o[e]=t}),Object.getOwnPropertyNames(r).forEach(function(e){o.setAttribute(e,r[e])}),i&&G(o,i),o}function A(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function I(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function O(e,t){return E(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function P(e,t){return e.classList?e.classList.add(t):O(e,t)||(e.className=(e.className+" "+t).trim()),e}function R(e,t){return e.classList?e.classList.remove(t):(E(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function j(e,t,n){var r=O(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!r),n!==r)return n?P(e,t):R(e,t),e}function M(e,t){Object.getOwnPropertyNames(t).forEach(function(n){var r=t[n];null==r||!1===r?e.removeAttribute(n):e.setAttribute(n,!0===r?"":r)})}function L(e){var t={};if(e&&e.attributes&&e.attributes.length>0)for(var n=e.attributes,r=n.length-1;r>=0;r--){var i=n[r].name,o=n[r].value;"boolean"!=typeof e[i]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+i+",")||(o=null!==o),t[i]=o}return t}function B(e,t){return e.getAttribute(t)}function N(e,t,n){e.setAttribute(t,n)}function U(e,t){e.removeAttribute(t)}function D(){t.body.focus(),t.onselectstart=function(){return!1}}function F(){t.onselectstart=function(){return!0}}function H(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n.height||(n.height=parseFloat(_(e,"height"))),n.width||(n.width=parseFloat(_(e,"width"))),n}}function V(n){var r;if(n.getBoundingClientRect&&n.parentNode&&(r=n.getBoundingClientRect()),!r)return{left:0,top:0};var i=t.documentElement,o=t.body,s=r.top+(e.pageYOffset||o.scrollTop)-(i.clientTop||o.clientTop||0);return{left:Math.round(r.left+(e.pageXOffset||o.scrollLeft)-(i.clientLeft||o.clientLeft||0)),top:Math.round(s)}}function W(e,t){var n={},r=V(e),i=e.offsetWidth,o=e.offsetHeight,s=r.left,a=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,a=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(r.top-a+o)/o)),n.x=Math.max(0,Math.min(1,(u-s)/i)),n}function q(e){return m(e)&&3===e.nodeType}function z(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function K(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),T(e)||q(e)?e:"string"==typeof e&&/\S/.test(e)?t.createTextNode(e):void 0}).filter(function(e){return e})}function G(e,t){return K(t).forEach(function(t){return e.appendChild(t)}),e}function $(e,t){return G(z(e),t)}function Y(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons}var X=C("querySelector"),J=C("querySelectorAll"),Q=Object.freeze({isReal:k,isEl:T,isInFrame:S,createEl:x,textContent:A,prependTo:I,hasClass:O,addClass:P,removeClass:R,toggleClass:j,setAttributes:M,getAttributes:L,getAttribute:B,setAttribute:N,removeAttribute:U,blockTextSelection:D,unblockTextSelection:F,getBoundingClientRect:H,findPosition:V,getPointerPosition:W,isTextNode:q,emptyEl:z,normalizeContent:K,appendContent:G,insertContent:$,isSingleLeftClick:Y,$:X,$$:J}),Z=1;function ee(){return Z++}var te={},ne="vdata"+(new Date).getTime();function re(e){var t=e[ne];return t||(t=e[ne]=ee()),te[t]||(te[t]={}),te[t]}function ie(e){var t=e[ne];return!!t&&!!Object.getOwnPropertyNames(te[t]).length}function oe(e){var t=e[ne];if(t){delete te[t];try{delete e[ne]}catch(t){e.removeAttribute?e.removeAttribute(ne):e[ne]=null}}}function se(e,t){var n=re(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&oe(e)}function ae(e,t,n,r){n.forEach(function(n){e(t,n,r)})}function ue(n){function r(){return!0}function i(){return!1}if(!n||!n.isPropagationStopped){var o=n||e.event;for(var s in n={},o)"layerX"!==s&&"layerY"!==s&&"keyLocation"!==s&&"webkitMovementX"!==s&&"webkitMovementY"!==s&&("returnValue"===s&&o.preventDefault||(n[s]=o[s]));if(n.target||(n.target=n.srcElement||t),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){o.preventDefault&&o.preventDefault(),n.returnValue=!1,o.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){o.stopPropagation&&o.stopPropagation(),n.cancelBubble=!0,o.cancelBubble=!0,n.isPropagationStopped=r},n.isPropagationStopped=i,n.stopImmediatePropagation=function(){o.stopImmediatePropagation&&o.stopImmediatePropagation(),n.isImmediatePropagationStopped=r,n.stopPropagation()},n.isImmediatePropagationStopped=i,null!=n.clientX){var a=t.documentElement,u=t.body;n.pageX=n.clientX+(a&&a.scrollLeft||u&&u.scrollLeft||0)-(a&&a.clientLeft||u&&u.clientLeft||0),n.pageY=n.clientY+(a&&a.scrollTop||u&&u.scrollTop||0)-(a&&a.clientTop||u&&u.clientTop||0)}n.which=n.charCode||n.keyCode,null!=n.button&&(n.button=1&n.button?0:4&n.button?1:2&n.button?2:0)}return n}var ce=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){ce=!0}});e.addEventListener("test",null,t),e.removeEventListener("test",null,t)}catch(e){}}();var le=["touchstart","touchmove"];function he(e,t,n){if(Array.isArray(t))return ae(he,e,t,n);var r=re(e);if(r.handlers||(r.handlers={}),r.handlers[t]||(r.handlers[t]=[]),n.guid||(n.guid=ee()),r.handlers[t].push(n),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,n){if(!r.disabled){t=ue(t);var i=r.handlers[t.type];if(i)for(var o=i.slice(0),s=0,a=o.length;s<a&&!t.isImmediatePropagationStopped();s++)try{o[s].call(e,t,n)}catch(e){c.error(e)}}}),1===r.handlers[t].length)if(e.addEventListener){var i=!1;ce&&le.indexOf(t)>-1&&(i={passive:!0}),e.addEventListener(t,r.dispatcher,i)}else e.attachEvent&&e.attachEvent("on"+t,r.dispatcher)}function fe(e,t,n){if(ie(e)){var r=re(e);if(r.handlers){if(Array.isArray(t))return ae(fe,e,t,n);var i=function(e,t){r.handlers[t]=[],se(e,t)};if(void 0!==t){var o=r.handlers[t];if(o)if(n){if(n.guid)for(var s=0;s<o.length;s++)o[s].guid===n.guid&&o.splice(s--,1);se(e,t)}else i(e,t)}else for(var a in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},a)&&i(e,a)}}}function de(e,t,n){var r=ie(e)?re(e):{},i=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ue(t),r.dispatcher&&r.dispatcher.call(e,t,n),i&&!t.isPropagationStopped()&&!0===t.bubbles)de.call(null,i,t,n);else if(!i&&!t.defaultPrevented){var o=re(t.target);t.target[t.type]&&(o.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),o.disabled=!1)}return!t.defaultPrevented}function pe(e,t,n){if(Array.isArray(t))return ae(pe,e,t,n);var r=function r(){fe(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||ee(),he(e,t,r)}var ge,ve=Object.freeze({fixEvent:ue,on:he,off:fe,trigger:de,one:pe}),me=!1,ye=function(){if(k()&&!1!==ge.options.autoSetup){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),n=Array.prototype.slice.call(t.getElementsByTagName("audio")),r=Array.prototype.slice.call(t.getElementsByTagName("video-js")),i=e.concat(n,r);if(i&&i.length>0)for(var o=0,s=i.length;o<s;o++){var a=i[o];if(!a||!a.getAttribute){_e(1);break}void 0===a.player&&null!==a.getAttribute("data-setup")&&ge(a)}else me||_e(1)}};function _e(t,n){n&&(ge=n),e.setTimeout(ye,t)}k()&&"complete"===t.readyState?me=!0:pe(e,"load",function(){me=!0});var be,we=function(e){var n=t.createElement("style");return n.className=e,n},Ee=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},ke=function(e,t,n){t.guid||(t.guid=ee());var r=function(){return t.apply(e,arguments)};return r.guid=n?n+"_"+t.guid:t.guid,r},Te=function(e,t){var n=Date.now();return function(){var r=Date.now();r-n>=t&&(e.apply(void 0,arguments),n=r)}},Se=function(t,n,r,i){var o;void 0===i&&(i=e);var s=function(){var e=this,s=arguments,a=function(){o=null,a=null,r||t.apply(e,s)};!o&&r&&t.apply(e,s),i.clearTimeout(o),o=i.setTimeout(a,n)};return s.cancel=function(){i.clearTimeout(o),o=null},s},Ce=function(){};Ce.prototype.allowedEvents_={},Ce.prototype.addEventListener=Ce.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},he(this,e,t),this.addEventListener=n},Ce.prototype.removeEventListener=Ce.prototype.off=function(e,t){fe(this,e,t)},Ce.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},pe(this,e,t),this.addEventListener=n},Ce.prototype.dispatchEvent=Ce.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=ue(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),de(this,e)},Ce.prototype.queueTrigger=function(t){var n=this;be||(be=new Map);var r=t.type||t,i=be.get(this);i||(i=new Map,be.set(this,i));var o=i.get(r);i.delete(r),e.clearTimeout(o);var s=e.setTimeout(function(){0===i.size&&(i=null,be.delete(n)),n.trigger(t)},0);i.set(r,s)};var xe=function(e){return e instanceof Ce||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"==typeof e[t]})},Ae=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Ie=function(e){if(!e.nodeName&&!xe(e))throw new Error("Invalid target; must be a DOM node or evented object.")},Oe=function(e){if(!Ae(e))throw new Error("Invalid event type; must be a non-empty string or array.")},Pe=function(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")},Re=function(e,t){var n,r,i,o=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return o?(n=e.eventBusEl_,t.length>=3&&t.shift(),r=t[0],i=t[1]):(n=t[0],r=t[1],i=t[2]),Ie(n),Oe(r),Pe(i),{isTargetingSelf:o,target:n,type:r,listener:i=ke(e,i)}},je=function(e,t,n,r){Ie(e),e.nodeName?ve[t](e,n,r):e[t](n,r)},Me={on:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Re(this,n),o=i.isTargetingSelf,s=i.target,a=i.type,u=i.listener;if(je(s,"on",a,u),!o){var c=function(){return e.off(s,a,u)};c.guid=u.guid;var l=function(){return e.off("dispose",c)};l.guid=u.guid,je(this,"on","dispose",c),je(s,"on","dispose",l)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Re(this,n),o=i.target,s=i.type,a=i.listener;if(i.isTargetingSelf)je(o,"one",s,a);else{var u=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];a.apply(null,r)};u.guid=a.guid,je(o,"one",s,u)}},off:function(e,t,n){if(!e||Ae(e))fe(this.eventBusEl_,e,t);else{var r=e,i=t;Ie(r),Oe(i),Pe(n),n=ke(this,n),this.off("dispose",n),r.nodeName?(fe(r,i,n),fe(r,"dispose",n)):xe(r)&&(r.off(i,n),r.off("dispose",n))}},trigger:function(e,t){return de(this.eventBusEl_,e,t)}};function Le(t,n){void 0===n&&(n={});var r=n.eventBusKey;if(r){if(!t[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');t.eventBusEl_=t[r]}else t.eventBusEl_=x("span",{className:"vjs-event-bus"});return v(t,Me),t.on("dispose",function(){t.off(),e.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Be={state:{},setState:function(e){var t,n=this;return"function"==typeof e&&(e=e()),g(e,function(e,r){n.state[r]!==e&&((t=t||{})[r]={from:n.state[r],to:e}),n.state[r]=e}),t&&xe(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Ne(e,t){return v(e,Be),e.state=v({},e.state,t),"function"==typeof e.handleStateChanged&&xe(e)&&e.on("statechanged",e.handleStateChanged),e}function Ue(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)}function De(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach(function(t){t&&g(t,function(t,n){y(t)?(y(e[n])||(e[n]={}),e[n]=De(e[n],t)):e[n]=t})}),e}var Fe=function(){function t(e,t,n){if(this.player_=!e&&this.play?e=this:e,this.options_=De({},this.options_),t=this.options_=De(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+ee()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Le(this,{eventBusKey:this.el_?"el_":null}),Ne(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var n=t.prototype;return n.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),oe(this.el_),this.el_=null),this.player_=null},n.player=function(){return this.player_},n.options=function(e){return c.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),e?(this.options_=De(this.options_,e),this.options_):this.options_},n.el=function(){return this.el_},n.createEl=function(e,t,n){return x(e,t,n)},n.localize=function(e,t,n){void 0===n&&(n=e);var r=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages(),o=i&&i[r],s=r&&r.split("-")[0],a=i&&i[s],u=n;return o&&o[e]?u=o[e]:a&&a[e]&&(u=a[e]),t&&(u=u.replace(/\{(\d+)\}/g,function(e,n){var r=t[n-1],i=r;return void 0===r&&(i=e),i})),u},n.contentEl=function(){return this.contentEl_||this.el_},n.id=function(){return this.id_},n.name=function(){return this.name_},n.children=function(){return this.children_},n.getChildById=function(e){return this.childIndex_[e]},n.getChild=function(e){if(e)return e=Ue(e),this.childNameIndex_[e]},n.addChild=function(e,n,r){var i,o;if(void 0===n&&(n={}),void 0===r&&(r=this.children_.length),"string"==typeof e){o=Ue(e);var s=n.componentClass||o;n.name=o;var a=t.getComponent(s);if(!a)throw new Error("Component "+s+" does not exist");if("function"!=typeof a)return null;i=new a(this.player_||this,n)}else i=e;if(this.children_.splice(r,0,i),"function"==typeof i.id&&(this.childIndex_[i.id()]=i),(o=o||i.name&&Ue(i.name()))&&(this.childNameIndex_[o]=i),"function"==typeof i.el&&i.el()){var u=this.contentEl().children[r]||null;this.contentEl().insertBefore(i.el(),u)}return i},n.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){this.childIndex_[e.id()]=null,this.childNameIndex_[e.name()]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},n.initChildren=function(){var e=this,n=this.options_.children;if(n){var r,i=this.options_,o=t.getComponent("Tech");(r=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter(function(e){return!r.some(function(t){return"string"==typeof t?e===t:e===t.name})})).map(function(t){var r,i;return"string"==typeof t?i=n[r=t]||e.options_[r]||{}:(r=t.name,i=t),{name:r,opts:i}}).filter(function(e){var n=t.getComponent(e.opts.componentClass||Ue(e.name));return n&&!o.isTech(n)}).forEach(function(t){var n=t.name,r=t.opts;if(void 0!==i[n]&&(r=i[n]),!1!==r){!0===r&&(r={}),r.playerOptions=e.options_.playerOptions;var o=e.addChild(n,r);o&&(e[n]=o)}})}},n.buildCSSClass=function(){return""},n.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},n.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},n.$=function(e,t){return X(e,t||this.contentEl())},n.$$=function(e,t){return J(e,t||this.contentEl())},n.hasClass=function(e){return O(this.el_,e)},n.addClass=function(e){P(this.el_,e)},n.removeClass=function(e){R(this.el_,e)},n.toggleClass=function(e,t){j(this.el_,e,t)},n.show=function(){this.removeClass("vjs-hidden")},n.hide=function(){this.addClass("vjs-hidden")},n.lockShowing=function(){this.addClass("vjs-lock-showing")},n.unlockShowing=function(){this.removeClass("vjs-lock-showing")},n.getAttribute=function(e){return B(this.el_,e)},n.setAttribute=function(e,t){N(this.el_,e,t)},n.removeAttribute=function(e){U(this.el_,e)},n.width=function(e,t){return this.dimension("width",e,t)},n.height=function(e,t){return this.dimension("height",e,t)},n.dimensions=function(e,t){this.width(e,!0),this.height(t)},n.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),this.el_.style[e]=-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?t:"auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],i=r.indexOf("px");return-1!==i?parseInt(r.slice(0,i),10):parseInt(this.el_["offset"+Ue(e)],10)},n.currentDimension=function(t){var n=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof e.getComputedStyle){var r=e.getComputedStyle(this.el_);n=r.getPropertyValue(t)||r[t]}if(0===(n=parseFloat(n))){var i="offset"+Ue(t);n=this.el_[i]}return n},n.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},n.currentWidth=function(){return this.currentDimension("width")},n.currentHeight=function(){return this.currentDimension("height")},n.focus=function(){this.el_.focus()},n.blur=function(){this.el_.blur()},n.emitTapEvents=function(){var e,t=0,n=null;this.on("touchstart",function(r){1===r.touches.length&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},t=(new Date).getTime(),e=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)e=!1;else if(n){var r=t.touches[0].pageX-n.pageX,i=t.touches[0].pageY-n.pageY;Math.sqrt(r*r+i*i)>10&&(e=!1)}});var r=function(){e=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(r){n=null,!0===e&&(new Date).getTime()-t<200&&(r.preventDefault(),this.trigger("tap"))})},n.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=ke(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},n.setTimeout=function(t,n){var r,i,o=this;return t=ke(this,t),r=e.setTimeout(function(){o.off("dispose",i),t()},n),(i=function(){return o.clearTimeout(r)}).guid="vjs-timeout-"+r,this.on("dispose",i),r},n.clearTimeout=function(t){e.clearTimeout(t);var n=function(){};return n.guid="vjs-timeout-"+t,this.off("dispose",n),t},n.setInterval=function(t,n){var r=this;t=ke(this,t);var i=e.setInterval(t,n),o=function(){return r.clearInterval(i)};return o.guid="vjs-interval-"+i,this.on("dispose",o),i},n.clearInterval=function(t){e.clearInterval(t);var n=function(){};return n.guid="vjs-interval-"+t,this.off("dispose",n),t},n.requestAnimationFrame=function(t){var n,r,i=this;return this.supportsRaf_?(t=ke(this,t),n=e.requestAnimationFrame(function(){i.off("dispose",r),t()}),(r=function(){return i.cancelAnimationFrame(n)}).guid="vjs-raf-"+n,this.on("dispose",r),n):this.setTimeout(t,1e3/60)},n.cancelAnimationFrame=function(t){if(this.supportsRaf_){e.cancelAnimationFrame(t);var n=function(){};return n.guid="vjs-raf-"+t,this.off("dispose",n),t}return this.clearTimeout(t)},t.registerComponent=function(e,n){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var r=t.getComponent("Tech"),i=r&&r.isTech(n),o=t===n||t.prototype.isPrototypeOf(n.prototype);if(i||!o)throw new Error('Illegal component, "'+e+'"; '+(i?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");e=Ue(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var a=s.players,u=Object.keys(a);if(a&&u.length>0&&u.map(function(e){return a[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=n,n},t.getComponent=function(e){if(e)return e=Ue(e),t.components_&&t.components_[e]?t.components_[e]:void 0},t}();Fe.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame,Fe.registerComponent("Component",Fe);var He,Ve=e.navigator&&e.navigator.userAgent||"",We=/AppleWebKit\/([\d.]+)/i.exec(Ve),qe=We?parseFloat(We.pop()):null,ze=/iPad/i.test(Ve),Ke=/iPhone/i.test(Ve)&&!ze,Ge=/iPod/i.test(Ve),$e=Ke||ze||Ge,Ye=(He=Ve.match(/OS (\d+)_/i))&&He[1]?He[1]:null,Xe=/Android/i.test(Ve),Je=function(){var e=Ve.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Qe=Xe&&Je<5&&qe<537,Ze=/Firefox/i.test(Ve),et=/Edge/i.test(Ve),tt=!et&&(/Chrome/i.test(Ve)||/CriOS/i.test(Ve)),nt=function(){var e=Ve.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),rt=function(){var e=/MSIE\s(\d+)\.\d/.exec(Ve),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Ve)&&/rv:11.0/.test(Ve)&&(t=11),t}(),it=/Safari/i.test(Ve)&&!tt&&!Xe&&!et,ot=(it||$e)&&!tt,st=k()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),at=Object.freeze({IS_IPAD:ze,IS_IPHONE:Ke,IS_IPOD:Ge,IS_IOS:$e,IOS_VERSION:Ye,IS_ANDROID:Xe,ANDROID_VERSION:Je,IS_NATIVE_ANDROID:Qe,IS_FIREFOX:Ze,IS_EDGE:et,IS_CHROME:tt,CHROME_VERSION:nt,IE_VERSION:rt,IS_SAFARI:it,IS_ANY_SAFARI:ot,TOUCH_ENABLED:st});function ut(e,t,n,r){return function(e,t,n){if("number"!=typeof r||r<0||r>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+r+") is non-numeric or out of bounds (0-"+n+").")}(e,0,n.length-1),n[r][t]}function ct(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ut.bind(null,"start",0,e),end:ut.bind(null,"end",1,e)}}function lt(e,t){return Array.isArray(e)?ct(e):void 0===e||void 0===t?ct():ct([[e,t]])}function ht(e,t){var n,r,i=0;if(!t)return 0;e&&e.length||(e=lt(0,0));for(var o=0;o<e.length;o++)n=e.start(o),(r=e.end(o))>t&&(r=t),i+=r-n;return i/t}for(var ft,dt={},pt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],gt=pt[0],vt=0;vt<pt.length;vt++)if(pt[vt][1]in t){ft=pt[vt];break}if(ft)for(var mt=0;mt<ft.length;mt++)dt[gt[mt]]=ft[mt];function yt(e){if(e instanceof yt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:m(e)&&("number"==typeof e.code&&(this.code=e.code),v(this,e)),this.message||(this.message=yt.defaultMessages[this.code]||"")}yt.prototype.code=0,yt.prototype.message="",yt.prototype.status=null,yt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],yt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var _t=0;_t<yt.errorTypes.length;_t++)yt[yt.errorTypes[_t]]=_t,yt.prototype[yt.errorTypes[_t]]=_t;function bt(e){return null!=e&&"function"==typeof e.then}function wt(e){bt(e)&&e.then(null,function(e){})}var Et=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,n,r){return e[n]&&(t[n]=e[n]),t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})},kt="vjs-modal-dialog",Tt=function(n){function i(e,t){var r;return(r=n.call(this,e,t)||this).opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=x("div",{className:kt+"-content"},{role:"document"}),r.descEl_=x("p",{className:kt+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),A(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}r(i,n);var o=i.prototype;return o.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},o.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,n.prototype.dispose.call(this)},o.buildCSSClass=function(){return kt+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},o.handleKeyPress=function(e){27===e.which&&this.closeable()&&this.close()},o.label=function(){return this.localize(this.options_.label||"Modal Window")},o.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},o.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",ke(this,this.handleKeyPress)),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},o.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},o.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",ke(this,this.handleKeyPress)),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},o.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var r=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},o.fill=function(){this.fillWith(this.content())},o.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),$(t,e),this.trigger("modalfill"),r?n.insertBefore(t,r):n.appendChild(t);var i=this.getChild("closeButton");i&&n.appendChild(i.el_)},o.empty=function(){this.trigger("beforemodalempty"),z(this.contentEl()),this.trigger("modalempty")},o.content=function(e){return void 0!==e&&(this.content_=e),this.content_},o.conditionalFocus_=function(){var e=t.activeElement,n=this.player_.el_;this.previouslyActiveEl_=null,(n.contains(e)||n===e)&&(this.previouslyActiveEl_=e,this.focus(),this.on(t,"keydown",this.handleKeyDown))},o.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(t,"keydown",this.handleKeyDown)},o.handleKeyDown=function(e){if(9===e.which){for(var n,r=this.focusableEls_(),i=this.el_.querySelector(":focus"),o=0;o<r.length;o++)if(i===r[o]){n=o;break}t.activeElement===this.el_&&(n=0),e.shiftKey&&0===n?(r[r.length-1].focus(),e.preventDefault()):e.shiftKey||n!==r.length-1||(r[0].focus(),e.preventDefault())}},o.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},i}(Fe);Tt.prototype.options_={pauseOnOpen:!0,temporary:!0},Fe.registerComponent("ModalDialog",Tt);var St=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(s(s(n)),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)n.addTrack(t[r]);return n}r(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack"}))},n.removeTrack=function(e){for(var t,n=0,r=this.length;n<r;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack"})},n.getTrackById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},t}(Ce);for(var Ct in St.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},St.prototype.allowedEvents_)St.prototype["on"+Ct]=null;var xt=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},At=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].enabled){xt(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,n}return r(t,e),t.prototype.addTrack=function(t){var n=this;t.enabled&&xt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&t.addEventListener("enabledchange",function(){n.changing_||(n.changing_=!0,xt(n,t),n.changing_=!1,n.trigger("change"))})},t}(St),It=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},Ot=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].selected){It(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(s(s(n)),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}return r(t,e),t.prototype.addTrack=function(t){var n=this;t.selected&&It(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&t.addEventListener("selectedchange",function(){n.changing_||(n.changing_=!0,It(n,t),n.changing_=!1,n.trigger("change"))})},t}(St),Pt=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.addTrack=function(t){e.prototype.addTrack.call(this,t),t.addEventListener("modechange",ke(this,function(){this.queueTrigger("change")})),-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",ke(this,function(){this.trigger("selectedlanguagechange")}))},t}(St),Rt=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,r=this.trackElements_.length;n<r;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_.splice(t,1);break}},e}(),jt=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,r=e.length;this.cues_=e,this.length_=e.length;var i=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<r)for(n=t;n<r;n++)i.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},e}(),Mt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Lt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Bt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Nt={disabled:"disabled",hidden:"hidden",showing:"showing"},Ut=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var r={id:t.id||"vjs_track_"+ee(),kind:t.kind||"",label:t.label||"",language:t.language||""},i=function(e){Object.defineProperty(s(s(n)),e,{get:function(){return r[e]},set:function(){}})};for(var o in r)i(o);return n}return r(t,e),t}(Ce),Dt=function(n){var r=["protocol","hostname","port","pathname","search","hash","host"],i=t.createElement("a");i.href=n;var o,s=""===i.host&&"file:"!==i.protocol;s&&((o=t.createElement("div")).innerHTML='<a href="'+n+'"></a>',i=o.firstChild,o.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(o));for(var a={},u=0;u<r.length;u++)a[r[u]]=i[r[u]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=e.location.protocol),s&&t.body.removeChild(o),a},Ft=function(e){if(!e.match(/^https?:\/\//)){var n=t.createElement("div");n.innerHTML='<a href="'+e+'">x</a>',e=n.firstChild.href}return e},Ht=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);if(t)return t.pop().toLowerCase()}return""},Vt=function(t){var n=e.location,r=Dt(t);return(":"===r.protocol?n.protocol:r.protocol)+r.host!==n.protocol+n.host},Wt=Object.freeze({parseUrl:Dt,getAbsoluteURL:Ft,getFileExtension:Ht,isCrossOrigin:Vt}),qt=function(e){var t=zt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},zt=Object.prototype.toString;function Kt(e,t){return e(t={exports:{}},t.exports),t.exports}var Gt=Kt(function(e,t){(t=e.exports=function(e){return e.replace(/^\s*|\s*$/g,"")}).left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}}),$t=Function.prototype.toString,Yt=/^\s*class\b/,Xt=function(e){try{var t=$t.call(e);return Yt.test(t)}catch(e){return!1}},Jt=Object.prototype.toString,Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,Zt=Object.prototype.toString,en=Object.prototype.hasOwnProperty,tn=function(e){if(!e)return{};var t={};return function(e,t,n){if(!function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(Qt)return function(e){try{return!Xt(e)&&($t.call(e),!0)}catch(e){return!1}}(e);if(Xt(e))return!1;var t=Jt.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}(t))throw new TypeError("iterator must be a function");var r;arguments.length>=3&&(r=n),"[object Array]"===Zt.call(e)?function(e,t,n){for(var r=0,i=e.length;r<i;r++)en.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,r):"string"==typeof e?function(e,t,n){for(var r=0,i=e.length;r<i;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,r):function(e,t,n){for(var r in e)en.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,r)}(Gt(e).split("\n"),function(e){var n=e.indexOf(":"),r=Gt(e.slice(0,n)).toLowerCase(),i=Gt(e.slice(n+1));void 0===t[r]?t[r]=i:"[object Array]"===Object.prototype.toString.call(t[r])?t[r].push(i):t[r]=[t[r],i]}),t},nn=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)rn.call(n,r)&&(e[r]=n[r])}return e},rn=Object.prototype.hasOwnProperty,on=an;function sn(e,t,n){var r=e;return qt(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=nn(t,{uri:e}),r.callback=n,r}function an(e,t,n){return un(t=sn(e,t,n))}function un(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,i){t||(t=!0,e.callback(n,r,i))};function r(e){return clearTimeout(u),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,g)}function i(){if(!s){var t;clearTimeout(u);var r=g,i=null;return 0!==(t=e.useXDR&&void 0===a.status?200:1223===a.status?204:a.status)?(r={body:function(){var e=void 0;if(e=a.response?a.response:a.responseText||function(e){return"document"===e.responseType?e.responseXML:""!==e.responseType||e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName?null:e.responseXML}(a),p)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:l,headers:{},url:c,rawRequest:a},a.getAllResponseHeaders&&(r.headers=tn(a.getAllResponseHeaders()))):i=new Error("Internal XMLHttpRequest Error"),n(i,r,r.body)}}var o,s,a=e.xhr||null;a||(a=e.cors||e.useXDR?new an.XDomainRequest:new an.XMLHttpRequest);var u,c=a.url=e.uri||e.url,l=a.method=e.method||"GET",h=e.body||e.data,f=a.headers=e.headers||{},d=!!e.sync,p=!1,g={body:void 0,headers:{},statusCode:0,method:l,url:c,rawRequest:a};if("json"in e&&!1!==e.json&&(p=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==l&&"HEAD"!==l&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),a.onreadystatechange=function(){4===a.readyState&&setTimeout(i,0)},a.onload=i,a.onerror=r,a.onprogress=function(){},a.onabort=function(){s=!0},a.ontimeout=r,a.open(l,c,!d,e.username,e.password),d||(a.withCredentials=!!e.withCredentials),!d&&e.timeout>0&&(u=setTimeout(function(){if(!s){s=!0,a.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",r(e)}},e.timeout)),a.setRequestHeader)for(o in f)f.hasOwnProperty(o)&&a.setRequestHeader(o,f[o]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(a.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(a),a.send(h||null),a}an.XMLHttpRequest=e.XMLHttpRequest||function(){},an.XDomainRequest="withCredentials"in new an.XMLHttpRequest?an.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(e){an["delete"===e?"del":e]=function(t,n,r){return(n=sn(t,n,r)).method=e.toUpperCase(),un(n)}});var cn=function(t,n){var r=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),i=[];r.oncue=function(e){n.addCue(e)},r.onparsingerror=function(e){i.push(e)},r.onflush=function(){n.trigger({type:"loadeddata",target:n})},r.parse(t),i.length>0&&(e.console&&e.console.groupCollapsed&&e.console.groupCollapsed("Text Track parsing errors for "+n.src),i.forEach(function(e){return c.error(e)}),e.console&&e.console.groupEnd&&e.console.groupEnd()),r.flush()},ln=function(t,n){var r={uri:t},i=Vt(t);i&&(r.cors=i),on(r,ke(this,function(t,r,i){if(t)return c.error(t,r);if(n.loaded_=!0,"function"!=typeof e.WebVTT){if(n.tech_){var o=function(){return cn(i,n)};n.tech_.on("vttjsloaded",o),n.tech_.on("vttjserror",function(){c.error("vttjs failed to load, stopping trying to process "+n.src),n.tech_.off("vttjsloaded",o)})}}else cn(i,n)}))},hn=function(t){function n(e){var n;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var r=De(e,{kind:Bt[e.kind]||"subtitles",language:e.language||e.srclang||""}),i=Nt[r.mode]||"disabled",o=r.default;"metadata"!==r.kind&&"chapters"!==r.kind||(i="hidden"),(n=t.call(this,r)||this).tech_=r.tech,n.cues_=[],n.activeCues_=[];var a=new jt(n.cues_),u=new jt(n.activeCues_),c=!1,l=ke(s(s(n)),function(){this.activeCues=this.activeCues,c&&(this.trigger("cuechange"),c=!1)});return"disabled"!==i&&n.tech_.ready(function(){n.tech_.on("timeupdate",l)},!0),Object.defineProperties(s(s(n)),{default:{get:function(){return o},set:function(){}},mode:{get:function(){return i},set:function(e){var t=this;Nt[e]&&("disabled"!==(i=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?a:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return u;for(var e=this.tech_.currentTime(),t=[],n=0,r=this.cues.length;n<r;n++){var i=this.cues[n];i.startTime<=e&&i.endTime>=e?t.push(i):i.startTime===i.endTime&&i.startTime<=e&&i.startTime+.5>=e&&t.push(i)}if(c=!1,t.length!==this.activeCues_.length)c=!0;else for(var o=0;o<t.length;o++)-1===this.activeCues_.indexOf(t[o])&&(c=!0);return this.activeCues_=t,u.setCues_(this.activeCues_),u},set:function(){}}}),r.src?(n.src=r.src,ln(r.src,s(s(n)))):n.loaded_=!0,n}r(n,t);var i=n.prototype;return i.addCue=function(t){var n=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){for(var r in n=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)r in n||(n[r]=t[r]);n.id=t.id,n.originalCue_=t}for(var i=this.tech_.textTracks(),o=0;o<i.length;o++)i[o]!==this&&i[o].removeCue(n);this.cues_.push(n),this.cues.setCues_(this.cues_)},i.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},n}(Ut);hn.prototype.allowedEvents_={cuechange:"cuechange"};var fn=function(e){function t(t){var n;void 0===t&&(t={});var r=De(t,{kind:Lt[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(s(s(n)),"enabled",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("enabledchange"))}}),r.enabled&&(n.enabled=r.enabled),n.loaded_=!0,n}return r(t,e),t}(Ut),dn=function(e){function t(t){var n;void 0===t&&(t={});var r=De(t,{kind:Mt[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(s(s(n)),"selected",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("selectedchange"))}}),r.selected&&(n.selected=r.selected),n}return r(t,e),t}(Ut),pn=0,gn=2,vn=function(e){function t(t){var n,r;void 0===t&&(t={}),n=e.call(this)||this;var i=new hn(t);return n.kind=i.kind,n.src=i.src,n.srclang=i.language,n.label=i.label,n.default=i.default,Object.defineProperties(s(s(n)),{readyState:{get:function(){return r}},track:{get:function(){return i}}}),r=pn,i.addEventListener("loadeddata",function(){r=gn,n.trigger({type:"load",target:s(s(n))})}),n}return r(t,e),t}(Ce);vn.prototype.allowedEvents_={load:"load"},vn.NONE=pn,vn.LOADING=1,vn.LOADED=gn,vn.ERROR=3;var mn={audio:{ListClass:At,TrackClass:fn,capitalName:"Audio"},video:{ListClass:Ot,TrackClass:dn,capitalName:"Video"},text:{ListClass:Pt,TrackClass:hn,capitalName:"Text"}};Object.keys(mn).forEach(function(e){mn[e].getterName=e+"Tracks",mn[e].privateName=e+"Tracks_"});var yn={remoteText:{ListClass:Pt,TrackClass:hn,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Rt,TrackClass:vn,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},_n=De(mn,yn);yn.names=Object.keys(yn),mn.names=Object.keys(mn),_n.names=[].concat(yn.names).concat(mn.names);var bn=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function wn(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function En(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function kn(){this.values=bn(null)}function Tn(e,t,n,r){var i=r?e.split(r):[e];for(var o in i)if("string"==typeof i[o]){var s=i[o].split(n);2===s.length&&t(s[0],s[1])}}function Sn(e,t,n){var r=e;function i(){var t=En(e);if(null===t)throw new wn(wn.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function o(){e=e.replace(/^\s+/,"")}if(o(),t.startTime=i(),o(),"--\x3e"!==e.substr(0,3))throw new wn(wn.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),o(),t.endTime=i(),o(),function(e,t){var r=new kn;Tn(e,function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var o=t.split(","),s=o[0];r.integer(e,s),r.percent(e,s)&&r.set("snapToLines",!1),r.alt(e,s,["auto"]),2===o.length&&r.alt("lineAlign",o[1],["start","middle","end"]);break;case"position":o=t.split(","),r.percent(e,o[0]),2===o.length&&r.alt("positionAlign",o[1],["start","middle","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical",""),t.line=r.get("line","auto"),t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align","middle"),t.position=r.get("position",{start:0,left:0,middle:50,end:100,right:100},t.align),t.positionAlign=r.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},t.align)}(e,t)}(wn.prototype=bn(Error.prototype)).constructor=wn,wn.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},kn.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var Cn={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200e","&rlm;":"\u200f","&nbsp;":"\xa0"},xn={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},An={v:"title",lang:"lang"},In={rt:"ruby"};function On(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return t=t.substr((e=n[1]?n[1]:n[2]).length),e}function r(e){return Cn[e]}function i(e){for(;d=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(d[0],r);return e}function o(e,t){return!In[t.localName]||In[t.localName]===e.localName}function s(t,n){var r=xn[t];if(!r)return null;var i=e.document.createElement(r);i.localName=r;var o=An[t];return o&&n&&(i[o]=n.trim()),i}for(var a,u=e.document.createElement("div"),c=u,l=[];null!==(a=n());)if("<"!==a[0])c.appendChild(e.document.createTextNode(i(a)));else{if("/"===a[1]){l.length&&l[l.length-1]===a.substr(2).replace(">","")&&(l.pop(),c=c.parentNode);continue}var h,f=En(a.substr(1,a.length-2));if(f){h=e.document.createProcessingInstruction("timestamp",f),c.appendChild(h);continue}var d=a.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!d)continue;if(!(h=s(d[1],d[3])))continue;if(!o(c,h))continue;d[2]&&(h.className=d[2].substr(1).replace("."," ")),l.push(d[1]),c.appendChild(h),c=h}return u}var Pn=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Rn(e){for(var t=0;t<Pn.length;t++){var n=Pn[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function jn(){}function Mn(e,t,n){jn.call(this),this.cue=t,this.cueDiv=On(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function i(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var o=n.match(/^.*(\n|\r)/);return o?(e.length=0,o[0]):n}return"ruby"===t.tagName?i(e):t.childNodes?(r(e,t),i(e)):void 0}for(r(t,e);n=i(t);)for(var o=0;o<n.length;o++)if(Rn(n.charCodeAt(o)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":i=t.position;break;case"middle":i=t.position-t.size/2;break;case"end":i=t.position-t.size}this.applyStyles(""===t.vertical?{left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}:{top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Ln(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var o=(o=e.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();e=e.div.getBoundingClientRect(),t=o?Math.max(o[0]&&o[0].height||0,e.height/o.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function Bn(e,t,n,r){var i=new Ln(t),o=t.cue,s=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(o),a=[];if(o.snapToLines){var u;switch(o.vertical){case"":a=["+y","-y"],u="height";break;case"rl":a=["+x","-x"],u="width";break;case"lr":a=["-x","+x"],u="width"}var c=i.lineHeight,l=c*Math.round(s),h=n[u]+c,f=a[0];Math.abs(l)>h&&(l=l<0?-1:1,l*=Math.ceil(h/c)*c),s<0&&(l+=""===o.vertical?n.height:n.width,a=a.reverse()),i.move(f,l)}else{var d=i.lineHeight/n.height*100;switch(o.lineAlign){case"middle":s-=d/2;break;case"end":s-=d}switch(o.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")})}a=["+y","-x","+x","-y"],i=new Ln(t)}var p=function(e,t){for(var i,o=new Ln(e),s=1,a=0;a<t.length;a++){for(;e.overlapsOppositeAxis(n,t[a])||e.within(n)&&e.overlapsAny(r);)e.move(t[a]);if(e.within(n))return e;var u=e.intersectPercentage(n);s>u&&(i=new Ln(e),s=u),e=new Ln(o)}return i||o}(i,a);t.move(p.toCSSCompatValues(n))}function Nn(){}jn.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},jn.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Mn.prototype=bn(jn.prototype)).constructor=Mn,Ln.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Ln.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Ln.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Ln.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Ln.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Ln.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Ln.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Ln.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},Nn.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},Nn.convertCueToDOMTree=function(e,t){return e&&t?On(e,t):null},Nn.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],o=Ln.getSimpleBoxPosition(r),s={font:Math.round(.05*o.height*100)/100+"px sans-serif"};!function(){for(var n,a,u=0;u<t.length;u++)n=new Mn(e,a=t[u],s),r.appendChild(n.div),Bn(0,n,o,i),a.displayState=n.div,i.push(Ln.getSimpleBoxPosition(n))}()}else for(var a=0;a<t.length;a++)r.appendChild(t[a].displayState)},(Nn.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof wn))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t,n=this;function r(){for(var e=n.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,n.buffer=e.substr(t),r}e&&(n.buffer+=n.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===n.state){if(!/\r\n|\n/.test(n.buffer))return this;var o=(i=r()).match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new wn(wn.Errors.BadSignature);n.state="HEADER"}for(var s=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(s?s=!1:i=r(),n.state){case"HEADER":/:/.test(i)?(t=i).match(/X-TIMESTAMP-MAP/)?Tn(t,function(e,t){switch(e){case"X-TIMESTAMP-MAP":r=t,i=new kn,Tn(r,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",En(t))}},/[^\d]:/,/,/),n.ontimestampmap&&n.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}var r,i},/=/):Tn(t,function(e,t){switch(e){case"Region":!function(e){var t=new kn;if(Tn(e,function(e,n){switch(e){case"id":t.set(e,n);break;case"width":t.percent(e,n);break;case"lines":t.integer(e,n);break;case"regionanchor":case"viewportanchor":var r=n.split(",");if(2!==r.length)break;var i=new kn;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;t.set(e+"X",i.get("x")),t.set(e+"Y",i.get("y"));break;case"scroll":t.alt(e,n,["up"])}},/=/,/\s/),t.has("id")){var r=new(n.vttjs.VTTRegion||n.window.VTTRegion);r.width=t.get("width",100),r.lines=t.get("lines",3),r.regionAnchorX=t.get("regionanchorX",0),r.regionAnchorY=t.get("regionanchorY",100),r.viewportAnchorX=t.get("viewportanchorX",0),r.viewportAnchorY=t.get("viewportanchorY",100),r.scroll=t.get("scroll",""),n.onregion&&n.onregion(r),n.regionList.push({id:t.get("id"),region:r})}}(t)}},/:/):i||(n.state="ID");continue;case"NOTE":i||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){n.state="NOTE";break}if(!i)continue;if(n.cue=new(n.vttjs.VTTCue||n.window.VTTCue)(0,0,""),n.state="CUE",-1===i.indexOf("--\x3e")){n.cue.id=i;continue}case"CUE":try{Sn(i,n.cue,n.regionList)}catch(e){n.reportOrThrowError(e),n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var a=-1!==i.indexOf("--\x3e");if(!i||a&&(s=!0)){n.oncue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}n.cue.text&&(n.cue.text+="\n"),n.cue.text+=i;continue;case"BADCUE":i||(n.state="ID");continue}}}catch(e){n.reportOrThrowError(e),"CUETEXT"===n.state&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state="INITIAL"===n.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new wn(wn.Errors.BadSignature)}catch(e){this.reportOrThrowError(e)}return this.onflush&&this.onflush(),this}};var Un=Nn,Dn="auto",Fn={"":1,lr:1,rl:1},Hn={start:1,middle:1,end:1,left:1,right:1};function Vn(e){return"string"==typeof e&&!!Hn[e.toLowerCase()]&&e.toLowerCase()}function Wn(e,t,n){this.hasBeenReset=!1;var r="",i=!1,o=e,s=t,a=n,u=null,c="",l=!0,h="auto",f="start",d=50,p="middle",g=50,v="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(e){r=""+e}},pauseOnExit:{enumerable:!0,get:function(){return i},set:function(e){i=!!e}},startTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");o=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");s=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return a},set:function(e){a=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return u},set:function(e){u=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return c},set:function(e){var t=function(e){return"string"==typeof e&&!!Fn[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");c=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return l},set:function(e){l=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e&&e!==Dn)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return f},set:function(e){var t=Vn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");f=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return d},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");d=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=Vn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return g},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");g=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return v},set:function(e){var t=Vn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Wn.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var qn=Wn,zn={"":!0,up:!0};function Kn(e){return"number"==typeof e&&e>=0&&e<=100}var Gn=function(){var e=100,t=3,n=0,r=100,i=0,o=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!Kn(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(e){if(!Kn(e))throw new Error("RegionAnchorX must be between 0 and 100.");r=e}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(e){if(!Kn(e))throw new Error("RegionAnchorY must be between 0 and 100.");n=e}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(e){if(!Kn(e))throw new Error("ViewportAnchorY must be between 0 and 100.");o=e}},viewportAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!Kn(e))throw new Error("ViewportAnchorX must be between 0 and 100.");i=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t=function(e){return"string"==typeof e&&!!zn[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");s=t}}})},$n=Kt(function(t){var n=t.exports={WebVTT:Un,VTTCue:qn,VTTRegion:Gn};e.vttjs=n,e.WebVTT=n.WebVTT;var r=n.VTTCue,i=n.VTTRegion,o=e.VTTCue,s=e.VTTRegion;n.shim=function(){e.VTTCue=r,e.VTTRegion=i},n.restore=function(){e.VTTCue=o,e.VTTRegion=s},e.VTTCue||n.shim()}),Yn=function(n){function i(e,t){var r;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.reportTouchActivity=!1,(r=n.call(this,null,e,t)||this).hasStarted_=!1,r.on("playing",function(){this.hasStarted_=!0}),r.on("loadstart",function(){this.hasStarted_=!1}),_n.names.forEach(function(t){var n=_n[t];e&&e[n.getterName]&&(r[n.privateName]=e[n.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===e["native"+t+"Tracks"]&&(r["featuresNative"+t+"Tracks"]=!1)}),!1===e.nativeCaptions||!1===e.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.autoRemoteTextTracks_=new _n.text.ListClass,r.initTrackListeners(),e.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}r(i,n);var o=i.prototype;return o.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},o.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},o.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},o.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ke(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()}),500)},o.onDurationChange=function(e){this.duration_=this.duration()},o.buffered=function(){return lt(0,0)},o.bufferedPercent=function(){return ht(this.buffered(),this.duration_)},o.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},o.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},o.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},o.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},o.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},o.dispose=function(){this.clearTracks(mn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),n.prototype.dispose.call(this)},o.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach(function(e){for(var n=t[e+"Tracks"]()||[],r=n.length;r--;){var i=n[r];"text"===e&&t.removeRemoteTextTrack(i),n.removeTrack(i)}})},o.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;)this.removeRemoteTextTrack(e[t])},o.reset=function(){},o.error=function(e){return void 0!==e&&(this.error_=new yt(e),this.trigger("error")),this.error_},o.played=function(){return this.hasStarted_?lt(0,0):lt()},o.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},o.initTrackListeners=function(){var e=this;mn.names.forEach(function(t){var n=function(){e.trigger(t+"trackchange")},r=e[mn[t].getterName]();r.addEventListener("removetrack",n),r.addEventListener("addtrack",n),e.on("dispose",function(){r.removeEventListener("removetrack",n),r.removeEventListener("addtrack",n)})})},o.addWebVttScript_=function(){var n=this;if(!e.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&y($n)&&Object.keys($n).length>0)return void this.trigger("vttjsloaded");var r=t.createElement("script");r.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",r.onload=function(){n.trigger("vttjsloaded")},r.onerror=function(){n.trigger("vttjserror")},this.on("dispose",function(){r.onload=null,r.onerror=null}),e.WebVTT=!0,this.el().parentNode.appendChild(r)}else this.ready(this.addWebVttScript_)},o.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),r=function(e){return t.addTrack(e.track)},i=function(e){return t.removeTrack(e.track)};n.on("addtrack",r),n.on("removetrack",i),this.addWebVttScript_();var o=function(){return e.trigger("texttrackchange")},s=function(){o();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",o),"showing"===n.mode&&n.addEventListener("cuechange",o)}};s(),t.addEventListener("change",s),t.addEventListener("addtrack",s),t.addEventListener("removetrack",s),this.on("dispose",function(){n.off("addtrack",r),n.off("removetrack",i),t.removeEventListener("change",s),t.removeEventListener("addtrack",s),t.removeEventListener("removetrack",s);for(var e=0;e<t.length;e++)t[e].removeEventListener("cuechange",o)})},o.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,r,i){void 0===i&&(i={});var o=e.textTracks();i.kind=t,n&&(i.label=n),r&&(i.language=r),i.tech=e;var s=new _n.text.TrackClass(i);return o.addTrack(s),s}(this,e,t,n)},o.createRemoteTextTrack=function(e){var t=De(e,{tech:this});return new yn.remoteTextEl.TrackClass(t)},o.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(c.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready(function(){return n.autoRemoteTextTracks_.addTrack(r.track)}),r},o.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},o.getVideoPlaybackQuality=function(){return{}},o.setPoster=function(){},o.playsinline=function(){},o.setPlaysinline=function(){},o.overrideNativeAudioTracks=function(){},o.overrideNativeVideoTracks=function(){},o.canPlayType=function(){return""},i.canPlayType=function(){return""},i.canPlaySource=function(e,t){return i.canPlayType(e.type)},i.isTech=function(e){return e.prototype instanceof i||e instanceof i||e===i},i.registerTech=function(e,t){if(i.techs_||(i.techs_={}),!i.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!i.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!i.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ue(e),i.techs_[e]=t,"Tech"!==e&&i.defaultTechOrder_.push(e),t},i.getTech=function(t){if(t)return t=Ue(t),i.techs_&&i.techs_[t]?i.techs_[t]:e&&e.videojs&&e.videojs[t]?(c.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),e.videojs[t]):void 0},i}(Fe);_n.names.forEach(function(e){var t=_n[e];Yn.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),Yn.prototype.featuresVolumeControl=!0,Yn.prototype.featuresMuteControl=!0,Yn.prototype.featuresFullscreenResize=!1,Yn.prototype.featuresPlaybackRate=!1,Yn.prototype.featuresProgressEvents=!1,Yn.prototype.featuresSourceset=!1,Yn.prototype.featuresTimeupdateEvents=!1,Yn.prototype.featuresNativeTextTracks=!1,Yn.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var r=e.sourceHandlers;r||(r=e.sourceHandlers=[]),void 0===n&&(n=r.length),r.splice(n,0,t)},e.canPlayType=function(t){for(var n,r=e.sourceHandlers||[],i=0;i<r.length;i++)if(n=r[i].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var r=e.sourceHandlers||[],i=0;i<r.length;i++)if(r[i].canHandleSource(t,n))return r[i];return null},e.canPlaySource=function(t,n){var r=e.selectSourceHandler(t,n);return r?r.canHandleSource(t,n):""},["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:c.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.on("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},Fe.registerComponent("Tech",Yn),Yn.registerTech("Tech",Yn),Yn.defaultTechOrder_=[];var Xn={},Jn={},Qn={};function Zn(e,t,n,r){void 0===r&&(r=null);var i="call"+Ue(n),o=e.reduce(rr(i),r),s=o===Qn,a=s?null:t[n](o);return function(e,t,n,r){for(var i=e.length-1;i>=0;i--){var o=e[i];o[t]&&o[t](r,n)}}(e,n,a,s),a}var er={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},tr={setCurrentTime:1},nr={play:1,pause:1};function rr(e){return function(t,n){return t===Qn?Qn:n[e]?n[e](t):t}}var ir={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},or=function(e){void 0===e&&(e="");var t=Ht(e);return ir[t.toLowerCase()]||""};function sr(e){var t=or(e.src);return!e.type&&t&&(e.type=t),e}var ar=function(e){function t(t,n,r){var i,o=De({createEl:!1},n);if(i=e.call(this,t,o,r)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var s=0,a=n.playerOptions.techOrder;s<a.length;s++){var u=Ue(a[s]),c=Yn.getTech(u);if(u||(c=Fe.getComponent(u)),c&&c.isSupported()){t.loadTech_(u);break}}return i}return r(t,e),t}(Fe);Fe.registerComponent("MediaLoader",ar);var ur=function(e){function n(t,n){var r;return(r=e.call(this,t,n)||this).emitTapEvents(),r.enable(),r}r(n,e);var i=n.prototype;return i.createEl=function(t,n,r){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===r&&(r={}),n=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&c.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),r=v({role:"button"},r),this.tabIndex_=n.tabIndex;var i=e.prototype.createEl.call(this,t,n,r);return this.createControlTextEl(i),i},i.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},i.createControlTextEl=function(e){return this.controlTextEl_=x("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},i.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,A(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},i.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},i.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},i.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},i.handleClick=function(e){},i.handleFocus=function(e){he(t,"keydown",ke(this,this.handleKeyPress))},i.handleKeyPress=function(t){32===t.which||13===t.which?(t.preventDefault(),this.trigger("click")):e.prototype.handleKeyPress&&e.prototype.handleKeyPress.call(this,t)},i.handleBlur=function(e){fe(t,"keydown",ke(this,this.handleKeyPress))},n}(Fe);Fe.registerComponent("ClickableComponent",ur),Fe.registerComponent("PosterImage",function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update(),t.on("posterchange",ke(s(s(r)),r.update)),r}r(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){return x("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){this.player_.controls()&&(this.player_.paused()?wt(this.player_.play()):this.player_.pause())},t}(ur));var cr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function lr(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function hr(e,t,n){try{e.style[t]=n}catch(e){return}}Fe.registerComponent("TextTrackDisplay",function(t){function n(n,r,i){var o;o=t.call(this,n,r,i)||this;var a=ke(s(s(o)),o.updateDisplay);return n.on("loadstart",ke(s(s(o)),o.toggleDisplay)),n.on("texttrackchange",a),n.on("loadstart",ke(s(s(o)),o.preselectTrack)),n.ready(ke(s(s(o)),function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)this.hide();else{n.on("fullscreenchange",a),n.on("playerresize",a),e.addEventListener("orientationchange",a),n.on("dispose",function(){return e.removeEventListener("orientationchange",a)});for(var t=this.options_.playerOptions.tracks||[],r=0;r<t.length;r++)this.player_.addRemoteTextTrack(t[r],!0);this.preselectTrack()}})),o}r(n,t);var i=n.prototype;return i.preselectTrack=function(){for(var e,t,n,r={captions:1,subtitles:1},i=this.player_.textTracks(),o=this.player_.cache_.selectedLanguage,s=0;s<i.length;s++){var a=i[s];o&&o.enabled&&o.language===a.language?a.kind===o.kind?n=a:n||(n=a):o&&!o.enabled?(n=null,e=null,t=null):a.default&&("descriptions"!==a.kind||e?a.kind in r&&!t&&(t=a):e=a)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},i.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function(){"function"==typeof e.WebVTT&&e.WebVTT.processCues(e,[],this.el_)},i.updateDisplay=function(){var e=this.player_.textTracks();this.clearDisplay();for(var t=null,n=null,r=e.length;r--;){var i=e[r];"showing"===i.mode&&("descriptions"===i.kind?t=i:n=i)}n?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(n)):t&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(t))},i.updateForTrack=function(t){if("function"==typeof e.WebVTT&&t.activeCues){for(var n=[],r=0;r<t.activeCues.length;r++)n.push(t.activeCues[r]);if(e.WebVTT.processCues(e,n,this.el_),this.player_.textTrackSettings)for(var i=this.player_.textTrackSettings.getValues(),o=n.length;o--;){var s=n[o];if(s){var a=s.displayState;if(i.color&&(a.firstChild.style.color=i.color),i.textOpacity&&hr(a.firstChild,"color",lr(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(a.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&hr(a.firstChild,"backgroundColor",lr(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?hr(a,"backgroundColor",lr(i.windowColor,i.windowOpacity)):a.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===i.edgeStyle?a.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===i.edgeStyle?a.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===i.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&1!==i.fontPercent){var u=e.parseFloat(a.style.fontSize);a.style.fontSize=u*i.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=cr[i.fontFamily])}}}},n}(Fe)),Fe.registerComponent("LoadingSpinner",function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),r=x("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),i=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(r),i},t}(Fe));var fr=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=v({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=v({type:"button"},n);var r=Fe.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(r),r},n.addChild=function(e,t){return void 0===t&&(t={}),c.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),Fe.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyPress=function(t){32!==t.which&&13!==t.which&&e.prototype.handleKeyPress.call(this,t)},t}(ur);Fe.registerComponent("Button",fr);var dr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)wt(t);else{var n=this.player_.getChild("controlBar"),r=n&&n.getChild("playToggle");if(r){var i=function(){return r.focus()};bt(t)?t.then(i,function(){}):this.setTimeout(i,1)}else this.player_.focus()}},n.handleKeyPress=function(t){this.mouseused_=!1,e.prototype.handleKeyPress.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(fr);dr.prototype.controlText_="Play Video",Fe.registerComponent("BigPlayButton",dr),Fe.registerComponent("CloseButton",function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).controlText(n&&n.controlText||r.localize("Close")),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},t}(fr));var pr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"play",r.handlePlay),r.on(t,"pause",r.handlePause),r.on(t,"ended",r.handleEnded),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(fr);pr.prototype.controlText_="Play",Fe.registerComponent("PlayToggle",pr);var gr=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),o=Math.floor(t/60%60),s=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(i=r=n="-"),(i=i>0||s>0?i+":":"")+(r=((i||o>=10)&&r<10?"0"+r:r)+":")+(n<10?"0"+n:n)},vr=gr;function mr(e,t){return void 0===t&&(t=e),vr(e,t)}var yr=function(e){function n(t,n){var r;return(r=e.call(this,t,n)||this).throttledUpdateContent=Te(ke(s(s(r)),r.updateContent),25),r.on(t,"timeupdate",r.throttledUpdateContent),r}r(n,e);var i=n.prototype;return i.createEl=function(t){var n=this.buildCSSClass(),r=e.prototype.createEl.call(this,"div",{className:n+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text">'+this.localize(this.labelText_)+"\xa0</span>"});return this.contentEl_=x("span",{className:n+"-display"},{"aria-live":"off"}),this.updateTextNode_(),r.appendChild(this.contentEl_),r},i.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},i.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},i.formatTime_=function(e){return mr(e)},i.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},i.updateContent=function(e){},n}(Fe);yr.prototype.labelText_="Time",yr.prototype.controlText_="Time",Fe.registerComponent("TimeDisplay",yr);var _r=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"ended",r.handleEnded),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(t)},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},t}(yr);_r.prototype.labelText_="Current Time",_r.prototype.controlText_="Current Time",Fe.registerComponent("CurrentTimeDisplay",_r);var br=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"durationchange",r.updateContent),r.on(t,"loadedmetadata",r.throttledUpdateContent),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();t&&this.duration_!==t&&(this.duration_=t,this.updateFormattedTime_(t))},t}(yr);br.prototype.labelText_="Duration",br.prototype.controlText_="Duration",Fe.registerComponent("DurationDisplay",br),Fe.registerComponent("TimeDivider",function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},t}(Fe));var wr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"durationchange",r.throttledUpdateContent),r.on(t,"ended",r.handleEnded),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.formatTime_=function(t){return"-"+e.prototype.formatTime_.call(this,t)},n.updateContent=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime())},n.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},t}(yr);wr.prototype.labelText_="Remaining Time",wr.prototype.controlText_="Remaining Time",Fe.registerComponent("RemainingTimeDisplay",wr),Fe.registerComponent("LiveDisplay",function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}r(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=x("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"\xa0</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(Fe));var Er=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}r(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),n.className=n.className+" vjs-slider",n=v({tabIndex:0},n),r=v({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),e.prototype.createEl.call(this,t,n,r)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||tt||e.preventDefault(),D(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;F(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var n=(100*e).toFixed(2)+"%",r=t.el().style;return this.vertical()?r.height=n:r.width=n,e}}},n.calculateDistance=function(e){var t=W(this.el_,e);return this.vertical()?t.y:t.x},n.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},n.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepBack()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepForward())},n.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},n.handleClick=function(e){e.stopImmediatePropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},t}(Fe);Fe.registerComponent("Slider",Er),Fe.registerComponent("LoadProgressBar",function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).partEls_=[],r.on(t,"progress",r.update),r}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},n.dispose=function(){this.partEls_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this.player_.buffered(),n=this.player_.duration(),r=this.player_.bufferedEnd(),i=this.partEls_,o=function(e,t){var n=e/t||0;return 100*(n>=1?1:n)+"%"};this.el_.style.width=o(r,n);for(var s=0;s<t.length;s++){var a=t.start(s),u=t.end(s),c=i[s];c||(c=this.el_.appendChild(x()),i[s]=c),c.style.left=o(a,r),c.style.width=o(u-a,r)}for(var l=i.length;l>t.length;l--)this.el_.removeChild(i[l-1]);i.length=t.length},t}(Fe)),Fe.registerComponent("TimeTooltip",function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})},n.update=function(e,t,n){var r=H(this.el_),i=H(this.player_.el()),o=e.width*t;if(i&&r){var s=e.left-i.left+o,a=e.width-o+(i.right-e.right),u=r.width/2;s<u?u+=u-s:a<u&&(u=a),u<0?u=0:u>r.width&&(u=r.width),this.el_.style.right="-"+u+"px",A(this.el_,n)}},t}(Fe));var kr=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},n.update=function(e,t){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var r=mr(n.player_.scrubbing()?n.player_.getCache().currentTime:n.player_.currentTime(),n.player_.duration()),i=n.getChild("timeTooltip");i&&i.update(e,t,r)})},t}(Fe);kr.prototype.options_={children:[]},$e||Xe||kr.prototype.options_.children.push("timeTooltip"),Fe.registerComponent("PlayProgressBar",kr);var Tr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=Te(ke(s(s(r)),r.update),25),r}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var r=n.player_.duration(),i=mr(t*r,r);n.el_.style.left=e.width*t+"px",n.getChild("timeTooltip").update(e,t,i)})},t}(Fe);Tr.prototype.options_={children:["timeTooltip"]},Fe.registerComponent("MouseTimeDisplay",Tr);var Sr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).setEventHandlers_(),r}r(t,e);var n=t.prototype;return n.setEventHandlers_=function(){var e=this;this.update=Te(ke(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.updateInterval=null,this.on(this.player_,["playing"],function(){e.clearInterval(e.updateInterval),e.updateInterval=e.setInterval(function(){e.requestAnimationFrame(function(){e.update()})},30)}),this.on(this.player_,["ended","pause","waiting"],function(){e.clearInterval(e.updateInterval)}),this.on(this.player_,["timeupdate","ended"],this.update)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update_=function(e,t){var n=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[mr(e,n),mr(n,n)],"{1} of {2}")),this.bar.update(H(this.el_),t)},n.update=function(t){var n=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),n),n},n.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.handleEnded=function(e){this.update_(this.player_.duration(),1)},n.getPercent=function(){var e=this.getCurrentTime_()/this.player_.duration();return e>=1?1:e||0},n.handleMouseDown=function(t){Y(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},n.handleMouseMove=function(e){if(Y(e)){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t)}},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&wt(this.player_.play())},n.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},n.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyPress=function(t){32===t.which||13===t.which?(t.preventDefault(),this.handleAction(t)):e.prototype.handleKeyPress&&e.prototype.handleKeyPress.call(this,t)},t}(Er);Sr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},$e||Xe||Sr.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Sr.prototype.playerEvent="timeupdate",Fe.registerComponent("SeekBar",Sr);var Cr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleMouseMove=Te(ke(s(s(r)),r.handleMouseMove),25),r.throttledHandleMouseSeek=Te(ke(s(s(r)),r.handleMouseSeek),25),r.enable(),r}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("mouseTimeDisplay"),r=t.el(),i=H(r),o=W(r,e).x;o>1?o=1:o<0&&(o=0),n&&n.update(i,o)}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(Fe);Cr.prototype.options_={children:["seekBar"]},Fe.registerComponent("ProgressControl",Cr);var xr=function(e){function n(n,r){var i;return(i=e.call(this,n,r)||this).on(n,"fullscreenchange",i.handleFullscreenChange),!1===t[dt.fullscreenEnabled]&&i.disable(),i}r(n,e);var i=n.prototype;return i.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},i.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},i.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},n}(fr);xr.prototype.controlText_="Fullscreen",Fe.registerComponent("FullscreenToggle",xr);var Ar=function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})};Fe.registerComponent("VolumeLevel",function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(Fe));var Ir=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on("slideractive",r.updateLastVolume_),r.on(t,"volumechange",r.updateARIAAttributes),t.ready(function(){return r.updateARIAAttributes()}),r}r(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Y(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Y(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},t}(Er);Ir.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Ir.prototype.playerEvent="volumechange",Fe.registerComponent("VolumeBar",Ir);var Or=function(e){function t(t,n){var r;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||y(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),r=e.call(this,t,n)||this,Ar(s(s(r)),t),r.throttledHandleMouseMove=Te(ke(s(s(r)),r.handleMouseMove),25),r.on("mousedown",r.handleMouseDown),r.on("touchstart",r.handleMouseDown),r.on(r.volumeBar,["focus","slideractive"],function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")}),r.on(r.volumeBar,["blur","sliderinactive"],function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")}),r}r(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(Fe);Or.prototype.options_={children:["volumeBar"]},Fe.registerComponent("VolumeControl",Or);var Pr=function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},Rr=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,Pr(s(s(r)),t),r.on(t,["loadstart","volumechange"],r.update),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();0===t?(this.player_.volume(n<.1?.1:n),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;$e&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)R(this.el_,"vjs-vol-"+n);P(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(fr);Rr.prototype.controlText_="Mute",Fe.registerComponent("MuteToggle",Rr);var jr=function(e){function t(t,n){var r;return void 0===n&&(n={}),n.inline=void 0===n.inline||n.inline,(void 0===n.volumeControl||y(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(r=e.call(this,t,n)||this).on(t,["loadstart"],r.volumePanelState_),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}r(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},t}(Fe);jr.prototype.options_={children:["muteToggle","volumeControl"]},Fe.registerComponent("VolumePanel",jr);var Mr=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,n&&(r.menuButton_=n.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyPress),r}r(t,e);var n=t.prototype;return n.addItem=function(e){this.addChild(e),e.on("click",ke(this,function(t){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==e.name()&&this.menuButton_.focus())}))},n.createEl=function(){this.contentEl_=x(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),he(t,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.handleKeyPress=function(e){37===e.which||40===e.which?(e.preventDefault(),this.stepForward()):38!==e.which&&39!==e.which||(e.preventDefault(),this.stepBack())},n.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(Fe);Fe.registerComponent("Menu",Mr);var Lr=function(e){function n(t,n){var r;void 0===n&&(n={}),(r=e.call(this,t,n)||this).menuButton_=new fr(t,n),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var i=fr.prototype.buildCSSClass();return r.menuButton_.el_.className=r.buildCSSClass()+" "+i,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0,r.on(r.menuButton_,"tap",r.handleClick),r.on(r.menuButton_,"click",r.handleClick),r.on(r.menuButton_,"focus",r.handleFocus),r.on(r.menuButton_,"blur",r.handleBlur),r.on("keydown",r.handleSubmenuKeyPress),r}r(n,e);var i=n.prototype;return i.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function(){var e=new Mr(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=x("li",{className:"vjs-menu-title",innerHTML:Ue(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,e.children_.unshift(t),I(t,e.contentEl())}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)e.addItem(this.items[n]);return e},i.createItems=function(){},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+fr.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},i.buildCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+e.prototype.buildCSSClass.call(this)},i.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},i.handleClick=function(e){this.one(this.menu.contentEl(),"mouseleave",ke(this,function(e){this.unpressButton(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},i.focus=function(){this.menuButton_.focus()},i.blur=function(){this.menuButton_.blur()},i.handleFocus=function(){he(t,"keydown",ke(this,this.handleKeyPress))},i.handleBlur=function(){fe(t,"keydown",ke(this,this.handleKeyPress))},i.handleKeyPress=function(e){27===e.which||9===e.which?(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus())):38!==e.which&&40!==e.which||this.buttonPressed_||(this.pressButton(),e.preventDefault())},i.handleSubmenuKeyPress=function(e){27!==e.which&&9!==e.which||(this.buttonPressed_&&this.unpressButton(),9!==e.which&&(e.preventDefault(),this.menuButton_.el_.focus()))},i.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),$e&&S())return;this.menu.focus()}},i.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},i.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},n}(Fe);Fe.registerComponent("MenuButton",Lr);var Br=function(e){function t(t,n){var r,i=n.tracks;if((r=e.call(this,t,n)||this).items.length<=1&&r.hide(),!i)return s(r);var o=ke(s(s(r)),r.update);return i.addEventListener("removetrack",o),i.addEventListener("addtrack",o),r.player_.on("ready",o),r.player_.on("dispose",function(){i.removeEventListener("removetrack",o),i.removeEventListener("addtrack",o)}),r}return r(t,e),t}(Lr);Fe.registerComponent("TrackButton",Br);var Nr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).selectable=n.selectable,r.isSelected_=n.selected||!1,r.multiSelectable=n.multiSelectable,r.selected(r.isSelected_),r.el_.setAttribute("role",r.selectable?r.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),r}r(t,e);var n=t.prototype;return n.createEl=function(t,n,r){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",v({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),r)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(ur);Fe.registerComponent("MenuItem",Nr);var Ur=function(n){function i(r,i){var o,a=i.track,u=r.textTracks();i.label=a.label||a.language||"Unknown",i.selected="showing"===a.mode,(o=n.call(this,r,i)||this).track=a;var c,l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.handleTracksChange.apply(s(s(o)),t)},h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];o.handleSelectedLanguageChange.apply(s(s(o)),t)};return r.on(["loadstart","texttrackchange"],l),u.addEventListener("change",l),u.addEventListener("selectedlanguagechange",h),o.on("dispose",function(){r.off(["loadstart","texttrackchange"],l),u.removeEventListener("change",l),u.removeEventListener("selectedlanguagechange",h)}),void 0===u.onchange&&o.on(["tap","click"],function(){if("object"!=typeof e.Event)try{c=new e.Event("change")}catch(e){}c||(c=t.createEvent("Event")).initEvent("change",!0,!0),u.dispatchEvent(c)}),o.handleTracksChange(),o}r(i,n);var o=i.prototype;return o.handleClick=function(e){var t=this.track.kind,r=this.track.kinds,i=this.player_.textTracks();if(r||(r=[t]),n.prototype.handleClick.call(this,e),i)for(var o=0;o<i.length;o++){var s=i[o];s===this.track&&r.indexOf(s.kind)>-1?"showing"!==s.mode&&(s.mode="showing"):"disabled"!==s.mode&&(s.mode="disabled")}},o.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},o.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},o.dispose=function(){this.track=null,n.prototype.dispose.call(this)},i}(Nr);Fe.registerComponent("TextTrackMenuItem",Ur);var Dr=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.track.label=n.label?n.label:n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}r(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var o=t[r];if(this.options_.kinds.indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var o=t[r];if(["captions","descriptions","subtitles"].indexOf(o.kind)>-1&&"showing"===o.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Ur);Fe.registerComponent("OffTextTrackMenuItem",Dr);var Fr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return r(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=Ur),this.label_&&(n=this.label_+" off"),e.push(new Dr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<r.length;i++){var o=r[i];if(this.kinds_.indexOf(o.kind)>-1){var s=new t(this.player_,{track:o,selectable:!0,multiSelectable:!1});s.addClass("vjs-"+o.kind+"-menu-item"),e.push(s)}}return e},t}(Br);Fe.registerComponent("TextTrackButton",Fr);var Hr=function(e){function t(t,n){var r,i=n.track,o=n.cue,a=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=o.text,n.selected=o.startTime<=a&&a<o.endTime,(r=e.call(this,t,n)||this).track=i,r.cue=o,i.addEventListener("cuechange",ke(s(s(r)),r.update)),r}r(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(Nr);Fe.registerComponent("ChaptersTrackMenuItem",Hr);var Vr=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ue(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,r=t.length;n<r;n++){var i=new Hr(this.player_,{track:this.track_,cue:t[n]});e.push(i)}return e},t}(Fr);Vr.prototype.kind_="chapters",Vr.prototype.controlText_="Chapters",Fe.registerComponent("ChaptersButton",Vr);var Wr=function(e){function t(t,n,r){var i;i=e.call(this,t,n,r)||this;var o=t.textTracks(),a=ke(s(s(i)),i.handleTracksChange);return o.addEventListener("change",a),i.on("dispose",function(){o.removeEventListener("change",a)}),i}r(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,r=0,i=t.length;r<i;r++){var o=t[r];if(o.kind!==this.kind_&&"showing"===o.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fr);Wr.prototype.kind_="descriptions",Wr.prototype.controlText_="Descriptions",Fe.registerComponent("DescriptionsButton",Wr);var qr=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Fr);qr.prototype.kind_="subtitles",qr.prototype.controlText_="Subtitles",Fe.registerComponent("SubtitlesButton",qr);var zr=function(e){function t(t,n){var r;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(r=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),r.controlText(", opens "+n.kind+" settings dialog"),r}return r(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Ur);Fe.registerComponent("CaptionSettingsMenuItem",zr);var Kr=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zr(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Fr);Kr.prototype.kind_="captions",Kr.prototype.controlText_="Captions",Fe.registerComponent("CaptionsButton",Kr);var Gr=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),e.prototype.createEl.call(this,t,v({innerHTML:i+="</span>"},n),r)},t}(Ur);Fe.registerComponent("SubsCapsMenuItem",Gr);var $r=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(Ue(r.label_)),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zr(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t,Gr)},t}(Fr);$r.prototype.kinds_=["captions","subtitles"],$r.prototype.controlText_="Subtitles",Fe.registerComponent("SubsCapsButton",$r);var Yr=function(e){function t(t,n){var r,i=n.track,o=t.audioTracks();n.label=i.label||i.language||"Unknown",n.selected=i.enabled,(r=e.call(this,t,n)||this).track=i,r.addClass("vjs-"+i.kind+"-menu-item");var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(s(s(r)),t)};return o.addEventListener("change",a),r.on("dispose",function(){o.removeEventListener("change",a)}),r}r(t,e);var n=t.prototype;return n.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),e.prototype.createEl.call(this,t,v({innerHTML:i+="</span>"},n),r)},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var r=0;r<n.length;r++){var i=n[r];i.enabled=i===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(Nr);Fe.registerComponent("AudioTrackMenuItem",Yr);var Xr=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++)e.push(new Yr(this.player_,{track:t[n],selectable:!0,multiSelectable:!1}));return e},t}(Br);Xr.prototype.controlText_="Audio Track",Fe.registerComponent("AudioTrackButton",Xr);var Jr=function(e){function t(t,n){var r,i=n.rate,o=parseFloat(i,10);return n.label=i,n.selected=1===o,n.selectable=!0,n.multiSelectable=!1,(r=e.call(this,t,n)||this).label=i,r.rate=o,r.on(t,"ratechange",r.update),r}r(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(Nr);Jr.prototype.contentElType="button",Fe.registerComponent("PlaybackRateMenuItem",Jr);var Qr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateVisibility(),r.updateLabel(),r.on(t,"loadstart",r.updateVisibility),r.on(t,"ratechange",r.updateLabel),r}r(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=x("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Mr(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new Jr(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),r=n[0],i=0;i<n.length;i++)if(n[i]>t){r=n[i];break}this.player().playbackRate(r)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Lr);Qr.prototype.controlText_="Playback Rate",Fe.registerComponent("PlaybackRateMenuButton",Qr);var Zr=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(Fe);Fe.registerComponent("Spacer",Zr),Fe.registerComponent("CustomControlSpacer",function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="\xa0",t},t}(Zr));var ei=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(Fe);ei.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},Fe.registerComponent("ControlBar",ei);var ti=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"error",r.open),r}r(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(Tt);ti.prototype.options_=De(Tt.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),Fe.registerComponent("ErrorDisplay",ti);var ni=["#000","Black"],ri=["#00F","Blue"],ii=["#0FF","Cyan"],oi=["#0F0","Green"],si=["#F0F","Magenta"],ai=["#F00","Red"],ui=["#FFF","White"],ci=["#FF0","Yellow"],li=["1","Opaque"],hi=["0.5","Semi-Transparent"],fi=["0","Transparent"],di={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ni,ui,ai,oi,ri,ci,si,ii]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[li,hi,fi]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[ui,ni,ai,oi,ri,ci,si,ii]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[li,hi]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[fi,hi,li]}};function pi(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}di.windowColor.options=di.backgroundColor.options,Fe.registerComponent("TextTrackSettings",function(n){function i(e,t){var r;return t.temporary=!1,(r=n.call(this,e,t)||this).updateDisplay=ke(s(s(r)),r.updateDisplay),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=x("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===t.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings(),r.close()}),r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults(),r.updateDisplay()}),g(di,function(e){r.on(r.$(e.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}r(i,n);var o=i.prototype;return o.dispose=function(){this.endDialog=null,n.prototype.dispose.call(this)},o.createElSelect_=function(e,t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n="label");var i=di[e],o=i.id.replace("%s",this.id_),s=[t,o].join(" ").trim();return["<"+n+' id="'+o+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(i.label),"</"+n+">",'<select aria-labelledby="'+s+'">'].concat(i.options.map(function(e){var t=o+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+s+" "+t+'">',r.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},o.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},o.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},o.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},o.createElColors_=function(){return x("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},o.createElFont_=function(){return x("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},o.createElControls_=function(){var e=this.localize("restore all settings to the default values");return x("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},o.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},o.label=function(){return this.localize("Caption Settings Dialog")},o.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},o.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},o.getValues=function(){var e,t,n,r=this;return t=function(e,t,n){var i,o=pi((i=r.$(t.selector)).options[i.options.selectedIndex].value,t.parser);return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),p(e=di).reduce(function(n,r){return t(n,e[r],r)},n)},o.setValues=function(e){var t=this;g(di,function(n,r){!function(e,t,n){if(t)for(var r=0;r<e.options.length;r++)if(pi(e.options[r].value,n)===t){e.selectedIndex=r;break}}(t.$(n.selector),e[r],n.parser)})},o.setDefaults=function(){var e=this;g(di,function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n})},o.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem("vjs-text-track-settings"))}catch(e){c.warn(e)}t&&this.setValues(t)},o.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?e.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):e.localStorage.removeItem("vjs-text-track-settings")}catch(e){c.warn(e)}}},o.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},o.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(t,"keydown",this.handleKeyDown);var e=this.player_.controlBar,n=e&&e.subsCapsButton,r=e&&e.captionsButton;n?n.focus():r&&r.focus()},i}(Tt)),Fe.registerComponent("ResizeManager",function(t){function n(n,r){var i,o=r.ResizeObserver||e.ResizeObserver;null===r.ResizeObserver&&(o=!1);var a=De({createEl:!o,reportTouchActivity:!1},r);return(i=t.call(this,n,a)||this).ResizeObserver=r.ResizeObserver||e.ResizeObserver,i.loadListener_=null,i.resizeObserver_=null,i.debouncedHandler_=Se(function(){i.resizeHandler()},100,!1,s(s(i))),o?(i.resizeObserver_=new i.ResizeObserver(i.debouncedHandler_),i.resizeObserver_.observe(n.el())):(i.loadListener_=function(){i.el_&&i.el_.contentWindow&&he(i.el_.contentWindow,"resize",i.debouncedHandler_)},i.one("load",i.loadListener_)),i}r(n,t);var i=n.prototype;return i.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},i.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},i.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&fe(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},n}(Fe));var gi=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),r=[],i="";if(!n.length)return!1;for(var o=0;o<n.length;o++){var s=n[o].src;s&&-1===r.indexOf(s)&&r.push(s)}return!!r.length&&(1===r.length&&(i=r[0]),e.triggerSourceset(i),!0)},vi=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(n){var r=t.createElement(this.nodeName.toLowerCase());r.innerHTML=n;for(var i=t.createDocumentFragment();r.childNodes.length;)i.appendChild(r.childNodes[0]);return this.innerText="",e.Element.prototype.appendChild.call(this,i),this.innerHTML}}),mi=function(e,t){for(var n={},r=0;r<e.length&&!((n=Object.getOwnPropertyDescriptor(e[r],t))&&n.set&&n.get);r++);return n.enumerable=!0,n.configurable=!0,n},yi=function(t){var n=t.el();if(!n.resetSourceWatch_){var r={},i=function(t){return mi([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,vi],"innerHTML")}(t),o=function(e){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var s=e.apply(n,i);return gi(t),s}};["append","appendChild","insertAdjacentHTML"].forEach(function(e){n[e]&&(r[e]=n[e],n[e]=o(r[e]))}),Object.defineProperty(n,"innerHTML",De(i,{set:o(i.set)})),n.resetSourceWatch_=function(){n.resetSourceWatch_=null,Object.keys(r).forEach(function(e){n[e]=r[e]}),Object.defineProperty(n,"innerHTML",i)},t.one("sourceset",n.resetSourceWatch_)}},_i=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Ft(e.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return e.Element.prototype.setAttribute.call(this,"src",t),t}});function bi(){var e=a(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return bi=function(){return e},e}var wi=function(n){function i(e,t){var r;r=n.call(this,e,t)||this;var i=e.source,o=!1;if(i&&(r.el_.currentSrc!==i.src||e.tag&&3===e.tag.initNetworkState_)?r.setSource(i):r.handleLateInit_(r.el_),e.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){for(var s=r.el_.childNodes,a=s.length,u=[];a--;){var l=s[a];"track"===l.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(l),r.remoteTextTracks().addTrack(l.track),r.textTracks().addTrack(l.track),o||r.el_.hasAttribute("crossorigin")||!Vt(l.src)||(o=!0)):u.push(l))}for(var h=0;h<u.length;h++)r.el_.removeChild(u[h])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&o&&c.warn(f(bi())),r.restoreMetadataTracksInIOSNativePlayer_(),(st||Ke||Qe)&&!0===e.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}r(i,n);var o=i.prototype;return o.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),i.disposeMediaElement(this.el_),this.options_=null,n.prototype.dispose.call(this)},o.setupSourcesetHandling_=function(){!function(t){if(t.featuresSourceset){var n=t.el();if(!n.resetSourceset_){var r=function(t){return mi([t.el(),e.HTMLMediaElement.prototype,_i],"src")}(t),i=n.setAttribute,o=n.load;Object.defineProperty(n,"src",De(r,{set:function(e){var i=r.set.call(n,e);return t.triggerSourceset(n.src),i}})),n.setAttribute=function(e,r){var o=i.call(n,e,r);return/src/i.test(e)&&t.triggerSourceset(n.src),o},n.load=function(){var e=o.call(n);return gi(t)||(t.triggerSourceset(""),yi(t)),e},n.currentSrc?t.triggerSourceset(n.currentSrc):gi(t)||yi(t),n.resetSourceset_=function(){n.resetSourceset_=null,n.load=o,n.setAttribute=i,Object.defineProperty(n,"src",r),n.resetSourceWatch_&&n.resetSourceWatch_()}}}}(this)},o.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var r=t[n];"metadata"===r.kind&&e.push({track:r,storedMode:r.mode})}};n(),t.addEventListener("change",n),this.on("dispose",function(){return t.removeEventListener("change",n)});var r=function n(){for(var r=0;r<e.length;r++){var i=e[r];"disabled"===i.track.mode&&i.track.mode!==i.storedMode&&(i.track.mode=i.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",n),t.removeEventListener("change",r),t.addEventListener("change",r)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",r)})},o.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach(function(e){n.el()[r+"Tracks"].removeEventListener(e,n[r+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},o.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},o.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},o.proxyNativeTracksForType_=function(e){var t=this,n=mn[e],r=this.el()[n.getterName],i=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&r&&r.addEventListener){var o={change:function(e){i.trigger({type:"change",target:i,currentTarget:i,srcElement:i})},addtrack:function(e){i.addTrack(e.track)},removetrack:function(e){i.removeTrack(e.track)}},s=function(){for(var e=[],t=0;t<i.length;t++){for(var n=!1,o=0;o<r.length;o++)if(r[o]===i[t]){n=!0;break}n||e.push(i[t])}for(;e.length;)i.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=o,Object.keys(o).forEach(function(e){var n=o[e];r.addEventListener(e,n),t.on("dispose",function(t){return r.removeEventListener(e,n)})}),this.on("loadstart",s),this.on("dispose",function(e){return t.off("loadstart",s)})}},o.proxyNativeTracks_=function(){var e=this;mn.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},o.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),i.disposeMediaElement(e),e=n}else{e=t.createElement("video");var r=De({},this.options_.tag&&L(this.options_.tag));st&&!0===this.options_.nativeControlsForTouch||delete r.controls,M(e,v(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&N(e,"preload",this.options_.preload);for(var o=["loop","muted","playsinline","autoplay"],s=0;s<o.length;s++){var a=o[s],u=this.options_[a];void 0!==u&&(u?N(e,a,a):U(e,a),e[a]=u)}return e},o.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var r=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",r),void this.ready(function(){this.off("loadstart",n),this.off("loadedmetadata",r),t||this.trigger("loadstart")})}var i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(e){this.trigger(e)},this)})}},o.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){c(e,"Video is not ready. (Video.js)")}},o.duration=function(){var e=this;return this.el_.duration===1/0&&Xe&&tt&&0===this.el_.currentTime?(this.on("timeupdate",function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))}),NaN):this.el_.duration||NaN},o.width=function(){return this.el_.offsetWidth},o.height=function(){return this.el_.offsetHeight},o.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)})}},o.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},o.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},o.exitFullScreen=function(){this.el_.webkitExitFullScreen()},o.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},o.reset=function(){i.resetMediaElement(this.el_)},o.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},o.setControls=function(e){this.el_.controls=!!e},o.addTextTrack=function(e,t,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,r):n.prototype.addTextTrack.call(this,e,t,r)},o.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return n.prototype.createRemoteTextTrack.call(this,e);var r=t.createElement("track");return e.kind&&(r.kind=e.kind),e.label&&(r.label=e.label),(e.language||e.srclang)&&(r.srclang=e.language||e.srclang),e.default&&(r.default=e.default),e.id&&(r.id=e.id),e.src&&(r.src=e.src),r},o.addRemoteTextTrack=function(e,t){var r=n.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},o.removeRemoteTextTrack=function(e){if(n.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),r=t.length;r--;)e!==t[r]&&e!==t[r].track||this.el().removeChild(t[r])},o.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),e.performance&&"function"==typeof e.performance.now?t.creationTime=e.performance.now():e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart&&(t.creationTime=e.Date.now()-e.performance.timing.navigationStart),t},i}(Yn);if(k()){wi.TEST_VID=t.createElement("video");var Ei=t.createElement("track");Ei.kind="captions",Ei.srclang="en",Ei.label="English",wi.TEST_VID.appendChild(Ei)}wi.isSupported=function(){try{wi.TEST_VID.volume=.5}catch(e){return!1}return!(!wi.TEST_VID||!wi.TEST_VID.canPlayType)},wi.canPlayType=function(e){return wi.TEST_VID.canPlayType(e)},wi.canPlaySource=function(e,t){return wi.canPlayType(e.type)},wi.canControlVolume=function(){try{var e=wi.TEST_VID.volume;return wi.TEST_VID.volume=e/2+.1,e!==wi.TEST_VID.volume}catch(e){return!1}},wi.canMuteVolume=function(){try{var e=wi.TEST_VID.muted;return wi.TEST_VID.muted=!e,wi.TEST_VID.muted?N(wi.TEST_VID,"muted","muted"):U(wi.TEST_VID,"muted"),e!==wi.TEST_VID.muted}catch(e){return!1}},wi.canControlPlaybackRate=function(){if(Xe&&tt&&nt<58)return!1;try{var e=wi.TEST_VID.playbackRate;return wi.TEST_VID.playbackRate=e/2+.1,e!==wi.TEST_VID.playbackRate}catch(e){return!1}},wi.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(t.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},wi.supportsNativeTextTracks=function(){return ot||$e&&tt},wi.supportsNativeVideoTracks=function(){return!(!wi.TEST_VID||!wi.TEST_VID.videoTracks)},wi.supportsNativeAudioTracks=function(){return!(!wi.TEST_VID||!wi.TEST_VID.audioTracks)},wi.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],wi.prototype.featuresVolumeControl=wi.canControlVolume(),wi.prototype.featuresMuteControl=wi.canMuteVolume(),wi.prototype.featuresPlaybackRate=wi.canControlPlaybackRate(),wi.prototype.featuresSourceset=wi.canOverrideAttributes(),wi.prototype.movingMediaElementInDOM=!$e,wi.prototype.featuresFullscreenResize=!0,wi.prototype.featuresProgressEvents=!0,wi.prototype.featuresTimeupdateEvents=!0,wi.prototype.featuresNativeTextTracks=wi.supportsNativeTextTracks(),wi.prototype.featuresNativeVideoTracks=wi.supportsNativeVideoTracks(),wi.prototype.featuresNativeAudioTracks=wi.supportsNativeAudioTracks();var ki=wi.TEST_VID&&wi.TEST_VID.constructor.prototype.canPlayType,Ti=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function Si(){var e=a(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return Si=function(){return e},e}wi.patchCanPlayType=function(){Je>=4&&!Ze&&!tt&&(wi.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&Ti.test(e)?"maybe":ki.call(this,e)})},wi.unpatchCanPlayType=function(){var e=wi.TEST_VID.constructor.prototype.canPlayType;return wi.TEST_VID.constructor.prototype.canPlayType=ki,e},wi.patchCanPlayType(),wi.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},wi.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){wi.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){wi.prototype["set"+Ue(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){wi.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(e){wi.prototype["set"+Ue(e)]=function(t){this.el_[e]=t}}),["pause","load","play"].forEach(function(e){wi.prototype[e]=function(){return this.el_[e]()}}),Yn.withSourceHandlers(wi),wi.nativeSourceHandler={},wi.nativeSourceHandler.canPlayType=function(e){try{return wi.TEST_VID.canPlayType(e)}catch(e){return""}},wi.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return wi.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Ht(e.src);return wi.nativeSourceHandler.canPlayType("video/"+n)}return""},wi.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},wi.nativeSourceHandler.dispose=function(){},wi.registerSourceHandler(wi.nativeSourceHandler),Yn.registerTech("Html5",wi);var Ci=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],xi={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ai=["tiny","xsmall","small","medium","large","xlarge","huge"],Ii={};Ai.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Ii[e]="vjs-layout-"+t});var Oi={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Pi=function(i){function o(e,t,r){var a;if(e.id=e.id||t.id||"vjs_video_"+ee(),(t=v(o.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var u=e.closest("[lang]");u&&u.getAttribute&&(t.language=u.getAttribute("lang"))}else for(var c=e;c&&1===c.nodeType;){if(L(c).hasOwnProperty("lang")){t.language=c.getAttribute("lang");break}c=c.parentNode}if((a=i.call(this,null,t,r)||this).log=l(a.id_),a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=e,a.tagAttributes=e&&L(e),a.language(a.options_.language),t.languages){var h={};Object.getOwnPropertyNames(t.languages).forEach(function(e){h[e.toLowerCase()]=t.languages[e]}),a.languages_=h}else a.languages_=o.prototype.options_.languages;a.cache_={},a.poster_=t.poster||"",a.controls_=!!t.controls,a.cache_.lastVolume=1,e.controls=!1,e.removeAttribute("controls"),e.hasAttribute("autoplay")?a.options_.autoplay=!0:a.autoplay(a.options_.autoplay),a.scrubbing_=!1,a.el_=a.createEl(),a.cache_.lastPlaybackRate=a.defaultPlaybackRate(),Le(s(s(a)),{eventBusKey:"el_"});var f=De(a.options_);if(t.plugins){var d=t.plugins;Object.keys(d).forEach(function(e){if("function"!=typeof this[e])throw new Error('plugin "'+e+'" does not exist');this[e](d[e])},s(s(a)))}a.options_.playerOptions=f,a.middleware_=[],a.initChildren(),a.isAudio("audio"===e.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),$e||a.addClass("vjs-workinghover"),o.players[a.id_]=s(s(a));var p=n.split(".")[0];return a.addClass("vjs-v"+p),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("fullscreenchange",a.handleFullscreenChange_),a.on("stageclick",a.handleStageClick_),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a.changingSrc_=!1,a.playWaitingForReady_=!1,a.playOnLoadstart_=null,a}r(o,i);var a=o.prototype;return a.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),o.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Jn[this.id()]=null,i.prototype.dispose.call(this)},a.createEl=function(){var n,r=this.tag,o=this.playerElIngest_=r.parentNode&&r.parentNode.hasAttribute&&r.parentNode.hasAttribute("data-vjs-player"),s="video-js"===this.tag.tagName.toLowerCase();o?n=this.el_=r.parentNode:s||(n=this.el_=i.prototype.createEl.call(this,"div"));var a=L(r);if(s){for(n=this.el_=r,r=this.tag=t.createElement("video");n.children.length;)r.appendChild(n.firstChild);O(n,"video-js")||P(n,"video-js"),n.appendChild(r),o=this.playerElIngest_=n,Object.keys(n).forEach(function(e){r[e]=n[e]})}if(r.setAttribute("tabindex","-1"),a.tabindex="-1",rt&&(r.setAttribute("role","application"),a.role="application"),r.removeAttribute("width"),r.removeAttribute("height"),"width"in a&&delete a.width,"height"in a&&delete a.height,Object.getOwnPropertyNames(a).forEach(function(e){s&&"class"===e||n.setAttribute(e,a[e]),s&&r.setAttribute(e,a[e])}),r.playerId=r.id,r.id+="_html5_api",r.className="vjs-tech",r.player=n.player=this,this.addClass("vjs-paused"),!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=we("vjs-styles-dimensions");var u=X(".vjs-styles-defaults"),c=X("head");c.insertBefore(this.styleEl_,u?u.nextSibling:c.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var l=r.getElementsByTagName("a"),h=0;h<l.length;h++){var f=l.item(h);P(f,"vjs-hidden"),f.setAttribute("hidden","hidden")}return r.initNetworkState_=r.networkState,r.parentNode&&!o&&r.parentNode.insertBefore(n,r),I(r,n),this.children_.unshift(r),this.el_.setAttribute("lang",this.language_),this.el_=n,n},a.width=function(e){return this.dimension("width",e)},a.height=function(e){return this.dimension("height",e)},a.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t)return this[n]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?c.error('Improper value "'+t+'" supplied for for '+e):(this[n]=r,this.updateStyleEl_())},a.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,e?(this.addClass("vjs-fluid"),this.fill(!1)):this.removeClass("vjs-fluid"),this.updateStyleEl_()},a.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},a.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},a.updateStyleEl_=function(){if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){var t,n,r,i=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),o=i[1]/i[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/o:this.videoWidth()||300,n=void 0!==this.height_?this.height_:t*o,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),Ee(this.styleEl_,"\n      ."+r+" {\n        width: "+t+"px;\n        height: "+n+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*o+"%;\n      }\n    ")}else{var s="number"==typeof this.width_?this.width_:this.options_.width,a="number"==typeof this.height_?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(s>=0&&(u.width=s),a>=0&&(u.height=a))}},a.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var r=Ue(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(Yn.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var o={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};_n.names.forEach(function(e){var t=_n[e];o[t.getterName]=n[t.privateName]}),v(o,this.options_[r]),v(o,this.options_[i]),v(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);var s,a=Yn.getTech(e);if(!a)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new a(o),this.tech_.ready(ke(this,this.handleTechReady_),!0),s=this.tech_,(this.textTracksJson_||[]).forEach(function(e){var t=s.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return t.addCue(e)})}),s.textTracks(),Ci.forEach(function(e){n.on(n.tech_,e,n["handleTech"+Ue(e)+"_"])}),Object.keys(xi).forEach(function(e){n.on(n.tech_,e,function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+xi[e]+"_"].bind(n),event:t}):n["handleTech"+xi[e]+"_"](t)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||I(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},a.unloadTech_=function(){var e,t,n,r=this;_n.names.forEach(function(e){var t=_n[e];r[t.privateName]=r[t.getterName]()}),this.textTracksJson_=(t=(e=this.tech_).$$("track"),n=Array.prototype.map.call(t,function(e){return e.track}),Array.prototype.map.call(t,function(e){var t=Et(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===n.indexOf(e)}).map(Et))),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},a.tech=function(e){return void 0===e&&c.warn(f(Si())),this.tech_},a.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},a.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},a.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},a.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},a.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var n,r=function(){var e=t.muted();t.muted(!0);var n=t.play();if(n&&n.then&&n.catch)return n.catch(function(n){t.muted(e)})};if("any"===e?(n=this.play())&&n.then&&n.catch&&n.catch(function(){return r()}):n="muted"===e?r():this.play(),n&&n.then&&n.catch)return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(n){t.trigger({type:"autoplay-failure",autoplay:e})})}},a.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(e){return e.src===t});if(n.length)return n[0].type;for(var r=e.$$("source"),i=0;i<r.length;i++){var o=r[i];if(o.type&&o.src&&o.src===t)return o.type}return or(t)}(this,t)),this.cache_.source=De({},e,{src:t,type:n});for(var r=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),i=[],o=this.$$("source"),s=[],a=0;a<o.length;a++){var u=L(o[a]);i.push(u),u.src&&u.src===t&&s.push(u.src)}s.length&&!r.length?this.cache_.sources=i:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},a.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},r=this.currentSource().src,i=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(i)&&(!this.lastSource_||this.lastSource_.tech!==i&&this.lastSource_.player!==r)&&(n=function(){}),n(i),e.src||this.tech_.one(["sourceset","loadstart"],function e(n){if("sourceset"!==n.type){var r=t.techGet("currentSrc");t.lastSource_.tech=r,t.updateSourceCaches_(r)}t.tech_.off(["sourceset","loadstart"],e)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},a.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},a.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},a.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},a.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return e.removeClass("vjs-waiting")})},a.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},a.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},a.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},a.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},a.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},a.handleTechFirstPlay_=function(){this.options_.starttime&&(c.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},a.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},a.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},a.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},a.handleTechClick_=function(e){Y(e)&&this.controls_&&(this.paused()?wt(this.play()):this.pause())},a.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)})||(this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},a.handleTechTap_=function(){this.userActive(!this.userActive())},a.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},a.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},a.handleTechTouchEnd_=function(e){e.preventDefault()},a.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},a.handleStageClick_=function(){this.reportUserActivity()},a.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},a.handleTechError_=function(){var e=this.tech_.error();this.error(e)},a.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},a.getCache=function(){return this.cache_},a.techCall_=function(e,t){this.ready(function(){if(e in tr)return function(e,t,n,r){return t[n](e.reduce(rr(n),r))}(this.middleware_,this.tech_,e,t);if(e in nr)return Zn(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw c(e),e}},!0)},a.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in er)return function(e,t,n){return e.reduceRight(rr(n),t[n]())}(this.middleware_,this.tech_,e);if(e in nr)return Zn(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw c("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw c("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw c(t),t}}},a.play=function(){var t=this,n=this.options_.Promise||e.Promise;return n?new n(function(e){t.play_(e)}):this.play_()},a.play_=function(e){var t=this;if(void 0===e&&(e=wt),this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc()))return void e(this.techGet_("play"));this.playOnLoadstart_=function(){t.playOnLoadstart_=null,e(t.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){t.playWaitingForReady_=!1,e(t.play())})}},a.pause=function(){this.techCall_("pause")},a.paused=function(){return!1!==this.techGet_("paused")},a.played=function(){return this.techGet_("played")||lt(0,0)},a.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},a.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},a.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))},a.remainingTime=function(){return this.duration()-this.currentTime()},a.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},a.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=lt(0,0)),e},a.bufferedPercent=function(){return ht(this.buffered(),this.duration())},a.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},a.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},a.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},a.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},a.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},a.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},a.isFullscreen=function(e){if(void 0===e)return!!this.isFullscreen_;this.isFullscreen_=!!e},a.requestFullscreen=function(){var e=dt;this.isFullscreen(!0),e.requestFullscreen?(he(t,e.fullscreenchange,ke(this,function n(r){this.isFullscreen(t[e.fullscreenElement]),!1===this.isFullscreen()&&fe(t,e.fullscreenchange,n),this.trigger("fullscreenchange")})),this.el_[e.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},a.exitFullscreen=function(){var e=dt;this.isFullscreen(!1),e.requestFullscreen?t[e.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},a.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=t.documentElement.style.overflow,he(t,"keydown",ke(this,this.fullWindowOnEscKey)),t.documentElement.style.overflow="hidden",P(t.body,"vjs-full-window"),this.trigger("enterFullWindow")},a.fullWindowOnEscKey=function(e){27===e.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},a.exitFullWindow=function(){this.isFullWindow=!1,fe(t,"keydown",this.fullWindowOnEscKey),t.documentElement.style.overflow=this.docOrigOverflow,R(t.body,"vjs-full-window"),this.trigger("exitFullWindow")},a.canPlayType=function(e){for(var t,n=0,r=this.options_.techOrder;n<r.length;n++){var i=r[n],o=Yn.getTech(i);if(o||(o=Fe.getComponent(i)),o){if(o.isSupported()&&(t=o.canPlayType(e)))return t}else c.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return""},a.selectSource=function(e){var t,n=this,r=this.options_.techOrder.map(function(e){return[e,Yn.getTech(e)]}).filter(function(e){var t=e[0],n=e[1];return n?n.isSupported():(c.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),i=function(e,t,n){var r;return e.some(function(e){return t.some(function(t){if(r=n(e,t))return!0})}),r},o=function(e,t){var r=e[0];if(e[1].canPlaySource(t,n.options_[r.toLowerCase()]))return{source:t,tech:r}};return(this.options_.sourceOrder?i(e,r,(t=o,function(e,n){return t(n,e)})):i(r,e,o))||!1},a.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var n,r,i,o=function e(t){if(Array.isArray(t)){var n=[];t.forEach(function(t){t=e(t),Array.isArray(t)?n=n.concat(t):m(t)&&n.push(t)}),t=n}else t="string"==typeof t&&t.trim()?[sr({src:t})]:m(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[sr(t)]:[];return t}(e);o.length?(this.changingSrc_=!0,this.cache_.sources=o,this.updateSourceCaches_(o[0]),r=o[0],i=function(e,n){var r;if(t.middleware_=n,t.cache_.sources=o,t.updateSourceCaches_(e),t.src_(e))return o.length>1?t.src(o.slice(1)):(t.changingSrc_=!1,t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void t.triggerReady());r=t.tech_,n.forEach(function(e){return e.setTech&&e.setTech(r)})},(n=this).setTimeout(function(){return function e(t,n,r,i,o,s){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===o&&(o=[]),void 0===s&&(s=!1);var a=n[0],u=n.slice(1);if("string"==typeof a)e(t,Xn[a],r,i,o,s);else if(a){var c=function(e,t){var n=Jn[e.id()],r=null;if(null==n)return r=t(e),Jn[e.id()]=[[t,r]],r;for(var i=0;i<n.length;i++){var o=n[i];o[0]===t&&(r=o[1])}return null===r&&(r=t(e),n.push([t,r])),r}(i,a);if(!c.setSource)return o.push(c),e(t,u,r,i,o,s);c.setSource(v({},t),function(n,a){if(n)return e(t,u,r,i,o,s);o.push(c),e(a,t.type===a.type?u:Xn[a.type],r,i,o,s)})}else u.length?e(t,u,r,i,o,s):s?r(t,o):e(t,Xn["*"],r,i,o,!0)}(r,Xn[r.type],i,n)},1)):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},a.src_=function(e){var t,n=this,r=this.selectSource([e]);return!r||(t=this.techName_,Ue(r.tech)!==Ue(t)?(this.changingSrc_=!0,this.loadTech_(r.tech,r.source),this.tech_.ready(function(){n.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1))},a.load=function(){this.techCall_("load")},a.reset=function(){this.tech_&&this.tech_.clearTracks("text"),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset")},a.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},a.currentSource=function(){return this.cache_.source||{}},a.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},a.currentType=function(){return this.currentSource()&&this.currentSource().type||""},a.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},a.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=t||this.options_.autoplay,this.tech_&&this.techCall_("setAutoplay",t)},a.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},a.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},a.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},a.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},a.controls=function(e){if(void 0===e)return!!this.controls_;this.controls_!==(e=!!e)&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},a.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;this.usingNativeControls_!==(e=!!e)&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},a.error=function(e){return void 0===e?this.error_||null:null===e?(this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new yt(e),this.addClass("vjs-error"),c.error("(CODE:"+this.error_.code+" "+yt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},a.reportUserActivity=function(e){this.userActivity_=!0},a.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},a.listenForUserActivity_=function(){var e,t,n,r,i=ke(this,this.reportUserActivity);this.on("mousedown",function(){i(),this.clearInterval(e),e=this.setInterval(i,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,i())}),this.on("mouseup",function(t){i(),this.clearInterval(e)}),this.on("keydown",i),this.on("keyup",i),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(r);var e=this.options_.inactivityTimeout;e<=0||(r=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},a.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},a.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},a.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},a.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},a.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},a.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},a.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},a.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},a.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},a.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},a.languages=function(){return De(o.prototype.options_.languages,this.languages_)},a.toJSON=function(){var e=De(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var r=t[n];(r=De(r)).player=void 0,e.tracks[n]=r}return e},a.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var r=new Tt(this,t);return this.addChild(r),r.on("dispose",function(){n.removeChild(r)}),r.open(),r},a.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Ai.length;n++){var r=Ai[n];if(t<=this.breakpoints_[r]){if(e===r)return;e&&this.removeClass(Ii[e]),this.addClass(Ii[r]),this.breakpoint_=r;break}}},a.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},a.breakpoints=function(e){return void 0===e?v(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=v({},Oi,e),this.updateCurrentBreakpoint_(),v(this.breakpoints_))},a.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},a.currentBreakpoint=function(){return this.breakpoint_},a.currentBreakpointClass=function(){return Ii[this.breakpoint_]||""},o.getTagSettings=function(e){var t={sources:[],tracks:[]},n=L(e),r=n["data-setup"];if(O(e,"vjs-fill")&&(n.fill=!0),O(e,"vjs-fluid")&&(n.fluid=!0),null!==r){var i=function(e,t){var n,r=null;try{n=JSON.parse(e,void 0)}catch(e){r=e}return[r,n]}(r||"{}"),o=i[0],s=i[1];o&&c.error(o),v(n,s)}if(v(t,n),e.hasChildNodes())for(var a=e.childNodes,u=0,l=a.length;u<l;u++){var h=a[u],f=h.nodeName.toLowerCase();"source"===f?t.sources.push(L(h)):"track"===f&&t.tracks.push(L(h))}return t},a.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},o}(Fe);_n.names.forEach(function(e){var t=_n[e];Pi.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),Pi.players={};var Ri=e.navigator;Pi.prototype.options_={techOrder:Yn.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Ri&&(Ri.languages&&Ri.languages[0]||Ri.userLanguage||Ri.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){Pi.prototype[e]=function(){return this.techGet_(e)}}),Ci.forEach(function(e){Pi.prototype["handleTech"+Ue(e)+"_"]=function(){return this.trigger(e)}}),Fe.registerComponent("Player",Pi);var ji={},Mi=function(e){return ji.hasOwnProperty(e)},Li=function(e){return Mi(e)?ji[e]:void 0},Bi=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Ni=function(e,t,n){var r=(n?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)},Ui=function(e,t){return t.prototype.name=e,function(){Ni(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var s=o(t,[this].concat(r));return this[e]=function(){return s},Ni(this,s.getEventHash()),s}},Di=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,Le(this),delete this.trigger,Ne(this,this.constructor.defaultState),Bi(t,this.name),this.dispose=ke(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),de(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Ui(e,ji[e])},e.isBasic=function(t){var n="string"==typeof t?Li(t):t;return"function"==typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Mi(t))c.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Pi.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return ji[t]=n,"plugin"!==t&&(Pi.prototype[t]=e.isBasic(n)?function(e,t){var n=function(){Ni(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return Bi(this,e),Ni(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach(function(e){n[e]=t[e]}),n}(t,n):Ui(t,n)),n},e.deregisterPlugin=function(e){if("plugin"===e)throw new Error("Cannot de-register base plugin.");Mi(e)&&(delete ji[e],delete Pi.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(ji)),e.forEach(function(e){var n=Li(e);n&&((t=t||{})[e]=n)}),t},e.getPluginVersion=function(e){var t=Li(e);return t&&t.VERSION||""},e}();Di.getPlugin=Li,Di.BASE_PLUGIN_NAME="plugin",Di.registerPlugin("plugin",Di),Pi.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},Pi.prototype.hasPlugin=function(e){return!!Mi(e)};var Fi=function(e){return 0===e.indexOf("#")?e.slice(1):e};function Hi(e,n,r){var i=Hi.getPlayer(e);if(i)return n&&c.warn('Player "'+e+'" is already initialised. Options will not be applied.'),r&&i.ready(r),i;var o="string"==typeof e?X("#"+Fi(e)):e;if(!T(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");t.body.contains(o)||c.warn("The element supplied is not included in the DOM"),n=n||{},Hi.hooks("beforesetup").forEach(function(e){var t=e(o,De(n));m(t)&&!Array.isArray(t)?n=De(n,t):c.error("please return an object in beforesetup hooks")});var s=Fe.getComponent("Player");return i=new s(o,n,r),Hi.hooks("setup").forEach(function(e){return e(i)}),i}if(Hi.hooks_={},Hi.hooks=function(e,t){return Hi.hooks_[e]=Hi.hooks_[e]||[],t&&(Hi.hooks_[e]=Hi.hooks_[e].concat(t)),Hi.hooks_[e]},Hi.hook=function(e,t){Hi.hooks(e,t)},Hi.hookOnce=function(e,t){Hi.hooks(e,[].concat(t).map(function(t){return function n(){return Hi.removeHook(e,n),t.apply(void 0,arguments)}}))},Hi.removeHook=function(e,t){var n=Hi.hooks(e).indexOf(t);return!(n<=-1||((Hi.hooks_[e]=Hi.hooks_[e].slice()).splice(n,1),0))},!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&k()){var Vi=X(".vjs-styles-defaults");if(!Vi){Vi=we("vjs-styles-defaults");var Wi=X("head");Wi&&Wi.insertBefore(Vi,Wi.firstChild),Ee(Vi,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}return _e(1,Hi),Hi.VERSION=n,Hi.options=Pi.prototype.options_,Hi.getPlayers=function(){return Pi.players},Hi.getPlayer=function(e){var t,n=Pi.players;if("string"==typeof e){var r=Fi(e),i=n[r];if(i)return i;t=X("#"+r)}else t=e;if(T(t)){var o=t.player,s=t.playerId;if(o||n[s])return o||n[s]}},Hi.getAllPlayers=function(){return Object.keys(Pi.players).map(function(e){return Pi.players[e]}).filter(Boolean)},Hi.players=Pi.players,Hi.getComponent=Fe.getComponent,Hi.registerComponent=function(e,t){Yn.isTech(t)&&c.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),Fe.registerComponent.call(Fe,e,t)},Hi.getTech=Yn.getTech,Hi.registerTech=Yn.registerTech,Hi.use=function(e,t){Xn[e]=Xn[e]||[],Xn[e].push(t)},Object.defineProperty(Hi,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Hi.middleware,"TERMINATOR",{value:Qn,writeable:!1,enumerable:!0}),Hi.browser=at,Hi.TOUCH_ENABLED=st,Hi.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},r={};for(var i in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),r=t):"function"==typeof t&&(n=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(n,e),r)r.hasOwnProperty(i)&&(n.prototype[i]=r[i]);return n},Hi.mergeOptions=De,Hi.bind=ke,Hi.registerPlugin=Di.registerPlugin,Hi.deregisterPlugin=Di.deregisterPlugin,Hi.plugin=function(e,t){return c.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Di.registerPlugin(e,t)},Hi.getPlugins=Di.getPlugins,Hi.getPlugin=Di.getPlugin,Hi.getPluginVersion=Di.getPluginVersion,Hi.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),(Hi.options.languages=De(Hi.options.languages,((n={})[e]=t,n)))[e]},Hi.log=c,Hi.createLogger=l,Hi.createTimeRange=Hi.createTimeRanges=lt,Hi.formatTime=mr,Hi.setFormatTime=function(e){vr=e},Hi.resetFormatTime=function(){vr=gr},Hi.parseUrl=Dt,Hi.isCrossOrigin=Vt,Hi.EventTarget=Ce,Hi.on=he,Hi.one=pe,Hi.off=fe,Hi.trigger=de,Hi.xhr=on,Hi.TextTrack=hn,Hi.AudioTrack=fn,Hi.VideoTrack=dn,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){Hi[e]=function(){return c.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Q[e].apply(null,arguments)}}),Hi.computedStyle=_,Hi.dom=Q,Hi.url=Wt,Hi}(n(41),n(26))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=a(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(74)("wks"),i=n(43),o=n(9).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r},function(e,t){e.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(t=e.exports=n(142)).Stream=t,t.Readable=t,t.Writable=n(145),t.Duplex=n(40),t.Transform=n(147),t.PassThrough=n(331)},function(e,t,n){e.exports=!n(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(19),i=n(104),o=n(35),s=Object.defineProperty;t.f=n(12)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(9),i=n(28),o=n(27),s=n(43)("src"),a=Function.toString,u=(""+a).split("toString");n(8).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(c&&(o(n,s)||i(n,s,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,n){var r=n(0),i=n(3),o=n(31),s=/"/g,a=function(e,t,n,r){var i=String(o(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),a+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(a),r(r.P+r.F*i(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(343)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(4))},function(e,t,n){var r=n(38),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(o(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,u=0;u<s;u++)c[u].apply(this,a);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var s;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var n,o,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){var r=n(5);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var r=n(31);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";var r=n(3);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){var r=n(44),i=n(31);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(0),i=n(8),o=n(3);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.videojsUntyped=r},function(e,t,n){var r=n(1),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){(function(t){var r,i=void 0!==t?t:"undefined"!=typeof window?window:{},o=n(296);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=o),e.exports=r}).call(this,n(10))},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(13),i=n(42);e.exports=n(12)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(36),i=n(44),o=n(20),s=n(17),a=n(268);e.exports=function(e,t){var n=1==e,u=2==e,c=3==e,l=4==e,h=6==e,f=5==e||h,d=t||a;return function(t,a,p){for(var g,v,m=o(t),y=i(m),_=r(a,p,3),b=s(y.length),w=0,E=n?d(t,b):u?d(t,0):void 0;b>w;w++)if((f||w in y)&&(v=_(g=y[w],w,m),e))if(n)E[w]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return w;case 2:E.push(g)}else if(l)return!1;return h?-1:c||l?l:E}}},function(e,t,n){var r=n(43)("meta"),i=n(5),o=n(27),s=n(13).f,a=0,u=Object.isExtensible||function(){return!0},c=!n(3)(function(){return u(Object.preventExtensions({}))}),l=function(e){s(e,r,{value:{i:"O"+ ++a,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!o(e,r)&&l(e),e}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return r.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var s=i>=0?arguments[i]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,r="/"===s.charAt(0))}return(r?"/":"")+(t=n(o(t.split("/"),function(e){return!!e}),!r).join("/"))||"."},t.normalize=function(e){var r=t.isAbsolute(e),i="/"===s(e,-1);return(e=n(o(e.split("/"),function(e){return!!e}),!r).join("/"))||r||(e="."),e&&i&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),s=Math.min(i.length,o.length),a=s,u=0;u<s;u++)if(i[u]!==o[u]){a=u;break}var c=[];for(u=a;u<i.length;u++)c.push("..");return(c=c.concat(o.slice(a))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},t.basename=function(e,t){var n=i(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return i(e)[3]};var s="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(4))},function(e,t,n){var r=n(341);function i(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)};return t.onceError=(e.name||"Function wrapped with `once`")+" shouldn't be called more than once",t.called=!1,t}e.exports=r(i),e.exports.strict=r(o),i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t,n){var r=n(5);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(57);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(107),i=n(76);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toTitleCase=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};var r=[{max:1024,type:"B"},{max:1048576,type:"KB"},{max:1073741824,type:"MB"},{max:10995116e5,type:"GB"}];t.bytes=function(e){var t=r.find(function(t){return e<t.max})||r[r.length-1];return[Math.floor(e/(t.max/1024)).toString(),t.type]},t.isMobile=function(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)},t.buildVideoLink=function(e,t){if(t||(t=window.location.origin+window.location.pathname.replace("/embed/","/watch/")),e){var n=Math.floor(e),r=new URLSearchParams(window.location.search);return r.set("start",function(e){var t="",n=Math.floor(e/3600);n>=1&&(t=n+"h"),e%=3600;var r=Math.floor(e/60);return r>=1&&(t+=r+"m"),(e%=60)>=1&&(t+=e+"s"),t}(n)),t+"?"+r.toString()}return t},t.timeToInt=function(e){if("number"==typeof e)return e;var t=e.match(/^((\d+)h)?((\d+)m)?((\d+)s?)?$/);return t?3600*parseInt(t[2]||"0",10)+60*parseInt(t[4]||"0",10)+parseInt(t[6]||"0",10):0},t.buildVideoEmbed=function(e){return'<iframe width="560" height="315" sandbox="allow-same-origin allow-scripts" src="'+e+'" frameborder="0" allowfullscreen></iframe>'},t.copyToClipboard=function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},t.videoFileMaxByResolution=function(e){for(var t=e[0],n=1;n<e.length;n++){var r=e[n];t.resolution.id<r.resolution.id&&(t=r)}return t},t.videoFileMinByResolution=function(e){for(var t=e[0],n=1;n<e.length;n++){var r=e[n];t.resolution.id>r.resolution.id&&(t=r)}return t}},function(e,t,n){"use strict";var r=n(67),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=h;var o=n(52);o.inherits=n(7);var s=n(142),a=n(145);o.inherits(h,s);for(var u=i(a.prototype),c=0;c<u.length;c++){var l=u[c];h.prototype[l]||(h.prototype[l]=a.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(10))},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(32);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(38),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(19),i=n(109),o=n(76),s=n(75)("IE_PROTO"),a=function(){},u=function(){var e,t=n(105)("iframe"),r=o.length;for(t.style.display="none",n(110).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[o[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){"use strict";var r=n(112),i={};i[n(6)("toStringTag")]="z",i+""!="[object z]"&&n(14)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t){e.exports={}},function(e,t,n){var r=n(6)("unscopables"),i=Array.prototype;null==i[r]&&n(28)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){var r=n(5);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){e.exports=function(){"use strict";return function(){var e=Math.floor(1000001*Math.random()),t={};function n(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}var r={},i=function(e){try{var n=JSON.parse(e.data);if("object"!=typeof n||null===n)throw"malformed"}catch(e){return}var i,o,s,a=e.source,u=e.origin;if("string"==typeof n.method){var c=n.method.split("::");2==c.length?(i=c[0],s=c[1]):s=n.method}if(void 0!==n.id&&(o=n.id),"string"==typeof s){var l=!1;if(t[u]&&t[u][i])for(var h=0;h<t[u][i].length;h++)if(t[u][i][h].win===a){t[u][i][h].handler(u,s,n),l=!0;break}if(!l&&t["*"]&&t["*"][i])for(h=0;h<t["*"][i].length;h++)if(t["*"][i][h].win===a){t["*"][i][h].handler(u,s,n);break}}else void 0!==o&&r[o]&&r[o](u,s,n)};return window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent&&window.attachEvent("onmessage",i),{build:function(i){var o=function(e){if(i.debugOutput&&window.console&&window.console.log){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){}window.console.log("["+u+"] "+e)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof i)throw"Channel build invoked without a proper object argument";if(!i.window||!i.window.postMessage)throw"Channel.build() called without a valid window argument";window===i.window&&o("target window is same as present window -- use at your own risk");var s,a=!1;if("string"==typeof i.origin&&("*"===i.origin?a=!0:null!==(s=i.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(i.origin=s[0].toLowerCase(),a=!0)),!a)throw"Channel.build() called with an invalid origin";if(void 0!==i.scope){if("string"!=typeof i.scope)throw"scope, when specified, must be a string";if(i.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}else i.scope="__default";var u=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),c={},l={},h={},f=!1,d=[],p=[],g=function(e,t,s){if("function"==typeof i.gotMessageObserver)try{i.gotMessageObserver(e,s)}catch(e){o("gotMessageObserver() raised an exception: "+e.toString())}if(s.id&&t){h[s.id]={};var a=function(e,t,n){var r=!1,i=!1;return{origin:t,invoke:function(t,r){if(!h[e])throw"attempting to invoke a callback of a nonexistent transaction: "+e;for(var i=!1,o=0;o<n.length;o++)if(t===n[o]){i=!0;break}if(!i)throw"request supports no such callback '"+t+"'";m({id:e,callback:t,params:r})},error:function(t,n){if(i=!0,!h[e])throw"error called for nonexistent message: "+e;delete h[e],m({id:e,error:t,message:n})},complete:function(t){if(i=!0,!h[e])throw"complete called for nonexistent message: "+e;delete h[e],m({id:e,result:t})},delayReturn:function(e){return"boolean"==typeof e&&(r=!0===e),r},completed:function(){return i}}}(s.id,e,s.callbacks?s.callbacks:[]);if(c[t])try{if(s.callbacks&&n(s.callbacks)&&s.callbacks.length>0)for(var u=0;u<s.callbacks.length;u++){for(var f=s.callbacks[u],d=s.params,p=f.split("/"),g=0;g<p.length-1;g++){var v=p[g];"object"!=typeof d[v]&&(d[v]={}),d=d[v]}d[p[p.length-1]]=function(){var e=f;return function(t){return a.invoke(e,t)}}()}var y=c[t](a,s.params);a.delayReturn()||a.completed()||a.complete(y)}catch(e){var _="runtime_error",b=null;if("string"==typeof e?b=e:"object"==typeof e&&(e instanceof Error?(_=e.constructor.name,b=e.message):e&&n(e)&&2==e.length?(_=e[0],b=e[1]):"string"==typeof e.error&&(_=e.error,e.message?"string"==typeof e.message?b=e.message:e=e.message:b="")),null===b)try{void 0===(b=JSON.stringify(e))&&(b=e.toString())}catch(t){b=e.toString()}a.error(_,b)}else a.error("method_not_found","No method '"+t+"' was (yet) bound by the provider")}else s.id&&s.callback?l[s.id]&&l[s.id].callbacks&&l[s.id].callbacks[s.callback]?l[s.id].callbacks[s.callback](s.params):o("ignoring invalid callback, id:"+s.id+" ("+s.callback+")"):s.id?l[s.id]?(s.error?l[s.id].error&&l[s.id].error(s.error,s.message):void 0!==s.result?l[s.id].success(s.result):l[s.id].success(),delete l[s.id],delete r[s.id]):o("ignoring invalid response: "+s.id):t&&c[t]&&c[t]({origin:e},s.params)};!function(e,n,r,i){function o(t){for(var n=0;n<t.length;n++)if(t[n].win===e)return!0;return!1}var s=!1;if("*"===n){for(var a in t)if(t.hasOwnProperty(a)&&"*"!==a&&"object"==typeof t[a][r]&&(s=o(t[a][r])))break}else t["*"]&&t["*"][r]&&(s=o(t["*"][r])),!s&&t[n]&&t[n][r]&&(s=o(t[n][r]));if(s)throw"A channel is already bound to the same window which overlaps with origin '"+n+"' and has scope '"+r+"'";"object"!=typeof t[n]&&(t[n]={}),"object"!=typeof t[n][r]&&(t[n][r]=[]),t[n][r].push({win:e,handler:i})}(i.window,i.origin,i.scope,g);var v=function(e){return[i.scope,e].join("::")},m=function(e,t){if(!e)throw"postMessage called with null message";if(t||f){if("function"==typeof i.postMessageObserver)try{i.postMessageObserver(i.origin,e)}catch(e){o("postMessageObserver() raised an exception: "+e.toString())}o("post message: "+JSON.stringify(e)+" with origin "+i.origin),i.window.postMessage(JSON.stringify(e),i.origin)}else o("queue message: "+JSON.stringify(e)),d.push(e)},y=function(e,t){var n;e=[].concat(e);for(var r=0;r<e.length;r++)t[n=e[r].toString()]=function(e){return function(t,n,r){n?_.call({method:e,params:t,success:n,error:r}):_.notify({method:e,params:t})}}(n)},_={remote:{},unbind:function(e,t){if(c[e]){if(!delete c[e])throw"can't delete method: "+e;return i.publish&&!t&&(f?_.notify({method:"__unbind",params:e}):p.push({action:"unbind",method:e})),!0}return!1},bind:function(e,t,n){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";if(c[e])throw"method '"+e+"' is already bound!";return c[e]=t,i.publish&&!n&&(f?_.notify({method:"__bind",params:e}):p.push({action:"bind",method:e})),this},call:function(t){if(!t)throw"missing arguments to call function";if(!t.method||"string"!=typeof t.method)throw"'method' argument to call must be string";if(!t.success||"function"!=typeof t.success)throw"'success' callback missing from call";var n={},i=[],o=[],s=function(e,t){if(o.indexOf(t)>=0)throw"params cannot be a recursive data structure";if(t&&o.push(t),"object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){var a=e+(e.length?"/":"")+r;"function"==typeof t[r]?(n[a]=t[r],i.push(a),delete t[r]):"object"==typeof t[r]&&s(a,t[r])}};s("",t.params);var a,u,c,h={id:e,method:v(t.method),params:t.params};i.length&&(h.callbacks=i),t.timeout&&(a=e,u=t.timeout,c=v(t.method),window.setTimeout(function(){l[a]&&(l[a].error&&l[a].error("timeout_error","timeout ("+u+"ms) exceeded on method '"+c+"'"),delete l[a],delete r[a])},u)),l[e]={callbacks:n,error:t.error,success:t.success},r[e]=g,e++,m(h)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";m({method:v(e.method),params:e.params})},destroy:function(){!function(e,n,r){for(var i=t[n][r],o=0;o<i.length;o++)i[o].win===e&&i.splice(o,1);0===t[n][r].length&&delete t[n][r]}(i.window,i.origin,i.scope),window.removeEventListener?window.removeEventListener("message",g,!1):window.detachEvent&&window.detachEvent("onmessage",g),f=!1,c={},h={},l={},i.origin=null,d=[],o("channel destroyed"),u=""}};return _.bind("__ready",function(e,t){if(o("ready msg received"),f&&!i.reconnect)throw"received ready message while in ready state.";f=!0,u.length<6&&(u+="publish-request"===t.type?"-R":"-L"),o("ready msg accepted."),"publish-request"===t.type&&_.notify({method:"__ready",params:{type:"publish-reply",publish:p}});for(var n=0;n<t.publish.length;n++)"bind"===t.publish[n].action?y([t.publish[n].method],_.remote):delete _.remote[t.publish[n].method];for(i.reconnect||_.unbind("__ready",!0);d.length;)m(d.splice(0,1)[0]);p=[],"function"==typeof i.onReady&&i.onReady(_)},!0),_.bind("__bind",function(e,t){y([t],_.remote)},!0),_.bind("__unbind",function(e,t){_.remote[t]&&delete _.remote[t]},!0),i.remote&&y(i.remote,_.remote),setTimeout(function(){u.length>0&&m({method:v("__ready"),params:{type:"publish-request",publish:p}},!0)},0),_}}}()}()},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(1).Buffer)},function(e,t,n){(function(t){e.exports=function(e,n){var r,i,o,s=!0;function a(e){function i(){n&&n(e,r),n=null}s?t.nextTick(i):i()}function u(e,t,n){r[e]=n,(0==--i||t)&&a(t)}Array.isArray(e)?(r=[],i=e.length):(o=Object.keys(e),r={},i=o.length),i?o?o.forEach(function(t){e[t](function(e,n){u(t,e,n)})}):e.forEach(function(e,t){e(function(e,n){u(t,e,n)})}):a(null),s=!1}}).call(this,n(4))},function(e,t,n){var r=new(n(342)),i="undefined"!=typeof window?window:self,o=i.crypto||i.msCrypto||{},s=o.subtle||o.webkitSubtle;function a(e){return r.digest(e)}try{s.digest({name:"sha-1"},new Uint8Array).catch(function(){s=!1})}catch(e){s=!1}e.exports=function(e,t){s?("string"==typeof e&&(e=function(e){for(var t=e.length,n=new Uint8Array(t),r=0;r<t;r++)n[r]=e.charCodeAt(r);return n}(e)),s.digest({name:"sha-1"},e).then(function(e){t(function(e){for(var t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")}(new Uint8Array(e)))},function(n){t(a(e))})):setTimeout(t,0,a(e))},e.exports.sync=a},function(e,t,n){"use strict";(function(t,r){var i=n(25).Buffer,o=t.crypto||t.msCrypto;e.exports=o&&o.getRandomValues?function(e,n){if(e>65536)throw new Error("requested too many random bytes");var s=new t.Uint8Array(e);e>0&&o.getRandomValues(s);var a=i.from(s.buffer);return"function"==typeof n?r.nextTick(function(){n(null,a)}):a}:function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,n(10),n(4))},function(e,t,n){(function(t){var r=n(396),i=n(397);e.exports=function(e,n,o){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative');if(t.alloc)return t.alloc(e,n,o);var s=i(e);return 0===e?s:void 0===n?r(s,0):("string"!=typeof o&&(o=void 0),r(s,n,o))}}).call(this,n(1).Buffer)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=!1},function(e,t,n){var r=n(13).f,i=n(27),o=n(6)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(107),i=n(76).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(60),i=n(42),o=n(22),s=n(35),a=n(27),u=n(104),c=Object.getOwnPropertyDescriptor;t.f=n(12)?c:function(e,t){if(e=o(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(a(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(0),i=n(31),o=n(3),s=n(80),a="["+s+"]",u=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),l=function(e,t,n){var i={},a=o(function(){return!!s[e]()||"\u200b\x85"!="\u200b\x85"[e]()}),u=i[e]=a?t(h):s[e];n&&(i[n]=u),r(r.P+r.F*a,"String",i)},h=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=l},function(e,t,n){"use strict";var r=n(121)(!0);n(84)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(28),i=n(14),o=n(3),s=n(31),a=n(6);e.exports=function(e,t,n){var u=a(e),c=n(s,u,""[e]),l=c[0],h=c[1];o(function(){var t={};return t[u]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,l),r(RegExp.prototype,u,2==t?function(e,t){return h.call(e,this,t)}:function(e){return h.call(e,this)}))}},function(e,t,n){var r=e.exports;r.encode=n(325),r.decode=n(326),r.byteLength=r.encodingLength=function(e){return r.encode(e).length}},function(e,t,n){"use strict";(function(t){e.exports=!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?{nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,n)});case 3:return t.nextTick(function(){e.call(null,n,r)});case 4:return t.nextTick(function(){e.call(null,n,r,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick(function(){e.apply(null,o)})}}}:t}).call(this,n(4))},function(e,t){},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},function(e,t,n){"use strict";var r=n(350),i=n(352);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=_,t.resolve=function(e,t){return _(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?_(e,!1,!0).resolveObject(t):t},t.format=function(e){return i.isString(e)&&(e=_(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),h=["%","/","?",";","#"].concat(l),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(154);function _(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var _=e=c.join(a);if(_=_.trim(),!n&&1===e.split("#").length){var b=u.exec(_);if(b)return this.path=_,this.href=_,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=s.exec(_);if(w){var E=(w=w[0]).toLowerCase();this.protocol=E,_=_.substr(w.length)}if(n||w||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===_.substr(0,2);!k||w&&v[w]||(_=_.substr(2),this.slashes=!0)}if(!v[w]&&(k||w&&!m[w])){for(var T,S,C=-1,x=0;x<f.length;x++)-1!==(A=_.indexOf(f[x]))&&(-1===C||A<C)&&(C=A);for(-1!==(S=-1===C?_.lastIndexOf("@"):_.lastIndexOf("@",C))&&(T=_.slice(0,S),_=_.slice(S+1),this.auth=decodeURIComponent(T)),C=-1,x=0;x<h.length;x++){var A;-1!==(A=_.indexOf(h[x]))&&(-1===C||A<C)&&(C=A)}-1===C&&(C=_.length),this.host=_.slice(0,C),_=_.slice(C),this.parseHost(),this.hostname=this.hostname||"";var I="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!I)for(var O=this.hostname.split(/\./),P=(x=0,O.length);x<P;x++){var R=O[x];if(R&&!R.match(d)){for(var j="",M=0,L=R.length;M<L;M++)R.charCodeAt(M)>127?j+="x":j+=R[M];if(!j.match(d)){var B=O.slice(0,x),N=O.slice(x+1),U=R.match(p);U&&(B.push(U[1]),N.unshift(U[2])),N.length&&(_="/"+N.join(".")+_),this.hostname=B.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),I||(this.hostname=r.toASCII(this.hostname)),this.host=(this.hostname||"")+(this.port?":"+this.port:""),this.href+=this.host,I&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!g[E])for(x=0,P=l.length;x<P;x++){var D=l[x];if(-1!==_.indexOf(D)){var F=encodeURIComponent(D);F===D&&(F=escape(D)),_=_.split(D).join(F)}}var H=_.indexOf("#");-1!==H&&(this.hash=_.substr(H),_=_.slice(0,H));var V=_.indexOf("?");return-1!==V?(this.search=_.substr(V),this.query=_.substr(V+1),t&&(this.query=y.parse(this.query)),_=_.slice(0,V)):t&&(this.search="",this.query={}),_&&(this.pathname=_),m[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(this.pathname||"")+(this.search||"")),this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(_(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=e[l])}return m[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!m[e.protocol]){for(var h=Object.keys(e),f=0;f<h.length;f++){var d=h[f];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||v[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}return n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,(n.pathname||n.search)&&(n.path=(n.pathname||"")+(n.search||"")),n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var g=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=y||g||n.host&&e.pathname,b=_,w=n.pathname&&n.pathname.split("/")||[],E=(p=e.pathname&&e.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(E&&(n.hostname="",n.port=null,n.host&&(""===w[0]?w[0]=n.host:w.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),_=_&&(""===p[0]||""===w[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,w=p;else if(p.length)w||(w=[]),w.pop(),w=w.concat(p),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search))return E&&(n.hostname=n.host=w.shift(),(x=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=x.shift(),n.host=n.hostname=x.shift())),n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!w.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var k=w.slice(-1)[0],T=(n.host||e.host||w.length>1)&&("."===k||".."===k)||""===k,S=0,C=w.length;C>=0;C--)"."===(k=w[C])?w.splice(C,1):".."===k?(w.splice(C,1),S++):S&&(w.splice(C,1),S--);if(!_&&!b)for(;S--;S)w.unshift("..");!_||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),T&&"/"!==w.join("/").substr(-1)&&w.push("");var x,A=""===w[0]||w[0]&&"/"===w[0].charAt(0);return E&&(n.hostname=n.host=A?"":w.length?w.shift():"",(x=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=x.shift(),n.host=n.hostname=x.shift())),(_=_||n.host&&w.length)&&!A&&w.unshift(""),w.length?n.pathname=w.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 0===e.length?e:t?(n||e.sort(t),function(e,t){for(var n=1,r=e.length,i=e[0],o=e[0],s=1;s<r;++s)if(o=i,t(i=e[s],o)){if(s===n){n++;continue}e[n++]=i}return e.length=n,e}(e,t)):(n||e.sort(),function(e){for(var t=1,n=e.length,r=e[0],i=e[0],o=1;o<n;++o,i=r)if(i=r,(r=e[o])!==i){if(o===t){t++;continue}e[t++]=r}return e.length=t,e}(e))}},function(e,t,n){(function(t){var n=void 0!==t?t:Uint8Array;function r(e,t){if(!(this instanceof r))return new r(e,t);0===arguments.length&&(e=0),this.grow=t&&(isFinite(t.grow)&&i(t.grow)||t.grow)||0,"number"!=typeof e&&void 0!==e||(e=new n(i(e))).fill&&!e._isBuffer&&e.fill(0),this.buffer=e}function i(e){var t=e>>3;return e%8!=0&&t++,t}r.prototype.get=function(e){var t=e>>3;return t<this.buffer.length&&!!(this.buffer[t]&128>>e%8)},r.prototype.set=function(e,t){var n=e>>3;t||1===arguments.length?(this.buffer.length<n+1&&this._grow(Math.max(n+1,Math.min(2*this.buffer.length,this.grow))),this.buffer[n]|=128>>e%8):n<this.buffer.length&&(this.buffer[n]&=~(128>>e%8))},r.prototype._grow=function(e){if(this.buffer.length<e&&e<=this.grow){var t=new n(e);if(t.fill&&t.fill(0),this.buffer.copy)this.buffer.copy(t,0);else for(var r=0;r<this.buffer.length;r++)t[r]=this.buffer[r];this.buffer=t}},e.exports=r}).call(this,n(1).Buffer)},function(e,t,n){var r=n(161),i=n(56),o=n(99),s=n(398),a=t,u=t.containers={moov:["mvhd","meta","traks","mvex"],trak:["tkhd","tref","trgr","edts","meta","mdia","udta"],edts:["elst"],mdia:["mdhd","hdlr","elng","minf"],minf:["vmhd","smhd","hmhd","sthd","nmhd","dinf","stbl"],dinf:["dref"],stbl:["stsd","stts","ctts","cslg","stsc","stsz","stz2","stco","co64","stss","stsh","padb","stdp","sdtp","sbgps","sgpds","subss","saizs","saios"],mvex:["mehd","trexs","leva"],moof:["mfhd","meta","trafs"],traf:["tfhd","tfdt","trun","sbgps","sgpds","subss","saizs","saios","meta"]};a.encode=function(e,t,n){return a.encodingLength(e),n=n||0,t=t||i(e.length),a._encode(e,t,n)},a._encode=function(e,t,n){var i=e.type,o=e.length;o>4294967295&&(o=1),t.writeUInt32BE(o,n),t.write(e.type,n+4,4,"ascii");var c=n+8;if(1===o&&(r.encode(e.length,t,c),c+=8),s.fullBoxes[i]&&(t.writeUInt32BE(e.flags||0,c),t.writeUInt8(e.version||0,c),c+=4),u[i])u[i].forEach(function(n){if(5===n.length){var r=e[n]||[];n=n.substr(0,4),r.forEach(function(e){a._encode(e,t,c),c+=a.encode.bytes})}else e[n]&&(a._encode(e[n],t,c),c+=a.encode.bytes)}),e.otherBoxes&&e.otherBoxes.forEach(function(e){a._encode(e,t,c),c+=a.encode.bytes});else if(s[i]){var l=s[i].encode;l(e,t,c),c+=l.bytes}else{if(!e.buffer)throw new Error("Either `type` must be set to a known type (not'"+i+"') or `buffer` must be set");e.buffer.copy(t,c),c+=e.buffer.length}return a.encode.bytes=c-n,t},a.readHeaders=function(e,t,n){if((n=n||e.length)-(t=t||0)<8)return 8;var i,o,a=e.readUInt32BE(t),u=e.toString("ascii",t+4,t+8),c=t+8;if(1===a){if(n-t<16)return 16;a=r.decode(e,c),c+=8}return s.fullBoxes[u]&&(i=e.readUInt8(c),o=16777215&e.readUInt32BE(c),c+=4),{length:a,headersLen:c-t,contentLen:a-(c-t),type:u,version:i,flags:o}},a.decode=function(e,t,n){var r=a.readHeaders(e,t=t||0,n=n||e.length);if(!r||r.length>n-t)throw new Error("Data too short");return a.decodeWithoutHeaders(r,e,t+r.headersLen,t+r.length)},a.decodeWithoutHeaders=function(e,t,n,r){n=n||0,r=r||t.length;var i=e.type,c={};if(u[i]){c.otherBoxes=[];for(var l=u[i],h=n;r-h>=8;){var f=a.decode(t,h,r);if(h+=f.length,l.indexOf(f.type)>=0)c[f.type]=f;else if(l.indexOf(f.type+"s")>=0){var d=f.type+"s";(c[d]=c[d]||[]).push(f)}else c.otherBoxes.push(f)}}else s[i]?c=(0,s[i].decode)(t,n,r):c.buffer=o(t.slice(n,r));return c.length=e.length,c.contentLen=e.contentLen,c.type=e.type,c.version=e.version,c.flags=e.flags,c},a.encodingLength=function(e){var t=e.type,n=8;if(s.fullBoxes[t]&&(n+=4),u[t])u[t].forEach(function(t){if(5===t.length){var r=e[t]||[];t=t.substr(0,4),r.forEach(function(e){e.type=t,n+=a.encodingLength(e)})}else if(e[t]){var i=e[t];i.type=t,n+=a.encodingLength(i)}}),e.otherBoxes&&e.otherBoxes.forEach(function(e){n+=a.encodingLength(e)});else if(s[t])n+=s[t].encodingLength(e);else{if(!e.buffer)throw new Error("Either `type` must be set to a known type (not'"+t+"') or `buffer` must be set");n+=e.buffer.length}return n>4294967295&&(n+=8),e.length=n,n}},function(e,t,n){var r=n(8),i=n(9),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(58)?"pure":"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(74)("keys"),i=n(43);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(32);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(27),i=n(20),o=n(75)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t){e.exports="\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff"},function(e,t,n){var r=n(5),i=n(114).set;e.exports=function(e,t,n){var o,s=t.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){"use strict";var r=n(58),i=n(0),o=n(14),s=n(28),a=n(48),u=n(233),c=n(59),l=n(79),h=n(6)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,p,g,v,m){u(n,t,p);var y,_,b,w=function(e){if(!f&&e in S)return S[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},E=t+" Iterator",k="values"==g,T=!1,S=e.prototype,C=S[h]||S["@@iterator"]||g&&S[g],x=C||w(g),A=g?k?w("entries"):x:void 0,I="Array"==t&&S.entries||C;if(I&&(b=l(I.call(new e)))!==Object.prototype&&b.next&&(c(b,E,!0),r||"function"==typeof b[h]||s(b,h,d)),k&&C&&"values"!==C.name&&(T=!0,x=function(){return C.call(this)}),r&&!m||!f&&!T&&S[h]||s(S,h,x),a[t]=x,a[E]=d,g)if(y={values:k?x:w("values"),keys:v?x:w("keys"),entries:A},m)for(_ in y)_ in S||o(S,_,y[_]);else i(i.P+i.F*(f||T),t,y);return y}},function(e,t,n){var r=n(86),i=n(31);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(5),i=n(32),o=n(6)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(6)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";var r=n(9),i=n(13),o=n(12),s=n(6)("species");e.exports=function(e){var t=r[e];o&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(49),i=n(132),o=n(48),s=n(22);e.exports=n(84)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(19);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(14);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(36),i=n(126),o=n(127),s=n(19),a=n(17),u=n(129),c={},l={};(t=e.exports=function(e,t,n,h,f){var d,p,g,v,m=f?function(){return e}:u(e),y=r(n,h,t?2:1),_=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(d=a(e.length);d>_;_++)if((v=t?y(s(p=e[_])[0],p[1]):y(e[_]))===c||v===l)return v}else for(g=m.call(e);!(p=g.next()).done;)if((v=i(g,y,p.value,t))===c||v===l)return v}).BREAK=c,t.RETURN=l},function(e,t,n){"use strict";var r=n(9),i=n(0),o=n(14),s=n(91),a=n(30),u=n(93),c=n(92),l=n(5),h=n(3),f=n(130),d=n(59),p=n(81);e.exports=function(e,t,n,g,v,m){var y=r[e],_=y,b=v?"set":"add",w=_&&_.prototype,E={},k=function(e){var t=w[e];o(w,e,"delete"==e?function(e){return!(m&&!l(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(m&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return m&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof _&&(m||w.forEach&&!h(function(){(new _).entries().next()}))){var T=new _,S=T[b](m?{}:-0,1)!=T,C=h(function(){T.has(1)}),x=f(function(e){new _(e)}),A=!m&&h(function(){for(var e=new _,t=5;t--;)e[b](t,t);return!e.has(-0)});x||((_=t(function(t,n){c(t,_,e);var r=p(new y,t,_);return null!=n&&u(n,v,r[b],r),r})).prototype=w,w.constructor=_),(C||A)&&(k("delete"),k("has"),v&&k("get")),(A||S)&&k(b),m&&w.clear&&delete w.clear}else _=g.getConstructor(t,e,v,b),s(_.prototype,n),a.NEED=!0;return d(_,e),E[e]=_,i(i.G+i.W+i.F*(_!=y),E),m||g.setStrong(_,e,v),_}},function(e,t,n){(function(t){e.exports=l;var r=n(140),i=n(150),o=n(355),s=n(34),a=n(154),u=n(356),c=n(70);function l(e,n){if(e="string"==typeof e?{url:e}:Object.assign({},e),n=s(n),e.headers=Object.assign({},e.headers),Object.keys(e.headers).forEach(function(t){t.toLowerCase()!==t&&(e.headers[t.toLowerCase()]=e.headers[t],delete e.headers[t])}),e.url){var r=c.parse(e.url);r.hostname&&(e.hostname=r.hostname),r.port&&(e.port=r.port),r.protocol&&(e.protocol=r.protocol),r.auth&&(e.auth=r.auth),e.path=r.path,delete e.url}var f;null==e.maxRedirects&&(e.maxRedirects=10),e.method&&(e.method=e.method.toUpperCase()),e.body?f=e.json&&!h(e.body)?JSON.stringify(e.body):e.body:e.form&&(f="string"==typeof e.form?e.form:a.stringify(e.form),e.headers["content-type"]="application/x-www-form-urlencoded"),delete e.body,delete e.form,f&&(e.method||(e.method="POST"),h(f)||(e.headers["content-length"]=t.byteLength(f)),e.json&&(e.headers["content-type"]="application/json")),e.json&&(e.headers.accept="application/json"),e.headers["accept-encoding"]||(e.headers["accept-encoding"]="gzip, deflate");var d=("https:"===e.protocol?o:i).request(e,function(t){if(t.statusCode>=300&&t.statusCode<400&&"location"in t.headers)return e.url=t.headers.location,delete e.headers.host,t.resume(),301!==t.statusCode&&302!==t.statusCode||"POST"!==e.method||(e.method="GET",delete e.headers["content-length"],delete e.headers["content-type"]),0===e.maxRedirects?n(new Error("too many redirects")):(e.maxRedirects-=1,l(e,n));n(null,"function"==typeof u&&"HEAD"!==e.method?u(t):t)});return d.on("timeout",function(){d.abort(),n(new Error("Request timed out"))}),d.on("error",n),f&&h(f)?f.on("error",n).pipe(d):d.end(f),d}function h(e){return"function"==typeof e.pipe}l.concat=function(e,t){return l(e,function(n,i){if(n)return t(n);r(i,function(n,r){if(n)return t(n);if(e.json)try{r=JSON.parse(r.toString())}catch(n){return t(n,i,r)}t(null,i,r)})})},["get","post","put","patch","head","delete"].forEach(function(e){l[e]=function(t,n){return"string"==typeof t&&(t={url:t}),t.method=e.toUpperCase(),l(t,n)}})}).call(this,n(1).Buffer)},function(e,t,n){(function(t){e.exports=u;var r=n(16)("simple-peer"),i=n(360),o=n(7),s=n(55),a=n(11);function u(e){var t=this;if(!(t instanceof u))return new u(e);if(t._id=s(4).toString("hex").slice(0,7),t._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),a.Duplex.call(t,e),t.channelName=e.initiator?e.channelName||s(20).toString("hex"):null,t._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,t.initiator=e.initiator||!1,t.channelConfig=e.channelConfig||u.channelConfig,t.config=e.config||u.config,t.constraints=t._transformConstraints(e.constraints||u.constraints),t.offerConstraints=t._transformConstraints(e.offerConstraints||{}),t.answerConstraints=t._transformConstraints(e.answerConstraints||{}),t.sdpTransform=e.sdpTransform||function(e){return e},t.streams=e.streams||(e.stream?[e.stream]:[]),t.trickle=void 0===e.trickle||e.trickle,t.destroyed=!1,t.connected=!1,t.remoteAddress=void 0,t.remoteFamily=void 0,t.remotePort=void 0,t.localAddress=void 0,t.localPort=void 0,t._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:i(),!t._wrtc)throw"undefined"==typeof window?c("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):c("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");t._pcReady=!1,t._channelReady=!1,t._iceComplete=!1,t._channel=null,t._pendingCandidates=[],t._isNegotiating=!1,t._batchedNegotiation=!1,t._queuedNegotiation=!1,t._sendersAwaitingStable=[],t._senderMap=new WeakMap,t._remoteTracks=[],t._remoteStreams=[],t._chunk=null,t._cb=null,t._interval=null,t._pc=new t._wrtc.RTCPeerConnection(t.config,t.constraints),t._isReactNativeWebrtc="number"==typeof t._pc._peerConnectionId,t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()},t._pc.onicegatheringstatechange=function(){t._onIceStateChange()},t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()},t._pc.onicecandidate=function(e){t._onIceCandidate(e)},t.initiator?t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)}):t._pc.ondatachannel=function(e){t._setupData(e)},"addTrack"in t._pc&&(t.streams&&t.streams.forEach(function(e){t.addStream(e)}),t._pc.ontrack=function(e){t._onTrack(e)}),t.initiator&&t._needsNegotiation(),t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}function c(e,t){var n=new Error(e);return n.code=t,n}function l(){}o(u,a.Duplex),u.WEBRTC_SUPPORT=!!i(),u.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},u.constraints={},u.channelConfig={},Object.defineProperty(u.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),u.prototype.address=function(){return{port:this.localPort,family:"IPv4",address:this.localAddress}},u.prototype.signal=function(e){var t=this;if(t.destroyed)throw c("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}t._debug("signal()"),e.renegotiate&&(t._debug("got request to renegotiate"),t._needsNegotiation()),e.candidate&&(t._pc.remoteDescription&&t._pc.remoteDescription.type?t._addIceCandidate(e.candidate):t._pendingCandidates.push(e.candidate)),e.sdp&&t._pc.setRemoteDescription(new t._wrtc.RTCSessionDescription(e),function(){t.destroyed||(t._pendingCandidates.forEach(function(e){t._addIceCandidate(e)}),t._pendingCandidates=[],"offer"===t._pc.remoteDescription.type&&t._createAnswer())},function(e){t.destroy(c(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||t.destroy(c("signal() called with invalid signal data","ERR_SIGNALING"))},u.prototype._addIceCandidate=function(e){var t=this;try{t._pc.addIceCandidate(new t._wrtc.RTCIceCandidate(e),l,function(e){t.destroy(c(e,"ERR_ADD_ICE_CANDIDATE"))})}catch(e){t.destroy(c("error adding candidate: "+e.message,"ERR_ADD_ICE_CANDIDATE"))}},u.prototype.send=function(e){this._channel.send(e)},u.prototype.addStream=function(e){var t=this;t._debug("addStream()"),e.getTracks().forEach(function(n){t.addTrack(n,e)})},u.prototype.addTrack=function(e,t){this._debug("addTrack()");var n=this._pc.addTrack(e,t),r=this._senderMap.get(e)||new WeakMap;r.set(t,n),this._senderMap.set(e,r),this._needsNegotiation()},u.prototype.removeTrack=function(e,t){this._debug("removeSender()");var n=this._senderMap.get(e),r=n?n.get(t):null;r||this.destroy(new Error("Cannot remove track that was never added."));try{this._pc.removeTrack(r)}catch(e){"NS_ERROR_UNEXPECTED"===e.name?this._sendersAwaitingStable.push(r):this.destroy(e)}},u.prototype.removeStream=function(e){var t=this;t._debug("removeSenders()"),e.getTracks().forEach(function(n){t.removeTrack(n,e)})},u.prototype._needsNegotiation=function(){var e=this;e._debug("_needsNegotiation"),e._batchedNegotiation||(e._batchedNegotiation=!0,setTimeout(function(){e._batchedNegotiation=!1,e._debug("starting batched negotiation"),e.negotiate()},0))},u.prototype.negotiate=function(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),this._createOffer()):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0},u.prototype.destroy=function(e){this._destroy(e,function(){})},u.prototype._destroy=function(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this.connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,"addTrack"in this._pc&&(this._pc.ontrack=null),this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}},u.prototype._setupData=function(e){var t=this;if(!e.channel)return t.destroy(c("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));t._channel=e.channel,t._channel.binaryType="arraybuffer","number"==typeof t._channel.bufferedAmountLowThreshold&&(t._channel.bufferedAmountLowThreshold=65536),t.channelName=t._channel.label,t._channel.onmessage=function(e){t._onChannelMessage(e)},t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()},t._channel.onopen=function(){t._onChannelOpen()},t._channel.onclose=function(){t._onChannelClose()},t._channel.onerror=function(e){t.destroy(c(e,"ERR_DATA_CHANNEL"))}},u.prototype._read=function(){},u.prototype._write=function(e,t,n){if(this.destroyed)return n(c("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this.connected){try{this.send(e)}catch(e){return this.destroy(c(e,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},u.prototype._onFinish=function(){var e=this;function t(){setTimeout(function(){e.destroy()},1e3)}e.destroyed||(e.connected?t():e.once("connect",t))},u.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(function(t){function n(){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){e._debug("createOffer success"),e.destroyed||(e.trickle||e._iceComplete?n():e.once("_iceComplete",n))},function(t){e.destroy(c(t,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(t){e.destroy(c(t,"ERR_CREATE_OFFER"))},e.offerConstraints)},u.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(function(t){function n(){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}e.destroyed||(t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t,function(){e.destroyed||(e.trickle||e._iceComplete?n():e.once("_iceComplete",n))},function(t){e.destroy(c(t,"ERR_SET_LOCAL_DESCRIPTION"))}))},function(t){e.destroy(c(t,"ERR_CREATE_ANSWER"))},e.answerConstraints)},u.prototype._onIceStateChange=function(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(c("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(new Error("Ice connection closed."))}},u.prototype.getStats=function(e){var t=this;0===t._pc.getStats.length?t._pc.getStats().then(function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._isReactNativeWebrtc?t._pc.getStats(null,function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._pc.getStats.length>0?t._pc.getStats(function(n){if(!t.destroyed){var r=[];n.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,r.push(t)}),e(null,r)}},function(t){e(t)}):e(null,[])},u.prototype._maybeReady=function(){var e=this;e._debug("maybeReady pc %s channel %s",e._pcReady,e._channelReady),!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,function t(){e.destroyed||e.getStats(function(n,r){if(!e.destroyed){n&&(r=[]);var i={},o={},s={},a=!1;if(r.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(i[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(o[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(s[e.id]=e)}),r.forEach(function(e){"transport"===e.type&&e.selectedCandidatePairId&&l(s[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&l(e)}),a||Object.keys(s).length&&!Object.keys(o).length){if(e._connecting=!1,e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(n){return e.destroy(c(n,"ERR_DATA_CHANNEL"))}e._chunk=null,e._debug('sent chunk from "write before connect"');var u=e._cb;e._cb=null,u(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}else setTimeout(t,100)}function l(t){a=!0;var n=o[t.localCandidateId];n&&n.ip?(e.localAddress=n.ip,e.localPort=Number(n.port)):n&&n.ipAddress?(e.localAddress=n.ipAddress,e.localPort=Number(n.portNumber)):"string"==typeof t.googLocalAddress&&(n=t.googLocalAddress.split(":"),e.localAddress=n[0],e.localPort=Number(n[1]));var r=i[t.remoteCandidateId];r&&r.ip?(e.remoteAddress=r.ip,e.remotePort=Number(r.port)):r&&r.ipAddress?(e.remoteAddress=r.ipAddress,e.remotePort=Number(r.portNumber)):"string"==typeof t.googRemoteAddress&&(r=t.googRemoteAddress.split(":"),e.remoteAddress=r[0],e.remotePort=Number(r[1])),e.remoteFamily="IPv4",e._debug("connect local: %s:%s remote: %s:%s",e.localAddress,e.localPort,e.remoteAddress,e.remotePort)}})}())},u.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>65536||this._onChannelBufferedAmountLow()},u.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||("stable"===e._pc.signalingState&&(e._isNegotiating=!1,e._debug("flushing sender queue",e._sendersAwaitingStable),e._sendersAwaitingStable.forEach(function(t){e.removeTrack(t),e._queuedNegotiation=!0}),e._sendersAwaitingStable=[],e._queuedNegotiation&&(e._debug("flushing negotiation queue"),e._queuedNegotiation=!1,e._needsNegotiation()),e._debug("negotiate"),e.emit("negotiate")),e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},u.prototype._onIceCandidate=function(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||(this._iceComplete=!0,this.emit("_iceComplete")))},u.prototype._onChannelMessage=function(e){if(!this.destroyed){var n=e.data;n instanceof ArrayBuffer&&(n=t.from(n)),this.push(n)}},u.prototype._onChannelBufferedAmountLow=function(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}},u.prototype._onChannelOpen=function(){this.connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())},u.prototype._onChannelClose=function(){this.destroyed||(this._debug("on channel close"),this.destroy())},u.prototype._onTrack=function(e){var t=this;t.destroyed||e.streams.forEach(function(n){t._debug("on track"),t.emit("track",e.track,n),t._remoteTracks.push({track:e.track,stream:n}),t._remoteStreams.some(function(e){return e.id===n.id})||(t._remoteStreams.push(n),setTimeout(function(){t.emit("stream",n)},0))})},u.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],r.apply(null,e)},u.prototype._transformConstraints=function(e){if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!this._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!this._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})}}).call(this,n(1).Buffer)},function(e,t){var n,r=1,i=function(){r=r+1&65535};e.exports=function(e){n||(n=setInterval(i,250)).unref&&n.unref();var t=4*(e||5),o=[0],s=1,a=r-1&65535;return function(e){var n=r-a&65535;for(n>t&&(n=t),a=r;n--;)s===t&&(s=0),o[s]=o[0===s?t-1:s-1],s++;e&&(o[s-1]+=e);var i=o[s-1];return o.length<4?i:4*(i-(o.length<t?0:o[s===t?0:s]))/o.length}}},function(e,t,n){e.exports=u;var r=n(7),i=n(11),o=n(153),s="undefined"!=typeof window&&window.MediaSource,a=60;function u(e,t){var n=this;if(!(n instanceof u))return new u(e,t);if(!s)throw new Error("web browser lacks MediaSource support");t||(t={}),n._debug=t.debug,n._bufferDuration=t.bufferDuration||a,n._elem=e,n._mediaSource=new s,n._streams=[],n.detailedError=null,n._errorHandler=function(){n._elem.removeEventListener("error",n._errorHandler),n._streams.slice().forEach(function(e){e.destroy(n._elem.error)})},n._elem.addEventListener("error",n._errorHandler),n._elem.src=window.URL.createObjectURL(n._mediaSource)}function c(e,t){var n=this;if(i.Writable.call(n),n._wrapper=e,n._elem=e._elem,n._mediaSource=e._mediaSource,n._allStreams=e._streams,n._allStreams.push(n),n._bufferDuration=e._bufferDuration,n._sourceBuffer=null,n._debugBuffers=[],n._openHandler=function(){n._onSourceOpen()},n._flowHandler=function(){n._flow()},n._errorHandler=function(e){n.destroyed||n.emit("error",e)},"string"==typeof t)n._type=t,"open"===n._mediaSource.readyState?n._createSourceBuffer():n._mediaSource.addEventListener("sourceopen",n._openHandler);else if(null===t._sourceBuffer)t.destroy(),n._type=t._type,n._mediaSource.addEventListener("sourceopen",n._openHandler);else{if(!t._sourceBuffer)throw new Error("The argument to MediaElementWrapper.createWriteStream must be a string or a previous stream returned from that function");t.destroy(),n._type=t._type,n._sourceBuffer=t._sourceBuffer,n._debugBuffers=t._debugBuffers,n._sourceBuffer.addEventListener("updateend",n._flowHandler),n._sourceBuffer.addEventListener("error",n._errorHandler)}n._elem.addEventListener("timeupdate",n._flowHandler),n.on("error",function(e){n._wrapper.error(e)}),n.on("finish",function(){if(!n.destroyed&&(n._finished=!0,n._allStreams.every(function(e){return e._finished}))){n._wrapper._dumpDebugData();try{n._mediaSource.endOfStream()}catch(e){}}})}u.prototype.createWriteStream=function(e){return new c(this,e)},u.prototype.error=function(e){this.detailedError||(this.detailedError=e),this._dumpDebugData();try{this._mediaSource.endOfStream("decode")}catch(e){}},u.prototype._dumpDebugData=function(){this._debug&&(this._debug=!1,this._streams.forEach(function(e,t){var n,r,i;n=e._debugBuffers,r="mediasource-stream-"+t,(i=document.createElement("a")).href=window.URL.createObjectURL(new window.Blob(n)),i.download=r,i.click()}))},r(c,i.Writable),c.prototype._onSourceOpen=function(){this.destroyed||(this._mediaSource.removeEventListener("sourceopen",this._openHandler),this._createSourceBuffer())},c.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._allStreams.splice(this._allStreams.indexOf(this),1),this._mediaSource.removeEventListener("sourceopen",this._openHandler),this._elem.removeEventListener("timeupdate",this._flowHandler),this._sourceBuffer&&(this._sourceBuffer.removeEventListener("updateend",this._flowHandler),this._sourceBuffer.removeEventListener("error",this._errorHandler),"open"===this._mediaSource.readyState&&this._sourceBuffer.abort()),e&&this.emit("error",e),this.emit("close"))},c.prototype._createSourceBuffer=function(){if(!this.destroyed)if(s.isTypeSupported(this._type)){if(this._sourceBuffer=this._mediaSource.addSourceBuffer(this._type),this._sourceBuffer.addEventListener("updateend",this._flowHandler),this._sourceBuffer.addEventListener("error",this._errorHandler),this._cb){var e=this._cb;this._cb=null,e()}}else this.destroy(new Error("The provided type is not supported"))},c.prototype._write=function(e,t,n){var r=this;if(!r.destroyed)if(r._sourceBuffer){if(r._sourceBuffer.updating)return n(new Error("Cannot append buffer while source buffer updating"));var i=o(e);r._wrapper._debug&&r._debugBuffers.push(i);try{r._sourceBuffer.appendBuffer(i)}catch(e){return void r.destroy(e)}r._cb=n}else r._cb=function(i){if(i)return n(i);r._write(e,t,n)}},c.prototype._flow=function(){if(!this.destroyed&&this._sourceBuffer&&!this._sourceBuffer.updating&&!("open"===this._mediaSource.readyState&&this._getBufferDuration()>this._bufferDuration)&&this._cb){var e=this._cb;this._cb=null,e()}},c.prototype._getBufferDuration=function(){for(var e=this._sourceBuffer.buffered,t=this._elem.currentTime,n=-1,r=0;r<e.length;r++){var i=e.start(r),o=e.end(r)+0;if(i>t)break;(n>=0||t<=o)&&(n=o)}var s=n-t;return s<0&&(s=0),s}},function(e,t,n){(function(t){var n=Object.prototype.toString,r="function"==typeof t.alloc&&"function"==typeof t.allocUnsafe&&"function"==typeof t.from;e.exports=function(e,i,o){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"ArrayBuffer"===n.call(e).slice(8,-1)?function(e,n,i){var o=e.byteLength-(n>>>=0);if(o<0)throw new RangeError("'offset' is out of bounds");if(void 0===i)i=o;else if((i>>>=0)>o)throw new RangeError("'length' is out of bounds");return r?t.from(e.slice(n,n+i)):new t(new Uint8Array(e.slice(n,n+i)))}(e,i,o):"string"==typeof e?function(e,n){if("string"==typeof n&&""!==n||(n="utf8"),!t.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');return r?t.from(e,n):new t(e,n)}(e,i):r?t.from(e):new t(e)}}).call(this,n(1).Buffer)},function(e){e.exports={name:"webtorrent",description:"Streaming torrent client",version:"0.102.4",author:{name:"WebTorrent, LLC",email:"feross@webtorrent.io",url:"https://webtorrent.io"},browser:{"./lib/server.js":!1,"./lib/tcp-pool.js":!1,"bittorrent-dht/client":!1,"fs-chunk-store":"memory-chunk-store","load-ip-set":!1,net:!1,os:!1,ut_pex:!1},browserify:{transform:["package-json-versionify"]},bugs:{url:"https://github.com/webtorrent/webtorrent/issues"},dependencies:{"addr-to-ip-port":"^1.4.2",bitfield:"^2.0.0","bittorrent-dht":"^9.0.0","bittorrent-protocol":"^3.0.0","chunk-store-stream":"^3.0.1","create-torrent":"^3.33.0",debug:"^4.0.1","end-of-stream":"^1.1.0","fs-chunk-store":"^1.6.2","immediate-chunk-store":"^2.0.0","load-ip-set":"^2.1.0","memory-chunk-store":"^1.2.0",mime:"^2.2.0",multistream:"^2.0.5","package-json-versionify":"^1.0.2","parse-numeric-range":"^0.0.2","parse-torrent":"^6.1.2",pump:"^3.0.0","random-iterate":"^1.0.1",randombytes:"^2.0.3","range-parser":"^1.2.0","readable-stream":"^3.0.2","render-media":"^3.0.0","run-parallel":"^1.1.6","run-parallel-limit":"^1.0.3","safe-buffer":"^5.0.1","simple-concat":"^1.0.0","simple-get":"^3.0.1","simple-peer":"^9.0.0","simple-sha1":"^2.0.8",speedometer:"^1.0.0","stream-to-blob":"^1.0.0","stream-to-blob-url":"^2.1.0","stream-with-known-length-to-buffer":"^1.0.0","torrent-discovery":"^9.1.1","torrent-piece":"^2.0.0",uniq:"^1.0.1","unordered-array-remove":"^1.0.2",ut_metadata:"^3.3.0",ut_pex:"^1.1.1"},devDependencies:{airtap:"0.1.0","babel-minify":"^0.4.3","bittorrent-tracker":"^9.4.0",brfs:"^2.0.0",browserify:"^16.0.0","cross-spawn":"^6.0.3",electron:"^2.0.0",finalhandler:"^1.0.0","network-address":"^1.1.0","run-series":"^1.1.4","serve-static":"^1.11.1",standard:"*",tape:"^4.6.0","webtorrent-fixtures":"^1.5.0"},engines:{node:">=4"},homepage:"https://webtorrent.io",keywords:["bittorrent","bittorrent client","download","mad science","p2p","peer-to-peer","peers","streaming","swarm","torrent","web torrent","webrtc","webrtc data","webtorrent"],license:"MIT",main:"index.js",repository:{type:"git",url:"git://github.com/webtorrent/webtorrent.git"},scripts:{build:"browserify -s WebTorrent -e ./ | minify > webtorrent.min.js","build-debug":"browserify -s WebTorrent -e ./ > webtorrent.debug.js",size:"npm run build && cat webtorrent.min.js | gzip | wc -c",test:"standard && npm run test-node && npm run test-browser","test-browser":"airtap -- test/*.js test/browser/*.js","test-browser-local":"airtap --local -- test/*.js test/browser/*.js","test-node":"tape test/*.js test/node/*.js","update-authors":"./scripts/update-authors.sh"}}},,,function(e,t,n){"use strict";var r=n(9),i=n(27),o=n(12),s=n(0),a=n(14),u=n(30).KEY,c=n(3),l=n(74),h=n(59),f=n(43),d=n(6),p=n(106),g=n(167),v=n(168),m=n(78),y=n(19),_=n(5),b=n(22),w=n(35),E=n(42),k=n(46),T=n(111),S=n(62),C=n(13),x=n(37),A=S.f,I=C.f,O=T.f,P=r.Symbol,R=r.JSON,j=R&&R.stringify,M=d("_hidden"),L=d("toPrimitive"),B={}.propertyIsEnumerable,N=l("symbol-registry"),U=l("symbols"),D=l("op-symbols"),F=Object.prototype,H="function"==typeof P,V=r.QObject,W=!V||!V.prototype||!V.prototype.findChild,q=o&&c(function(){return 7!=k(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=A(F,t);r&&delete F[t],I(e,t,n),r&&e!==F&&I(F,t,r)}:I,z=function(e){var t=U[e]=k(P.prototype);return t._k=e,t},K=H&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},G=function(e,t,n){return e===F&&G(D,t,n),y(e),t=w(t,!0),y(n),i(U,t)?(n.enumerable?(i(e,M)&&e[M][t]&&(e[M][t]=!1),n=k(n,{enumerable:E(0,!1)})):(i(e,M)||I(e,M,E(1,{})),e[M][t]=!0),q(e,t,n)):I(e,t,n)},$=function(e,t){y(e);for(var n,r=v(t=b(t)),i=0,o=r.length;o>i;)G(e,n=r[i++],t[n]);return e},Y=function(e){var t=B.call(this,e=w(e,!0));return!(this===F&&i(U,e)&&!i(D,e))&&(!(t||!i(this,e)||!i(U,e)||i(this,M)&&this[M][e])||t)},X=function(e,t){if(e=b(e),t=w(t,!0),e!==F||!i(U,t)||i(D,t)){var n=A(e,t);return!n||!i(U,t)||i(e,M)&&e[M][t]||(n.enumerable=!0),n}},J=function(e){for(var t,n=O(b(e)),r=[],o=0;n.length>o;)i(U,t=n[o++])||t==M||t==u||r.push(t);return r},Q=function(e){for(var t,n=e===F,r=O(n?D:b(e)),o=[],s=0;r.length>s;)!i(U,t=r[s++])||n&&!i(F,t)||o.push(U[t]);return o};H||(a((P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function(n){this===F&&t.call(D,n),i(this,M)&&i(this[M],e)&&(this[M][e]=!1),q(this,e,E(1,n))};return o&&W&&q(F,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",function(){return this._k}),S.f=X,C.f=G,n(61).f=T.f=J,n(60).f=Y,n(77).f=Q,o&&!n(58)&&a(F,"propertyIsEnumerable",Y,!0),p.f=function(e){return z(d(e))}),s(s.G+s.W+s.F*!H,{Symbol:P});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Z.length>ee;)d(Z[ee++]);for(var te=x(d.store),ne=0;te.length>ne;)g(te[ne++]);s(s.S+s.F*!H,"Symbol",{for:function(e){return i(N,e+="")?N[e]:N[e]=P(e)},keyFor:function(e){if(!K(e))throw TypeError(e+" is not a symbol!");for(var t in N)if(N[t]===e)return t},useSetter:function(){W=!0},useSimple:function(){W=!1}}),s(s.S+s.F*!H,"Object",{create:function(e,t){return void 0===t?k(e):$(k(e),t)},defineProperty:G,defineProperties:$,getOwnPropertyDescriptor:X,getOwnPropertyNames:J,getOwnPropertySymbols:Q}),R&&s(s.S+s.F*(!H||c(function(){var e=P();return"[null]"!=j([e])||"{}"!=j({a:e})||"{}"!=j(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(_(t)||void 0!==e)&&!K(e))return m(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,j.apply(R,r)}}),P.prototype[L]||n(28)(P.prototype,L,P.prototype.valueOf),h(P,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(e,t,n){e.exports=!n(12)&&!n(3)(function(){return 7!=Object.defineProperty(n(105)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(5),i=n(9).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){t.f=n(6)},function(e,t,n){var r=n(27),i=n(22),o=n(108)(!1),s=n(75)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var r=n(22),i=n(17),o=n(45);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=i(u.length),l=o(s,c);if(e&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(13),i=n(19),o=n(37);e.exports=n(12)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,u=0;a>u;)r.f(e,n=s[u++],t[n]);return e}},function(e,t,n){var r=n(9).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(22),i=n(61).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(32),i=n(6)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";var r=n(37),i=n(77),o=n(60),s=n(20),a=n(44),u=Object.assign;e.exports=!u||n(3)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r})?function(e,t){for(var n=s(e),u=arguments.length,c=1,l=i.f,h=o.f;u>c;)for(var f,d=a(arguments[c++]),p=l?r(d).concat(l(d)):r(d),g=p.length,v=0;g>v;)h.call(d,f=p[v++])&&(n[f]=d[f]);return n}:u},function(e,t,n){var r=n(5),i=n(19),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(36)(Function.call,n(62).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(9).parseInt,i=n(63).trim,o=n(80),s=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(s.test(n)?16:10))}:r},function(e,t,n){var r=n(9).parseFloat,i=n(63).trim;e.exports=1/r(n(80)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(32);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){"use strict";var r=n(38),i=n(31);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){var r=n(5),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var r=n(38),i=n(31);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),u=r(n),c=a.length;return u<0||u>=c?e?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):o:e?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},function(e,t,n){n(65)("match",1,function(e,t,n){return[function(n){"use strict";var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(65)("replace",2,function(e,t,n){return[function(r,i){"use strict";var o=e(this),s=null==r?void 0:r[t];return void 0!==s?s.call(r,o,i):n.call(String(o),r,i)},n]})},function(e,t,n){n(65)("search",1,function(e,t,n){return[function(n){"use strict";var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(65)("split",2,function(e,t,r){"use strict";var i=n(86),o=r,s=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var a=void 0===/()??/.exec("")[1];r=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return o.call(n,e,t);var r,u,c,l,h,f=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,g=void 0===t?4294967295:t>>>0,v=new RegExp(e.source,d+"g");for(a||(r=new RegExp("^"+v.source+"$(?!\\s)",d));(u=v.exec(n))&&!((c=u.index+u[0].length)>p&&(f.push(n.slice(p,u.index)),!a&&u.length>1&&u[0].replace(r,function(){for(h=1;h<arguments.length-2;h++)void 0===arguments[h]&&(u[h]=void 0)}),u.length>1&&u.index<n.length&&s.apply(f,u.slice(1)),l=u[0].length,p=c,f.length>=g));)v.lastIndex===u.index&&v.lastIndex++;return p===n.length?!l&&v.test("")||f.push(""):f.push(n.slice(p)),f.length>g?f.slice(0,g):f}}else"0".split(void 0,0).length&&(r=function(e,t){return void 0===e&&0===t?[]:o.call(this,e,t)});return[function(n,i){var o=e(this),s=null==n?void 0:n[t];return void 0!==s?s.call(n,o,i):r.call(String(o),n,i)},r]})},function(e,t,n){var r=n(19);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(48),i=n(6)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(13),i=n(42);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(112),i=n(6)("iterator"),o=n(48);e.exports=n(8).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(6)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},function(e,t,n){var r=n(57),i=n(20),o=n(44),s=n(17);e.exports=function(e,t,n,a,u){r(t);var c=i(e),l=o(c),h=s(c.length),f=u?h-1:0,d=u?-1:1;if(n<2)for(;;){if(f in l){a=l[f],f+=d;break}if(f+=d,u?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;u?f>=0:h>f;f+=d)f in l&&(a=t(a,l[f],f,c));return a}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(12)&&"g"!=/./g.flags&&n(13).f(RegExp.prototype,"flags",{configurable:!0,get:n(90)})},function(e,t,n){for(var r=n(89),i=n(37),o=n(14),s=n(9),a=n(28),u=n(48),c=n(6),l=c("iterator"),h=c("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),g=0;g<p.length;g++){var v,m=p[g],y=d[m],_=s[m],b=_&&_.prototype;if(b&&(b[l]||a(b,l,f),b[h]||a(b,h,m),u[m]=f,y))for(v in r)b[v]||o(b,v,r[v],!0)}},function(e,t,n){"use strict";var r=n(13).f,i=n(46),o=n(91),s=n(36),a=n(92),u=n(93),c=n(84),l=n(132),h=n(88),f=n(12),d=n(30).fastKey,p=n(50),g=f?"_s":"size",v=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var l=e(function(e,r){a(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[g]=0,null!=r&&u(r,n,e[c],e)});return o(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var n=p(this,t),r=v(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[g]--}return!!r},forEach:function(e){p(this,t);for(var n,r=s(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(p(this,t),e)}}),f&&r(l.prototype,"size",{get:function(){return p(this,t)[g]}}),l},def:function(e,t,n){var r,i,o=v(e,t);return o?o.v=n:(e._l=o={i:i=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[g]++,"F"!==i&&(e._i[i]=o)),e},getEntry:v,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=p(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ALL=0]="ALL",e[e.MANAGE_USERS=1]="MANAGE_USERS",e[e.MANAGE_SERVER_FOLLOW=2]="MANAGE_SERVER_FOLLOW",e[e.MANAGE_SERVER_REDUNDANCY=3]="MANAGE_SERVER_REDUNDANCY",e[e.MANAGE_VIDEO_ABUSES=4]="MANAGE_VIDEO_ABUSES",e[e.MANAGE_JOBS=5]="MANAGE_JOBS",e[e.MANAGE_CONFIGURATION=6]="MANAGE_CONFIGURATION",e[e.MANAGE_ACCOUNTS_BLOCKLIST=7]="MANAGE_ACCOUNTS_BLOCKLIST",e[e.MANAGE_SERVERS_BLOCKLIST=8]="MANAGE_SERVERS_BLOCKLIST",e[e.MANAGE_VIDEO_BLACKLIST=9]="MANAGE_VIDEO_BLACKLIST",e[e.REMOVE_ANY_VIDEO=10]="REMOVE_ANY_VIDEO",e[e.REMOVE_ANY_VIDEO_CHANNEL=11]="REMOVE_ANY_VIDEO_CHANNEL",e[e.REMOVE_ANY_VIDEO_COMMENT=12]="REMOVE_ANY_VIDEO_COMMENT",e[e.UPDATE_ANY_VIDEO=13]="UPDATE_ANY_VIDEO",e[e.SEE_ALL_VIDEOS=14]="SEE_ALL_VIDEOS",e[e.CHANGE_VIDEO_OWNERSHIP=15]="CHANGE_VIDEO_OWNERSHIP"}(t.UserRight||(t.UserRight={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LOCALE_FILES=["player","server"],t.I18N_LOCALES={"en-US":"English","fr-FR":"Fran\xe7ais","eu-ES":"Euskara","ca-ES":"Catal\xe0","cs-CZ":"\u010ce\u0161tina",eo:"Esperanto","de-DE":"Deutsch","es-ES":"Espa\xf1ol",oc:"Occitan","zh-Hant-TW":"\u7e41\u9ad4\u4e2d\u6587\uff08\u53f0\u7063\uff09","pt-BR":"Portugu\xeas (Brasil)","sv-SE":"svenska","zh-Hans-CN":"\u7b80\u4f53\u4e2d\u6587\uff08\u4e2d\u56fd\uff09"};var r={en:"en-US",fr:"fr-FR",eu:"eu-ES",ca:"ca-ES",cs:"cs-CZ",de:"de-DE",es:"es-ES",pt:"pt-BR",sv:"sv-SE"};t.POSSIBLE_LOCALES=Object.keys(t.I18N_LOCALES).concat(Object.keys(r)),t.getDefaultLocale=function(){return"en-US"},t.isDefaultLocale=function(e){return o(e)===o("en-US")},t.peertubeTranslate=function(e,t){return t&&t[e]?t[e]:e};var i=t.POSSIBLE_LOCALES.map(function(e){return"/"+e});function o(e){return e&&r[e]?r[e]:e}t.is18nPath=function(e){return-1!==i.indexOf(e)},t.is18nLocale=function(e){return-1!==t.POSSIBLE_LOCALES.indexOf(e)},t.getCompleteLocale=o,t.getShortLocale=function(e){return-1===e.indexOf("-")?e:e.split("-")[0]},t.buildFileLocale=function(e){return o(e).replace(/-/g,"_")}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(318),a=n(24),u=n(39),c=a.videojsUntyped.getComponent("Button"),l=a.videojsUntyped.getComponent("Menu"),h=a.videojsUntyped.getComponent("Component"),f=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.playerComponent=t,r.dialog=r.playerComponent.addChild("settingsDialog"),r.dialogEl=r.dialog.el_,r.menu=null,r.panel=r.dialog.addChild("settingsPanel"),r.panelChild=r.panel.addChild("settingsPanelChild"),r.addClass("vjs-settings"),r.el_.setAttribute("aria-label","Settings Button"),r.addSettingsItemHandler=r.onAddSettingsItem.bind(r),r.disposeSettingsItemHandler=r.onDisposeSettingsItem.bind(r),r.playerClickHandler=r.onPlayerClick.bind(r),r.userInactiveHandler=r.onUserInactive.bind(r),r.buildMenu(),r.bindEvents(),r.player().one("play",function(){return r.hideDialog()}),r}return i(t,e),t.prototype.onPlayerClick=function(e){var t=e.target;t.classList.contains("vjs-settings")||t.parentElement.classList.contains("vjs-settings")||this.dialog.hasClass("vjs-hidden")||this.hideDialog()},t.prototype.onDisposeSettingsItem=function(e,t){if(void 0===t){for(var n=this.menu.children();n.length>0;)n[0].dispose(),this.menu.removeChild(n[0]);this.addClass("vjs-hidden")}else{var r=this.menu.getChild(t);r&&(r.dispose(),this.menu.removeChild(r))}this.hideDialog(),0===this.options_.entries.length&&this.addClass("vjs-hidden")},t.prototype.onAddSettingsItem=function(e,t){this.addMenuItem(t[0],t[1]),this.removeClass("vjs-hidden")},t.prototype.onUserInactive=function(){this.dialog.hasClass("vjs-hidden")||this.hideDialog()},t.prototype.bindEvents=function(){this.playerComponent.on("click",this.playerClickHandler),this.playerComponent.on("addsettingsitem",this.addSettingsItemHandler),this.playerComponent.on("disposesettingsitem",this.disposeSettingsItemHandler),this.playerComponent.on("userinactive",this.userInactiveHandler)},t.prototype.buildCSSClass=function(){return"vjs-icon-settings "+e.prototype.buildCSSClass.call(this)},t.prototype.handleClick=function(){this.dialog.hasClass("vjs-hidden")?this.showDialog():this.hideDialog()},t.prototype.showDialog=function(){this.menu.el_.style.opacity="1",this.dialog.show(),this.setDialogSize(this.getComponentSize(this.menu))},t.prototype.hideDialog=function(){this.dialog.hide(),this.setDialogSize(this.getComponentSize(this.menu)),this.menu.el_.style.opacity="1",this.resetChildren()},t.prototype.getComponentSize=function(e){var t=null,n=null;return e instanceof h?(n=e.el_.offsetHeight,e.width=t=e.el_.offsetWidth,e.height=n):(t=e.offsetWidth,n=e.offsetHeight),[t,n]},t.prototype.setDialogSize=function(e){var t=e[0],n=e[1];if("number"==typeof n){var r=this.playerComponent.el_.offsetHeight-this.options_.setup.maxHeightOffset;n>r?(t+=17,this.panel.el_.style.maxHeight=(n=r)+"px"):""!==this.panel.el_.style.maxHeight&&(this.panel.el_.style.maxHeight=""),this.dialogEl.style.width=t+"px",this.dialogEl.style.height=n+"px"}},t.prototype.buildMenu=function(){this.menu=new l(this.player()),this.menu.addClass("vjs-main-menu");var e=this.options_.entries;if(0===e.length)return this.addClass("vjs-hidden"),void this.panelChild.addChild(this.menu);for(var t=0,n=e;t<n.length;t++)this.addMenuItem(n[t],this.options_);this.panelChild.addChild(this.menu)},t.prototype.addMenuItem=function(e,t){t.name=u.toTitleCase(e);var n=new s.SettingsMenuItem(this.player(),t,e,this);this.menu.addChild(n),n.on("click",o.bind(this,this.hideChildren)),n.on("click",function(){a.videojsUntyped.dom.hasClass(this.el_,"open")?a.videojsUntyped.dom.removeClass(this.el_,"open"):a.videojsUntyped.dom.addClass(this.el_,"open")})},t.prototype.resetChildren=function(){for(var e=0,t=this.menu.children();e<t.length;e++)t[e].reset()},t.prototype.hideChildren=function(){for(var e=0,t=this.menu.children();e<t.length;e++)t[e].hideSubMenu()},t}(c);t.SettingsButton=f;var d=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-settings-panel",innerHTML:"",tabIndex:-1})},t}(h);t.SettingsPanel=d;var p=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-settings-panel-child",innerHTML:"",tabIndex:-1})},t}(h);t.SettingsPanelChild=p;var g=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hide(),r}return i(t,e),t.prototype.createEl=function(){var t=this.id_;return e.prototype.createEl.call(this,"div",{className:"vjs-settings-dialog vjs-modal-overlay",innerHTML:"",tabIndex:-1},{role:"dialog","aria-labelledby":"TTsettingsDialogLabel-"+t,"aria-describedby":"TTsettingsDialogDescription-"+t})},t}(h);t.SettingsDialog=g,f.prototype.controlText_="Settings",h.registerComponent("SettingsButton",f),h.registerComponent("SettingsDialog",g),h.registerComponent("SettingsPanel",d),h.registerComponent("SettingsPanelChild",p)},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e,n){var r=[];e.on("data",function(e){r.push(e)}),e.once("end",function(){n&&n(null,t.concat(r)),n=null}),e.once("error",function(e){n&&n(e),n=null})}}).call(this,n(1).Buffer)},function(e,t,n){(function(t){var r=n(7),i=n(11).Transform,o=n(332);function s(e,t){if(!(this instanceof s))return new s(e,t);i.call(this),t||(t={}),"object"==typeof e&&(e=(t=e).size),this.size=e||512,this._zeroPadding=!t.nopad&&o(t.zeroPadding,!0),this._buffered=[],this._bufferedBytes=0}e.exports=s,r(s,i),s.prototype._transform=function(e,n,r){for(this._bufferedBytes+=e.length,this._buffered.push(e);this._bufferedBytes>=this.size;){var i=t.concat(this._buffered);this._bufferedBytes-=this.size,this.push(i.slice(0,this.size)),this._buffered=[i.slice(this.size,i.length)]}r()},s.prototype._flush=function(){if(this._bufferedBytes&&this._zeroPadding){var e=new t(this.size-this._bufferedBytes);e.fill(0),this._buffered.push(e),this.push(t.concat(this._buffered)),this._buffered=null}else this._bufferedBytes&&(this.push(t.concat(this._buffered)),this._buffered=null);this.push(null)}}).call(this,n(1).Buffer)},function(e,t,n){"use strict";(function(t,r){var i=n(67);e.exports=_;var o,s=n(139);_.ReadableState=y,n(18);var a=function(e,t){return e.listeners(t).length},u=n(143),c=n(25).Buffer,l=t.Uint8Array||function(){},h=n(52);h.inherits=n(7);var f=n(327),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,g=n(328),v=n(144);h.inherits(_,u);var m=["error","close","destroy","pause","resume"];function y(e,t){var r=t instanceof(o=o||n(40));this.objectMode=!!(e=e||{}).objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(146).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function _(e){if(o=o||n(40),!(this instanceof _))return new _(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function b(e,t,n,r,i){var o,s=e._readableState;return null===t?(s.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,T(e)}}(e,s)):(i||(o=function(e,t){var n,r;return c.isBuffer(r=t)||r instanceof l||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),r?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?w(e,s,t,!1):C(e,s)):w(e,s,t,!1))):r||(s.reading=!1)),function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function w(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&T(e)),C(e,t)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=v.destroy,_.prototype._undestroy=v.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),b(this,e,t,!1,n)},_.prototype.unshift=function(e){return b(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return p||(p=n(146).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var E=8388608;function k(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=E?e=E:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(S,e):S(e))}function S(e){d("emit readable"),e.emit("readable"),O(e)}function C(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(x,e,t))}function x(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function A(e){d("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(d("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function P(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;for(e-=i.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(i+=s===o.length?o:o.slice(0,e),0==(e-=s)){s===o.length?(++r,t.head=n.next?n.next:t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=c.allocUnsafe(e),r=t.head,i=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,s),0==(e-=s)){s===o.length?(++i,t.head=r.next?r.next:t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}(e,t),r}(e,t.buffer,t.decoder),n);var n}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(j,t,e))}function j(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function M(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):T(this),null;if(0===(e=k(e,t))&&t.ended)return 0===t.length&&R(this),null;var r,i=t.needReadable;return d("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",i=!0),t.ended||t.reading?d("reading or ended",i=!1):i&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=k(n,t))),null===(r=e>0?P(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&R(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,d("pipe count=%d opts=%j",o.pipesCount,t);var u=t&&!1===t.end||e===r.stdout||e===r.stderr?y:c;function c(){d("onend"),e.end()}o.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",function t(r,i){d("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,d("cleanup"),e.removeListener("close",v),e.removeListener("finish",m),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",t),n.removeListener("end",c),n.removeListener("end",y),n.removeListener("data",p),h=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||l())});var l=function(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,O(e))}}(n);e.on("drain",l);var h=!1,f=!1;function p(t){d("ondata"),f=!1,!1!==e.write(t)||f||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==M(o.pipes,e))&&!h&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,f=!0),n.pause())}function g(t){d("onerror",t),y(),e.removeListener("error",g),0===a(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",m),y()}function m(){d("onfinish"),e.removeListener("close",v),y()}function y(){d("unpipe"),n.unpipe(e)}return n.on("data",p),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener("error",n);e._events&&e._events.error?s(e._events.error)?e._events.error.unshift(n):e._events.error=[n,e._events.error]:e.on("error",n)}(e,0,g),e.once("close",v),e.once("finish",m),e.emit("pipe",n),o.flowing||(d("pipe resume"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var s=M(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},_.prototype.addListener=_.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&T(this):i.nextTick(A,this))}return n},_.prototype.resume=function(){var e=this._readableState;return e.flowing||(d("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(I,e,t))}(this,e)),this},_.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",function(){if(d("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){d("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=P}).call(this,n(10),n(4))},function(e,t,n){e.exports=n(18).EventEmitter},function(e,t,n){"use strict";var r=n(67);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";(function(t,r){var i=n(67);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(void 0),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var s,a=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?setImmediate:i.nextTick;m.WritableState=v;var u=n(52);u.inherits=n(7);var c,l={deprecate:n(330)},h=n(143),f=n(25).Buffer,d=r.Uint8Array||function(){},p=n(144);function g(){}function v(e,t){s=s||n(40);var r=t instanceof s;this.objectMode=!!(e=e||{}).objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var u=e.highWaterMark,c=e.writableHighWaterMark;this.highWaterMark=u||0===u?u:r&&(c||0===c)?c:this.objectMode?16:16384,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===e.decodeStrings),this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(k,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(o(r),e._writableState.errorEmitted=!0,e.emit("error",r),k(e,t))}(e,n,r,t,o);else{var s=w(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||b(e,n),r?a(_,e,n,s,o):_(e,n,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function m(e){if(s=s||n(40),!(c.call(m,this)||this instanceof s))return new m(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function y(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function _(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),k(e,t)}function b(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=new Array(t.bufferedRequestCount),i=t.corkedRequestsFree;i.entry=n;for(var s=0,a=!0;n;)r[s]=n,n.isBuf||(a=!1),n=n.next,s+=1;r.allBuffers=a,y(e,t,!0,t.length,r,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var u=n.chunk;if(y(e,t,!1,t.objectMode?1:u.length,u,n.encoding,n.callback),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),k(e,t)})}function k(e,t){var n=w(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,i.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(m,h),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===m&&e&&e._writableState instanceof v}})):c=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,n){var r,o=this._writableState,s=!1,a=!o.objectMode&&(f.isBuffer(r=e)||r instanceof d);return a&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(n=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=g),o.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),i.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var o=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),i.nextTick(r,s),o=!1),o}(this,o,e,n))&&(o.pendingcb++,s=function(e,t,n,r,i,o){if(!n){var s=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,n)),t}(t,r,i);r!==s&&(n=!0,i="buffer",r=s)}var a=t.objectMode?1:r.length;t.length+=a;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,r,i,o);return u}(this,o,a,e,t,n)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,k(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=p.destroy,m.prototype._undestroy=p.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(4),n(10))},function(e,t,n){"use strict";var r=n(25).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=o;var r=n(40),i=n(52);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush(function(t,n){a(e,t,n)}):a(this,null,null)}function a(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(7),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},function(e,t,n){e.exports=o;var r=n(7),i=n(11);function o(e,t){var n=this;if(!(n instanceof o))return new o(e,t);i.Readable.call(n,t),n.destroyed=!1,n._drained=!1,n._forwarding=!1,n._current=null,n._toStreams2=t&&t.objectMode?s:a,"function"==typeof e?n._queue=e:(n._queue=e.map(n._toStreams2),n._queue.forEach(function(e){"function"!=typeof e&&n._attachErrorListener(e)})),n._next()}function s(e){return u(e,{objectMode:!0,highWaterMark:16})}function a(e){return u(e)}function u(e,t){if(!e||"function"==typeof e||e._readableState)return e;var n=new i.Readable(t).wrap(e);return e.destroy&&(n.destroy=e.destroy.bind(e)),n}r(o,i.Readable),o.obj=function(e){return new o(e,{objectMode:!0,highWaterMark:16})},o.prototype._read=function(){this._drained=!0,this._forward()},o.prototype._forward=function(){if(!this._forwarding&&this._drained&&this._current){var e;for(this._forwarding=!0;null!==(e=this._current.read());)this._drained=this.push(e);this._forwarding=!1}},o.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._current&&this._current.destroy&&this._current.destroy(),"function"!=typeof this._queue&&this._queue.forEach(function(e){e.destroy&&e.destroy()}),e&&this.emit("error",e),this.emit("close"))},o.prototype._next=function(){var e=this;if(e._current=null,"function"==typeof e._queue)e._queue(function(t,n){if(t)return e.destroy(t);n=e._toStreams2(n),e._attachErrorListener(n),e._gotNextStream(n)});else{var t=e._queue.shift();"function"==typeof t&&(t=e._toStreams2(t()),e._attachErrorListener(t)),e._gotNextStream(t)}},o.prototype._gotNextStream=function(e){var t=this;if(!e)return t.push(null),void t.destroy();function n(){t._forward()}function r(){e._readableState.ended||t.destroy()}t._current=e,t._forward(),e.on("readable",n),e.once("end",function i(){t._current=null,e.removeListener("readable",n),e.removeListener("end",i),e.removeListener("close",r),t._next()}),e.once("close",r)},o.prototype._attachErrorListener=function(e){var t=this;e&&e.once("error",function n(r){e.removeListener("error",n),t.destroy(r)})}},function(e,t,n){(function(t,r){const i=n(66),o=n(347),s=n(68),a=n(95),u=n(357),c=n(33),l=n(54),h=n(71);function f(e){if("string"==typeof e&&/^(stream-)?magnet:/.test(e))return u(e);if("string"==typeof e&&(/^[a-f0-9]{40}$/i.test(e)||/^[a-z2-7]{32}$/i.test(e)))return u(`magnet:?xt=urn:btih:${e}`);if(t.isBuffer(e)&&20===e.length)return u(`magnet:?xt=urn:btih:${e.toString("hex")}`);if(t.isBuffer(e))return function(e){t.isBuffer(e)&&(e=i.decode(e)),p(e.info,"info"),p(e.info["name.utf-8"]||e.info.name,"info.name"),p(e.info["piece length"],"info['piece length']"),p(e.info.pieces,"info.pieces"),e.info.files?e.info.files.forEach(e=>{p("number"==typeof e.length,"info.files[0].length"),p(e["path.utf-8"]||e.path,"info.files[0].path")}):p("number"==typeof e.info.length,"info.length");const n={info:e.info,infoBuffer:i.encode(e.info),name:(e.info["name.utf-8"]||e.info.name).toString(),announce:[]};n.infoHash=l.sync(n.infoBuffer),n.infoHashBuffer=t.from(n.infoHash,"hex"),void 0!==e.info.private&&(n.private=!!e.info.private),e["creation date"]&&(n.created=new Date(1e3*e["creation date"])),e["created by"]&&(n.createdBy=e["created by"].toString()),t.isBuffer(e.comment)&&(n.comment=e.comment.toString()),Array.isArray(e["announce-list"])&&e["announce-list"].length>0?e["announce-list"].forEach(e=>{e.forEach(e=>{n.announce.push(e.toString())})}):e.announce&&n.announce.push(e.announce.toString()),t.isBuffer(e["url-list"])&&(e["url-list"]=e["url-list"].length>0?[e["url-list"]]:[]),n.urlList=(e["url-list"]||[]).map(e=>e.toString()),h(n.announce),h(n.urlList);const r=e.info.files||[e.info];n.files=r.map((e,t)=>{const i=[].concat(n.name,e["path.utf-8"]||e.path||[]).map(e=>e.toString());return{path:c.join.apply(null,[c.sep].concat(i)).slice(1),name:i[i.length-1],length:e.length,offset:r.slice(0,t).reduce(d,0)}}),n.length=r.reduce(d,0);const o=n.files[n.files.length-1];return n.pieceLength=e.info["piece length"],n.lastPieceLength=(o.offset+o.length)%n.pieceLength||n.pieceLength,n.pieces=function(e){const t=[];for(let n=0;n<e.length;n+=20)t.push(e.slice(n,n+20).toString("hex"));return t}(e.info.pieces),n}(e);if(e&&e.infoHash)return e.infoHash=e.infoHash.toLowerCase(),e.announce||(e.announce=[]),"string"==typeof e.announce&&(e.announce=[e.announce]),e.urlList||(e.urlList=[]),e;throw new Error("Invalid torrent identifier")}function d(e,t){return e+t.length}function p(e,t){if(!e)throw new Error(`Torrent is missing required field: ${t}`)}e.exports=f,e.exports.remote=function(e,t){let n;if("function"!=typeof t)throw new Error("second argument must be a Function");try{n=f(e)}catch(e){}function i(e){try{n=f(e)}catch(e){return t(e)}n&&n.infoHash?t(null,n):t(new Error("Invalid torrent identifier"))}n&&n.infoHash?r.nextTick(()=>{t(null,n)}):"undefined"!=typeof Blob&&e instanceof Blob?o(e,(e,n)=>{if(e)return t(new Error(`Error converting Blob: ${e.message}`));i(n)}):"function"==typeof a&&/^https?:/.test(e)?a.concat({url:e,timeout:3e4,headers:{"user-agent":"WebTorrent (https://webtorrent.io)"}},(e,n,r)=>{if(e)return t(new Error(`Error downloading torrent: ${e.message}`));i(r)}):"function"==typeof s.readFile&&"string"==typeof e?s.readFile(e,(e,n)=>{if(e)return t(new Error("Invalid torrent identifier"));i(n)}):r.nextTick(()=>{t(new Error("Invalid torrent identifier"))})},e.exports.toMagnetURI=u.encode,e.exports.toTorrentFile=function(e){const n={info:e.info};return n["announce-list"]=(e.announce||[]).map(e=>(n.announce||(n.announce=e),[e=t.from(e,"utf8")])),n["url-list"]=e.urlList||[],void 0!==e.private&&(n.private=Number(e.private)),e.created&&(n["creation date"]=e.created.getTime()/1e3|0),e.createdBy&&(n["created by"]=e.createdBy),e.comment&&(n.comment=e.comment),i.encode(n)},t.alloc(0)}).call(this,n(1).Buffer,n(4))},function(e,t,n){(function(e){var r=n(348),i=n(152),o=n(69),s=n(349),a=n(70),u=t;u.request=function(t,n){t="string"==typeof t?a.parse(t):o(t);var i=-1===e.location.protocol.search(/^https?:$/)?"http:":"",s=t.protocol||i,u=t.hostname||t.host,c=t.port,l=t.path||"/";u&&-1!==u.indexOf(":")&&(u="["+u+"]"),t.url=(u?s+"//"+u:"")+(c?":"+c:"")+l,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var h=new r(t);return n&&h.on("response",n),h},u.get=function(e,t){var n=u.request(e,t);return n.end(),n},u.ClientRequest=r,u.IncomingMessage=i.IncomingMessage,u.Agent=function(){},u.Agent.defaultMaxSockets=4,u.globalAgent=new u.Agent,u.STATUS_CODES=s,u.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,n(10))},function(e,t,n){(function(e){t.fetch=a(e.fetch)&&a(e.ReadableStream),t.writableStream=a(e.WritableStream),t.abortController=a(e.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(e){}var n;function r(){if(void 0!==n)return n;if(e.XMLHttpRequest){n=new e.XMLHttpRequest;try{n.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){n=null}}else n=null;return n}function i(e){var t=r();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var o=void 0!==e.ArrayBuffer,s=o&&a(e.ArrayBuffer.prototype.slice);function a(e){return"function"==typeof e}t.arraybuffer=t.fetch||o&&i("arraybuffer"),t.msstream=!t.fetch&&s&&i("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&o&&i("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!r()&&a(r().overrideMimeType),t.vbArray=a(e.VBArray),n=null}).call(this,n(10))},function(e,t,n){(function(e,r,i){var o=n(151),s=n(7),a=n(11),u=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},c=t.IncomingMessage=function(t,n,s,u){var c=this;if(a.Readable.call(c),c._mode=s,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",function(){e.nextTick(function(){c.emit("close")})}),"fetch"===s){if(c._fetchResponse=n,c.url=n.url,c.statusCode=n.status,c.statusMessage=n.statusText,n.headers.forEach(function(e,t){c.headers[t.toLowerCase()]=e,c.rawHeaders.push(t,e)}),o.writableStream){var l=new WritableStream({write:function(e){return new Promise(function(t,n){c._destroyed?n():c.push(new r(e))?t():c._resumeFetch=t})},close:function(){i.clearTimeout(u),c._destroyed||c.push(null)},abort:function(e){c._destroyed||c.emit("error",e)}});try{return void n.body.pipeTo(l).catch(function(e){i.clearTimeout(u),c._destroyed||c.emit("error",e)})}catch(e){}}var h=n.body.getReader();!function e(){h.read().then(function(t){if(!c._destroyed){if(t.done)return i.clearTimeout(u),void c.push(null);c.push(new r(t.value)),e()}}).catch(function(e){i.clearTimeout(u),c._destroyed||c.emit("error",e)})}()}else if(c._xhr=t,c._pos=0,c.url=t.responseURL,c.statusCode=t.status,c.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===c.headers[n]&&(c.headers[n]=[]),c.headers[n].push(t[2])):void 0!==c.headers[n]?c.headers[n]+=", "+t[2]:c.headers[n]=t[2],c.rawHeaders.push(t[1],t[2])}}),c._charset="x-user-defined",!o.overrideMimeType){var f=c.rawHeaders["mime-type"];if(f){var d=f.match(/;\s*charset=([^;])(;|$)/);d&&(c._charset=d[1].toLowerCase())}c._charset||(c._charset="utf-8")}};s(c,a.Readable),c.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},c.prototype._onXHRProgress=function(){var e=this,t=e._xhr,n=null;switch(e._mode){case"text:vbarray":if(t.readyState!==u.DONE)break;try{n=new i.VBArray(t.responseBody).toArray()}catch(e){}if(null!==n){e.push(new r(n));break}case"text":try{n=t.responseText}catch(t){e._mode="text:vbarray";break}if(n.length>e._pos){var o=n.substr(e._pos);if("x-user-defined"===e._charset){for(var s=new r(o.length),a=0;a<o.length;a++)s[a]=255&o.charCodeAt(a);e.push(s)}else e.push(o,e._charset);e._pos=n.length}break;case"arraybuffer":if(t.readyState!==u.DONE||!t.response)break;n=t.response,e.push(new r(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=t.response,t.readyState!==u.LOADING||!n)break;e.push(new r(new Uint8Array(n)));break;case"ms-stream":if(n=t.response,t.readyState!==u.LOADING)break;var c=new i.MSStreamReader;c.onprogress=function(){c.result.byteLength>e._pos&&(e.push(new r(new Uint8Array(c.result.slice(e._pos)))),e._pos=c.result.byteLength)},c.onload=function(){e.push(null)},c.readAsArrayBuffer(n)}e._xhr.readyState===u.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,n(4),n(1).Buffer,n(10))},function(e,t,n){var r=n(1).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(r.isBuffer(e)){for(var t=new Uint8Array(e.length),n=e.length,i=0;i<n;i++)t[i]=e[i];return t.buffer}throw new Error("Argument must be a Buffer")}},function(e,t,n){"use strict";t.decode=t.parse=n(353),t.encode=t.stringify=n(354)},function(e,t,n){var r=n(25).Buffer,i=n(368);t.DEFAULT_ANNOUNCE_PEERS=50,t.MAX_ANNOUNCE_PEERS=82,t.binaryToHex=function(e){return"string"!=typeof e&&(e=String(e)),r.from(e,"binary").toString("hex")},t.hexToBinary=function(e){return"string"!=typeof e&&(e=String(e)),r.from(e,"hex").toString("binary")},i(t,n(369))},function(e,t,n){(function(t){var r=n(34),i=n(157),o=n(382),s=function(){},a=/^v?\.0/.test(t.version),u=function(e){return"function"==typeof e},c=function(e){e()},l=function(e,t){return e.pipe(t)};e.exports=function(){var e,t=Array.prototype.slice.call(arguments),n=u(t[t.length-1]||s)&&t.pop()||s;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var h=t.map(function(l,f){var d=f<t.length-1;return function(e,t,n,c){c=r(c);var l=!1;e.on("close",function(){l=!0}),i(e,{readable:t,writable:n},function(e){if(e)return c(e);l=!0,c()});var h=!1;return function(t){if(!l&&!h)return h=!0,function(e){return!!a&&!!o&&(e instanceof(o.ReadStream||s)||e instanceof(o.WriteStream||s))&&u(e.close)}(e)?e.close(s):function(e){return e.setHeader&&u(e.abort)}(e)?e.abort():u(e.destroy)?e.destroy():void c(t||new Error("stream was destroyed"))}}(l,d,f>0,function(t){e||(e=t),t&&h.forEach(c),d||(h.forEach(c),n(e))})});return t.reduce(l)}}).call(this,n(4))},function(e,t,n){var r=n(34),i=function(){},o=function(e,t,n){if("function"==typeof t)return o(e,null,t);t||(t={}),n=r(n||i);var s=e._writableState,a=e._readableState,u=t.readable||!1!==t.readable&&e.readable,c=t.writable||!1!==t.writable&&e.writable,l=function(){e.writable||h()},h=function(){c=!1,u||n.call(e)},f=function(){u=!1,c||n.call(e)},d=function(t){n.call(e,t?new Error("exited with error code: "+t):null)},p=function(t){n.call(e,t)},g=function(){return(!u||a&&a.ended)&&(!c||s&&s.ended)?void 0:n.call(e,new Error("premature close"))},v=function(){e.req.on("finish",h)};return function(e){return e.setHeader&&"function"==typeof e.abort}(e)?(e.on("complete",h),e.on("abort",g),e.req?v():e.on("request",v)):c&&!s&&(e.on("end",l),e.on("close",l)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(e)&&e.on("exit",d),e.on("end",f),e.on("finish",h),!1!==t.error&&e.on("error",p),e.on("close",g),function(){e.removeListener("complete",h),e.removeListener("abort",g),e.removeListener("request",v),e.req&&e.req.removeListener("finish",h),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",h),e.removeListener("exit",d),e.removeListener("end",f),e.removeListener("error",p),e.removeListener("close",g)}};e.exports=o},function(e,t,n){var r=n(159);e.exports=function e(t,n,i){if("function"==typeof n)return e(t,null,n);r(t,n,function(e,t){if(e)return i(e);var n=URL.createObjectURL(t);i(null,n)})}},function(e,t,n){var r=n(34);e.exports=function e(t,n,i){if("function"==typeof n)return e(t,null,n);i=r(i);var o=[];t.on("data",function(e){o.push(e)}).on("end",function(){var e=n?new Blob(o,{type:n}):new Blob(o);i(null,e)}).on("error",i)}},function(e,t,n){var r=n(98),i=n(156),o=n(391);function s(e,t,n){var i=this;if(!(this instanceof s))return new s(e,t,n);n=n||{},i.detailedError=null,i._elem=t,i._elemWrapper=new r(t),i._waitingFired=!1,i._trackMeta=null,i._file=e,i._tracks=null,"none"!==i._elem.preload&&i._createMuxer(),i._onError=function(e){i.detailedError=i._elemWrapper.detailedError,i.destroy()},i._onWaiting=function(){i._waitingFired=!0,i._muxer?i._tracks&&i._pump():i._createMuxer()},i._elem.autoplay&&(i._elem.preload="auto"),i._elem.addEventListener("waiting",i._onWaiting),i._elem.addEventListener("error",i._onError)}e.exports=s,s.prototype._createMuxer=function(){var e=this;e._muxer=new o(e._file),e._muxer.on("ready",function(t){e._tracks=t.map(function(t){var n=e._elemWrapper.createWriteStream(t.mime);n.on("error",function(t){e._elemWrapper.error(t)});var r={muxed:null,mediaSource:n,initFlushed:!1,onInitFlushed:null};return n.write(t.init,function(e){r.initFlushed=!0,r.onInitFlushed&&r.onInitFlushed(e)}),r}),(e._waitingFired||"auto"===e._elem.preload)&&e._pump()}),e._muxer.on("error",function(t){e._elemWrapper.error(t)})},s.prototype._pump=function(){var e=this,t=e._muxer.seek(e._elem.currentTime,!e._tracks);e._tracks.forEach(function(n,r){var o=function(){n.muxed&&(n.muxed.destroy(),n.mediaSource=e._elemWrapper.createWriteStream(n.mediaSource),n.mediaSource.on("error",function(t){e._elemWrapper.error(t)})),n.muxed=t[r],i(n.muxed,n.mediaSource)};n.initFlushed?o():n.onInitFlushed=function(t){t?e._elemWrapper.error(t):o()}})},s.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this._elem.removeEventListener("waiting",this._onWaiting),this._elem.removeEventListener("error",this._onError),this._tracks&&this._tracks.forEach(function(e){e.muxed&&e.muxed.destroy()}),this._elem.src="")}},function(e,t,n){var r=n(56),i=Math.pow(2,32);t.encodingLength=function(){return 8},t.encode=function(e,t,n){t||(t=r(8)),n||(n=0);var o=Math.floor(e/i),s=e-o*i;return t.writeUInt32BE(o,n),t.writeUInt32BE(s,n+4),t},t.decode=function(e,t){t||(t=0);var n=e.readUInt32BE(t),r=e.readUInt32BE(t+4);return n*i+r},t.encode.bytes=8,t.decode.bytes=8},function(e,t){e.exports=function(e,t){if(!(t>=e.length||t<0)){var n=e.pop();if(t<e.length){var r=e[t];return e[t]=n,r}return n}}},function(e,t,n){(function(t){const r=n(162),i=n(66),o=n(72),s=n(16)("bittorrent-protocol"),a=n(69),u=n(55),c=n(97),l=n(11),h=t.from("\x13BitTorrent protocol"),f=t.from([0,0,0,0]),d=t.from([0,0,0,1,0]),p=t.from([0,0,0,1,1]),g=t.from([0,0,0,1,2]),v=t.from([0,0,0,1,3]),m=[0,0,0,0,0,0,0,0],y=[0,0,0,3,9,0,0];class _{constructor(e,t,n,r){this.piece=e,this.offset=t,this.length=n,this.callback=r}}e.exports=class extends l.Duplex{constructor(){super(),this._debugId=u(4).toString("hex"),this._debug("new wire"),this.peerId=null,this.peerIdBuffer=null,this.type=null,this.amChoking=!0,this.amInterested=!1,this.peerChoking=!0,this.peerInterested=!1,this.peerPieces=new o(0,{grow:4e5}),this.peerExtensions={},this.requests=[],this.peerRequests=[],this.extendedMapping={},this.peerExtendedMapping={},this.extendedHandshake={},this.peerExtendedHandshake={},this._ext={},this._nextExt=1,this.uploaded=0,this.downloaded=0,this.uploadSpeed=c(),this.downloadSpeed=c(),this._keepAliveInterval=null,this._timeout=null,this._timeoutMs=0,this.destroyed=!1,this._finished=!1,this._parserSize=0,this._parser=null,this._buffer=[],this._bufferSize=0,this.on("finish",this._onFinish),this._parseHandshake()}setKeepAlive(e){this._debug("setKeepAlive %s",e),clearInterval(this._keepAliveInterval),!1!==e&&(this._keepAliveInterval=setInterval(()=>{this.keepAlive()},55e3))}setTimeout(e,t){this._debug("setTimeout ms=%d unref=%s",e,t),this._clearTimeout(),this._timeoutMs=e,this._timeoutUnref=!!t,this._updateTimeout()}destroy(){this.destroyed||(this.destroyed=!0,this._debug("destroy"),this.emit("close"),this.end())}end(...e){this._debug("end"),this._onUninterested(),this._onChoke(),super.end(...e)}use(e){const t=e.prototype.name;if(!t)throw new Error('Extension class requires a "name" property on the prototype');this._debug("use extension.name=%s",t);const n=this._nextExt,r=new e(this);function i(){}"function"!=typeof r.onHandshake&&(r.onHandshake=i),"function"!=typeof r.onExtendedHandshake&&(r.onExtendedHandshake=i),"function"!=typeof r.onMessage&&(r.onMessage=i),this.extendedMapping[n]=t,this._ext[t]=r,this[t]=r,this._nextExt+=1}keepAlive(){this._debug("keep-alive"),this._push(f)}handshake(e,n,r){let i,o;if("string"==typeof e?(e=e.toLowerCase(),i=t.from(e,"hex")):e=(i=e).toString("hex"),"string"==typeof n?o=t.from(n,"hex"):n=(o=n).toString("hex"),20!==i.length||20!==o.length)throw new Error("infoHash and peerId MUST have length 20");this._debug("handshake i=%s p=%s exts=%o",e,n,r);const s=t.from(m);s[5]|=16,r&&r.dht&&(s[7]|=1),this._push(t.concat([h,s,i,o])),this._handshakeSent=!0,this.peerExtensions.extended&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_sendExtendedHandshake(){const e=a(this.extendedHandshake);e.m={};for(const t in this.extendedMapping)e.m[this.extendedMapping[t]]=Number(t);this.extended(0,i.encode(e)),this._extendedHandshakeSent=!0}choke(){if(!this.amChoking){for(this.amChoking=!0,this._debug("choke");this.peerRequests.length;)this.peerRequests.pop();this._push(d)}}unchoke(){this.amChoking&&(this.amChoking=!1,this._debug("unchoke"),this._push(p))}interested(){this.amInterested||(this.amInterested=!0,this._debug("interested"),this._push(g))}uninterested(){this.amInterested&&(this.amInterested=!1,this._debug("uninterested"),this._push(v))}have(e){this._debug("have %d",e),this._message(4,[e],null)}bitfield(e){this._debug("bitfield"),t.isBuffer(e)||(e=e.buffer),this._message(5,[],e)}request(e,t,n,r){return r||(r=(()=>{})),this._finished?r(new Error("wire is closed")):this.peerChoking?r(new Error("peer is choking")):(this._debug("request index=%d offset=%d length=%d",e,t,n),this.requests.push(new _(e,t,n,r)),this._updateTimeout(),void this._message(6,[e,t,n],null))}piece(e,t,n){this._debug("piece index=%d offset=%d",e,t),this.uploaded+=n.length,this.uploadSpeed(n.length),this.emit("upload",n.length),this._message(7,[e,t],n)}cancel(e,t,n){this._debug("cancel index=%d offset=%d length=%d",e,t,n),this._callback(this._pull(this.requests,e,t,n),new Error("request was cancelled"),null),this._message(8,[e,t,n],null)}port(e){this._debug("port %d",e);const n=t.from(y);n.writeUInt16BE(e,5),this._push(n)}extended(e,n){if(this._debug("extended ext=%s",e),"string"==typeof e&&this.peerExtendedMapping[e]&&(e=this.peerExtendedMapping[e]),"number"!=typeof e)throw new Error(`Unrecognized extension: ${e}`);{const r=t.from([e]),o=t.isBuffer(n)?n:i.encode(n);this._message(20,[],t.concat([r,o]))}}_read(){}_message(e,n,r){const i=r?r.length:0,o=t.allocUnsafe(5+4*n.length);o.writeUInt32BE(o.length+i-4,0),o[4]=e;for(let e=0;e<n.length;e++)o.writeUInt32BE(n[e],5+4*e);this._push(o),r&&this._push(r)}_push(e){if(!this._finished)return this.push(e)}_onKeepAlive(){this._debug("got keep-alive"),this.emit("keep-alive")}_onHandshake(e,t,n){const r=e.toString("hex"),i=t.toString("hex");let o;for(o in this._debug("got handshake i=%s p=%s exts=%o",r,i,n),this.peerId=i,this.peerIdBuffer=t,this.peerExtensions=n,this.emit("handshake",r,i,n),this._ext)this._ext[o].onHandshake(r,i,n);n.extended&&this._handshakeSent&&!this._extendedHandshakeSent&&this._sendExtendedHandshake()}_onChoke(){for(this.peerChoking=!0,this._debug("got choke"),this.emit("choke");this.requests.length;)this._callback(this.requests.pop(),new Error("peer is choking"),null)}_onUnchoke(){this.peerChoking=!1,this._debug("got unchoke"),this.emit("unchoke")}_onInterested(){this.peerInterested=!0,this._debug("got interested"),this.emit("interested")}_onUninterested(){this.peerInterested=!1,this._debug("got uninterested"),this.emit("uninterested")}_onHave(e){this.peerPieces.get(e)||(this._debug("got have %d",e),this.peerPieces.set(e,!0),this.emit("have",e))}_onBitField(e){this.peerPieces=new o(e),this._debug("got bitfield"),this.emit("bitfield",this.peerPieces)}_onRequest(e,t,n){if(this.amChoking)return;this._debug("got request index=%d offset=%d length=%d",e,t,n);const r=(r,o)=>{if(i===this._pull(this.peerRequests,e,t,n))return r?this._debug("error satisfying request index=%d offset=%d length=%d (%s)",e,t,n,r.message):void this.piece(e,t,o)};var i=new _(e,t,n,r);this.peerRequests.push(i),this.emit("request",e,t,n,r)}_onPiece(e,t,n){this._debug("got piece index=%d offset=%d",e,t),this._callback(this._pull(this.requests,e,t,n.length),null,n),this.downloaded+=n.length,this.downloadSpeed(n.length),this.emit("download",n.length),this.emit("piece",e,t,n)}_onCancel(e,t,n){this._debug("got cancel index=%d offset=%d length=%d",e,t,n),this._pull(this.peerRequests,e,t,n),this.emit("cancel",e,t,n)}_onPort(e){this._debug("got port %d",e),this.emit("port",e)}_onExtended(e,t){if(0===e){let e,n;try{e=i.decode(t)}catch(e){this._debug("ignoring invalid extended handshake: %s",e.message||e)}if(!e)return;if(this.peerExtendedHandshake=e,"object"==typeof e.m)for(n in e.m)this.peerExtendedMapping[n]=Number(e.m[n].toString());for(n in this._ext)this.peerExtendedMapping[n]&&this._ext[n].onExtendedHandshake(this.peerExtendedHandshake);this._debug("got extended handshake"),this.emit("extended","handshake",this.peerExtendedHandshake)}else this.extendedMapping[e]&&this._ext[e=this.extendedMapping[e]]&&this._ext[e].onMessage(t),this._debug("got extended message ext=%s",e),this.emit("extended",e,t)}_onTimeout(){this._debug("request timed out"),this._callback(this.requests.shift(),new Error("request has timed out"),null),this.emit("timeout")}_write(e,n,r){for(this._bufferSize+=e.length,this._buffer.push(e);this._bufferSize>=this._parserSize;){const e=1===this._buffer.length?this._buffer[0]:t.concat(this._buffer);this._bufferSize-=this._parserSize,this._buffer=this._bufferSize?[e.slice(this._parserSize)]:[],this._parser(e.slice(0,this._parserSize))}r(null)}_callback(e,t,n){e&&(this._clearTimeout(),this.peerChoking||this._finished||this._updateTimeout(),e.callback(t,n))}_clearTimeout(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null)}_updateTimeout(){this._timeoutMs&&this.requests.length&&!this._timeout&&(this._timeout=setTimeout(()=>this._onTimeout(),this._timeoutMs),this._timeoutUnref&&this._timeout.unref&&this._timeout.unref())}_parse(e,t){this._parserSize=e,this._parser=t}_onMessageLength(e){const t=e.readUInt32BE(0);t>0?this._parse(t,this._onMessage):(this._onKeepAlive(),this._parse(4,this._onMessageLength))}_onMessage(e){switch(this._parse(4,this._onMessageLength),e[0]){case 0:return this._onChoke();case 1:return this._onUnchoke();case 2:return this._onInterested();case 3:return this._onUninterested();case 4:return this._onHave(e.readUInt32BE(1));case 5:return this._onBitField(e.slice(1));case 6:return this._onRequest(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 7:return this._onPiece(e.readUInt32BE(1),e.readUInt32BE(5),e.slice(9));case 8:return this._onCancel(e.readUInt32BE(1),e.readUInt32BE(5),e.readUInt32BE(9));case 9:return this._onPort(e.readUInt16BE(1));case 20:return this._onExtended(e.readUInt8(1),e.slice(2));default:return this._debug("got unknown message"),this.emit("unknownmessage",e)}}_parseHandshake(){this._parse(1,e=>{const t=e.readUInt8(0);this._parse(t+48,e=>{const n=e.slice(0,t);if("BitTorrent protocol"!==n.toString())return this._debug("Error: wire not speaking BitTorrent protocol (%s)",n.toString()),void this.end();e=e.slice(t),this._onHandshake(e.slice(8,28),e.slice(28,48),{dht:!!(1&e[7]),extended:!!(16&e[5])}),this._parse(4,this._onMessageLength)})})}_onFinish(){for(this._finished=!0,this.push(null);this.read(););for(clearInterval(this._keepAliveInterval),this._parse(Number.MAX_VALUE,()=>{});this.peerRequests.length;)this.peerRequests.pop();for(;this.requests.length;)this._callback(this.requests.pop(),new Error("wire was closed"),null)}_debug(...e){e[0]=`[${this._debugId}] ${e[0]}`,s(...e)}_pull(e,t,n,i){for(let o=0;o<e.length;o++){const s=e[o];if(s.piece===t&&s.offset===n&&s.length===i)return r(e,o),s}return null}}}).call(this,n(1).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStoredVolume=function(){var e=i("volume");if(null!=e){var t=parseFloat(e);if(isNaN(t))return;return t}},t.getStoredWebTorrentEnabled=function(){var e=i("webtorrent_enabled");return null==e||"true"===e},t.getStoredMute=function(){var e=i("mute");if(null!=e)return"true"===e},t.getStoredTheater=function(){var e=i("theater-enabled");if(null!=e)return"true"===e},t.saveVolumeInStore=function(e){return o("volume",e.toString())},t.saveMuteInStore=function(e){return o("mute",e.toString())},t.saveTheaterInStore=function(e){return o("theater-enabled",e.toString())},t.saveAverageBandwidth=function(e){return o("average-bandwidth",e.toString())},t.getAverageBandwidthInStore=function(){var e=i("average-bandwidth");if(null!=e){var t=parseInt(e,10);if(isNaN(t))return;return t}};var r="peertube-videojs-";function i(e){try{return localStorage.getItem(r+e)}catch(e){return}}function o(e,t){try{localStorage.setItem(r+e,t)}catch(e){}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),n(416),n(166),n(169),n(187),n(193),n(195),n(197),n(210),n(229),n(252),n(260),n(285),n(288),n(290),n(293),n(295);var o=n(2),s=n(51),a=n(297),u=n(311),c=function(){function e(e){this.embed=e,this.isReady=!1,this.resolutions=null}return e.prototype.initialize=function(){this.constructChannel(),this.setupStateTracking(),this.notifyReady()},Object.defineProperty(e.prototype,"element",{get:function(){return this.embed.videoElement},enumerable:!0,configurable:!0}),e.prototype.constructChannel=function(){var e=this,t=s.build({window:window.parent,origin:"*",scope:this.embed.scope});t.bind("play",function(t,n){return e.embed.player.play()}),t.bind("pause",function(t,n){return e.embed.player.pause()}),t.bind("seek",function(t,n){return e.embed.player.currentTime(n)}),t.bind("setVolume",function(t,n){return e.embed.player.volume(n)}),t.bind("getVolume",function(t,n){return e.embed.player.volume()}),t.bind("isReady",function(t,n){return e.isReady}),t.bind("setResolution",function(t,n){return e.setResolution(n)}),t.bind("getResolutions",function(t,n){return e.resolutions}),t.bind("setPlaybackRate",function(t,n){return e.embed.player.playbackRate(n)}),t.bind("getPlaybackRate",function(t,n){return e.embed.player.playbackRate()}),t.bind("getPlaybackRates",function(t,n){return e.embed.playerOptions.playbackRates}),this.channel=t},e.prototype.setResolution=function(e){-1===e&&this.embed.player.peertube().isAutoResolutionForbidden()||(-1!==e?(this.embed.player.peertube().disableAutoResolution(),this.embed.player.peertube().updateResolution(e)):this.embed.player.peertube().enableAutoResolution())},e.prototype.notifyReady=function(){this.isReady=!0,this.channel.notify({method:"ready",params:!0})},e.prototype.setupStateTracking=function(){var e=this,t="unstarted";setInterval(function(){e.channel.notify({method:"playbackStatusUpdate",params:{position:e.element.currentTime,volume:e.element.volume,playbackState:t}})},500),this.element.addEventListener("play",function(n){t="playing",e.channel.notify({method:"playbackStatusChange",params:"playing"})}),this.element.addEventListener("pause",function(n){t="paused",e.channel.notify({method:"playbackStatusChange",params:"paused"})}),this.embed.player.peertube().on("autoResolutionUpdate",function(){return e.loadResolutions()}),this.embed.player.peertube().on("videoFileUpdate",function(){return e.loadResolutions()})},e.prototype.loadResolutions=function(){for(var e=[],t=this.embed.player.peertube().getCurrentResolutionId(),n=0,r=this.embed.player.peertube().videoFiles;n<r.length;n++){var i=r[n],o=i.resolution.label;i.fps&&i.fps>=50&&(o+=i.fps),e.push({id:i.resolution.id,label:o,src:i.magnetUri,active:i.resolution.id===t})}this.resolutions=e,this.channel.notify({method:"resolutionUpdate",params:this.resolutions})},e}();(function(){function e(e){this.videoContainerId=e,this.api=null,this.autoplay=!1,this.controls=!0,this.muted=!1,this.loop=!1,this.enableApi=!1,this.startTime=0,this.scope="peertube",this.videoElement=document.getElementById(e)}return e.main=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,new e("video-container").init()];case 1:return t.sent(),[2]}})})},e.prototype.getVideoUrl=function(e){return window.location.origin+"/api/v1/videos/"+e},e.prototype.loadVideoInfo=function(e){return fetch(this.getVideoUrl(e))},e.prototype.loadVideoCaptions=function(e){return fetch(this.getVideoUrl(e)+"/captions")},e.prototype.removeElement=function(e){e.parentElement.removeChild(e)},e.prototype.displayError=function(e){this.videoElement&&this.removeElement(this.videoElement),document.title="Sorry - "+e,document.getElementById("error-block").style.display="flex",document.getElementById("error-content").innerHTML=e},e.prototype.videoNotFound=function(){this.displayError("This video does not exist.")},e.prototype.videoFetchError=function(){this.displayError("We cannot fetch the video. Please try again later.")},e.prototype.getParamToggle=function(e,t,n){return e.has(t)?"1"===e.get(t)||"true"===e.get(t):n},e.prototype.getParamString=function(e,t,n){return e.has(t)?e.get(t):n},e.prototype.init=function(){return r(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.initCore()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.error(e),[3,3];case 3:return[2]}})})},e.prototype.initializeApi=function(){this.enableApi&&(this.api=new c(this),this.api.initialize())},e.prototype.loadParams=function(){try{var e=new URL(window.location.toString()).searchParams;this.autoplay=this.getParamToggle(e,"autoplay",this.autoplay),this.controls=this.getParamToggle(e,"controls",this.controls),this.muted=this.getParamToggle(e,"muted",this.muted),this.loop=this.getParamToggle(e,"loop",this.loop),this.enableApi=this.getParamToggle(e,"api",this.enableApi),this.scope=this.getParamString(e,"scope",this.scope);var t=e.get("start");t&&(this.startTime=t)}catch(e){console.error("Cannot get params from URL.",e)}},e.prototype.initCore=function(){return r(this,void 0,void 0,function(){var e,t,n,r,s,c,l,h,f,d,p=this;return i(this,function(i){switch(i.label){case 0:return e=window.location.pathname.split("/"),t=e[e.length-1],[4,Promise.all([u.loadLocaleInVideoJS(window.location.origin,o,navigator.language),u.getServerTranslations(window.location.origin,navigator.language),this.loadVideoInfo(t),this.loadVideoCaptions(t)])];case 1:return n=i.sent(),r=n[1],c=n[3],(s=n[2]).ok?[4,s.json()]:404===s.status?[2,this.videoNotFound()]:[2,this.videoFetchError()];case 2:return l=i.sent(),h=[],c.ok?[4,c.json()]:[3,4];case 3:f=i.sent().data,h=f.map(function(e){return{label:a.peertubeTranslate(e.language.label,r),language:e.language.id,src:window.location.origin+e.captionPath}}),i.label=4;case 4:return this.loadParams(),d=u.getVideojsOptions({autoplay:this.autoplay,controls:this.controls,muted:this.muted,loop:this.loop,startTime:this.startTime,videoCaptions:h,inactivityTimeout:1500,videoViewUrl:this.getVideoUrl(t)+"/views",playerElement:this.videoElement,videoFiles:l.files,videoDuration:l.duration,enableHotkeys:!0,peertubeLink:!0,poster:window.location.origin+l.previewPath,theaterMode:!1}),this.playerOptions=d,this.player=o(this.videoContainerId,d,function(){p.player.on("customError",function(e,t){return p.handleError(t.err)}),window.videojsPlayer=p.player,p.controls&&p.player.dock({title:l.name,description:p.player.localize("Uses P2P, others may know your IP is downloading this video.")}),u.addContextMenu(p.player,window.location.origin+l.embedPath),p.initializeApi()}),[2]}})})},e.prototype.handleError=function(e){if(-1!==e.message.indexOf("from xs param"))return this.player.dispose(),this.videoElement=null,void this.displayError("This video is not available because the remote instance is not responding.")},e})().main().catch(function(e){return console.error("Cannot init embed.",e)})},function(e,t,n){n(103),n(47),e.exports=n(8).Symbol},function(e,t,n){var r=n(9),i=n(8),o=n(58),s=n(106),a=n(13).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},function(e,t,n){var r=n(37),i=n(77),o=n(60);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var s,a=n(e),u=o.f,c=0;a.length>c;)u.call(e,s=a[c++])&&t.push(s);return t}},function(e,t,n){n(103),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(186),n(47),e.exports=n(8).Object},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(46)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(12),"Object",{defineProperty:n(13).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(12),"Object",{defineProperties:n(109)})},function(e,t,n){var r=n(22),i=n(62).f;n(23)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},function(e,t,n){var r=n(20),i=n(79);n(23)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(20),i=n(37);n(23)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){n(23)("getOwnPropertyNames",function(){return n(111).f})},function(e,t,n){var r=n(5),i=n(30).onFreeze;n(23)("freeze",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(5),i=n(30).onFreeze;n(23)("seal",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(5),i=n(30).onFreeze;n(23)("preventExtensions",function(e){return function(t){return e&&r(t)?e(i(t)):t}})},function(e,t,n){var r=n(5);n(23)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(5);n(23)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(5);n(23)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(113)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(185)})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(114).set})},function(e,t,n){n(188),n(191),n(192),e.exports=n(8).Function},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(189)})},function(e,t,n){"use strict";var r=n(57),i=n(5),o=n(190),s=[].slice,a={};e.exports=Function.bind||function(e){var t=r(this),n=s.call(arguments,1),u=function(){var r=n.concat(s.call(arguments));return this instanceof u?function(e,t,n){if(!(t in a)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";a[t]=Function("F,a","return new F("+r.join(",")+")")}return a[t](e,n)}(t,r.length,r):o(t,r,e)};return i(t.prototype)&&(u.prototype=t.prototype),u}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(13).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(12)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(5),i=n(79),o=n(6)("hasInstance"),s=Function.prototype;o in s||n(13).f(s,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){n(194),e.exports=n(8).parseInt},function(e,t,n){var r=n(0),i=n(115);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){n(196),e.exports=n(8).parseFloat},function(e,t,n){var r=n(0),i=n(116);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),e.exports=n(8).Number},function(e,t,n){"use strict";var r=n(9),i=n(27),o=n(32),s=n(81),a=n(35),u=n(3),c=n(61).f,l=n(62).f,h=n(13).f,f=n(63).trim,d=r.Number,p=d,g=d.prototype,v="Number"==o(n(46)(g)),m="trim"in String.prototype,y=function(e){var t=a(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=m?t.trim():f(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var s,u=t.slice(2),c=0,l=u.length;c<l;c++)if((s=u.charCodeAt(c))<48||s>i)return NaN;return parseInt(u,r)}}return+t};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof d&&(v?u(function(){g.valueOf.call(n)}):"Number"!=o(n))?s(new p(y(t)),n,d):y(t)};for(var _,b=n(12)?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;b.length>w;w++)i(p,_=b[w])&&!i(d,_)&&h(d,_,l(p,_));d.prototype=g,g.constructor=d,n(14)(r,"Number",d)}},function(e,t,n){"use strict";var r=n(0),i=n(38),o=n(117),s=n(118),a=1..toFixed,u=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(e,t){for(var n=-1,r=t;++n<6;)c[n]=(r+=e*c[n])%1e7,r=u(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)c[t]=u((n+=c[t])/e),n=n%e*1e7},d=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==c[e]){var n=String(c[e]);t=""===t?n:t+s.call("0",7-n.length)+n}return t},p=function(e,t,n){return 0===t?n:t%2==1?p(e,t-1,n*e):p(e*e,t/2,n)};r(r.P+r.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)(function(){a.call({})})),"Number",{toFixed:function(e){var t,n,r,a,u=o(this,l),c=i(e),g="",v="0";if(c<0||c>20)throw RangeError(l);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(g="-",u=-u),u>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(u*p(2,69,1))-69)<0?u*p(2,-t,1):u/p(2,t,1),n*=4503599627370496,(t=52-t)>0){for(h(0,n),r=c;r>=7;)h(1e7,0),r-=7;for(h(p(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),h(1,1),f(2),v=d()}else h(0,n),h(1<<-t,0),v=d()+s.call("0",c);return c>0?g+((a=v.length)<=c?"0."+s.call("0",c-a)+v:v.slice(0,a-c)+"."+v.slice(a-c)):g+v}})},function(e,t,n){"use strict";var r=n(0),i=n(3),o=n(117),s=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==s.call(1,void 0)})||!i(function(){s.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?s.call(t):s.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),i=n(9).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(119)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),i=n(119),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),i=n(116);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(0),i=n(115);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),e.exports=n(8).Math},function(e,t,n){var r=n(0),i=n(120),o=Math.sqrt,s=Math.acosh;r(r.S+r.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),i=n(82);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(0),i=n(83);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(219)})},function(e,t,n){var r=n(82),i=Math.pow,o=i(2,-52),s=i(2,-23),a=i(2,127)*(2-s),u=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),c=r(e);return i<u?c*(i/u/s+1/o-1/o)*u*s:(n=(t=(1+s/o)*i)-(t-i))>a||n!=n?c*(1/0):c*n}},function(e,t,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,s=0,a=arguments.length,u=0;s<a;)u<(n=i(arguments[s++]))?(o=o*(r=u/n)*r+1,u=n):o+=n>0?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(e,t,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(120)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(82)})},function(e,t,n){var r=n(0),i=n(83),o=Math.exp;r(r.S+r.F*n(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),i=n(83),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){n(230),n(231),n(232),n(64),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(122),n(123),n(124),n(125),e.exports=n(8).String},function(e,t,n){var r=n(0),i=n(45),o=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,s=0;r>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),i=n(22),o=n(17);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,s=[],a=0;n>a;)s.push(String(t[a++])),a<r&&s.push(String(arguments[a]));return s.join("")}})},function(e,t,n){"use strict";n(63)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var r=n(46),i=n(42),o=n(59),s={};n(28)(s,n(6)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(0),i=n(121)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(85),s="".endsWith;r(r.P+r.F*n(87)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),a=void 0===n?r:Math.min(i(n),r),u=String(e);return s?s.call(t,u,a):t.slice(a-u.length,a)===u}})},function(e,t,n){"use strict";var r=n(0),i=n(85);r(r.P+r.F*n(87)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(118)})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(85),s="".startsWith;r(r.P+r.F*n(87)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return s?s.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(15)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(15)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(15)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(15)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";n(15)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(15)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(15)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";n(15)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";n(15)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";n(15)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";n(15)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(15)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(15)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){n(253),n(254),n(255),n(257),n(258),e.exports=Date},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(20),o=n(35);r(r.P+r.F*n(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),i=n(256);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(e){return e>9?e:"0"+e};e.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+s(e.getUTCMonth()+1)+"-"+s(e.getUTCDate())+"T"+s(e.getUTCHours())+":"+s(e.getUTCMinutes())+":"+s(e.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:o},function(e,t,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(14)(r,"toString",function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"})},function(e,t,n){var r=n(6)("toPrimitive"),i=Date.prototype;r in i||n(28)(i,r,n(259))},function(e,t,n){"use strict";var r=n(19),i=n(35);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){n(64),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(280),n(282),n(283),n(284),n(89),e.exports=n(8).Array},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(78)})},function(e,t,n){"use strict";var r=n(36),i=n(0),o=n(20),s=n(126),a=n(127),u=n(17),c=n(128),l=n(129);i(i.S+i.F*!n(130)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,m=0,y=l(f);if(v&&(g=r(g,p>2?arguments[2]:void 0,2)),null==y||d==Array&&a(y))for(n=new d(t=u(f.length));t>m;m++)c(n,m,v?g(f[m],m):f[m]);else for(h=y.call(f),n=new d;!(i=h.next()).done;m++)c(n,m,v?s(h,g,[i.value,m],!0):i.value);return n.length=m,n}})},function(e,t,n){"use strict";var r=n(0),i=n(128);r(r.S+r.F*n(3)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(22),o=[].join;r(r.P+r.F*(n(44)!=Object||!n(21)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(110),o=n(32),s=n(45),a=n(17),u=[].slice;r(r.P+r.F*n(3)(function(){i&&u.call(i)}),"Array",{slice:function(e,t){var n=a(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return u.call(this,e,t);for(var i=s(e,n),c=s(t,n),l=a(c-i),h=new Array(l),f=0;f<l;f++)h[f]="String"==r?this.charAt(i+f):this[i+f];return h}})},function(e,t,n){"use strict";var r=n(0),i=n(57),o=n(20),s=n(3),a=[].sort,u=[1,2,3];r(r.P+r.F*(s(function(){u.sort(void 0)})||!s(function(){u.sort(null)})||!n(21)(a)),"Array",{sort:function(e){return void 0===e?a.call(o(this)):a.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(0),i=n(29)(0),o=n(21)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(269);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(5),i=n(78),o=n(6)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),i=n(29)(1);r(r.P+r.F*!n(21)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(29)(2);r(r.P+r.F*!n(21)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(29)(3);r(r.P+r.F*!n(21)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(29)(4);r(r.P+r.F*!n(21)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(131);r(r.P+r.F*!n(21)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(131);r(r.P+r.F*!n(21)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(108)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(s||!n(21)(o)),"Array",{indexOf:function(e){return s?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(22),o=n(38),s=n(17),a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(21)(a)),"Array",{lastIndexOf:function(e){if(u)return a.apply(this,arguments)||0;var t=i(this),n=s(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(279)}),n(49)("copyWithin")},function(e,t,n){"use strict";var r=n(20),i=n(45),o=n(17);e.exports=[].copyWithin||function(e,t){var n=r(this),s=o(n.length),a=i(e,s),u=i(t,s),c=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===c?s:i(c,s))-u,s-a),h=1;for(u<a&&a<u+l&&(h=-1,u+=l-1,a+=l-1);l-- >0;)u in n?n[a]=n[u]:delete n[a],a+=h,u+=h;return n}},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(281)}),n(49)("fill")},function(e,t,n){"use strict";var r=n(20),i=n(45),o=n(17);e.exports=function(e){for(var t=r(this),n=o(t.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:i(u,n);c>a;)t[a++]=e;return t}},function(e,t,n){"use strict";var r=n(0),i=n(29)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(49)("find")},function(e,t,n){"use strict";var r=n(0),i=n(29)(6),o="findIndex",s=!0;o in[]&&Array(1)[o](function(){s=!1}),r(r.P+r.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(49)(o)},function(e,t,n){n(88)("Array")},function(e,t,n){n(286),n(287),n(133),n(122),n(123),n(124),n(125),e.exports=n(8).RegExp},function(e,t,n){var r=n(9),i=n(81),o=n(13).f,s=n(61).f,a=n(86),u=n(90),c=r.RegExp,l=c,h=c.prototype,f=/a/g,d=/a/g,p=new c(f)!==f;if(n(12)&&(!p||n(3)(function(){return d[n(6)("match")]=!1,c(f)!=f||c(d)==d||"/a/i"!=c(f,"i")}))){c=function(e,t){var n=this instanceof c,r=a(e),o=void 0===t;return!n&&r&&e.constructor===c&&o?e:i(p?new l(r&&!o?e.source:e,t):l((r=e instanceof c)?e.source:e,r&&o?u.call(e):t),n?this:h,c)};for(var g=function(e){e in c||o(c,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},v=s(l),m=0;v.length>m;)g(v[m++]);h.constructor=c,c.prototype=h,n(14)(r,"RegExp",c)}n(88)("RegExp")},function(e,t,n){"use strict";n(133);var r=n(19),i=n(90),o=n(12),s=/./.toString,a=function(e){n(14)(RegExp.prototype,"toString",e,!0)};n(3)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?a(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=s.name&&a(function(){return s.call(this)})},function(e,t,n){n(47),n(64),n(134),n(289),e.exports=n(8).Map},function(e,t,n){"use strict";var r=n(135),i=n(50);e.exports=n(94)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){n(47),n(89),n(291),e.exports=n(8).WeakMap},function(e,t,n){"use strict";var r,i=n(29)(0),o=n(14),s=n(30),a=n(113),u=n(292),c=n(5),l=n(3),h=n(50),f=s.getWeak,d=Object.isExtensible,p=u.ufstore,g={},v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(e){if(c(e)){var t=f(e);return!0===t?p(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(h(this,"WeakMap"),e,t)}},y=e.exports=n(94)("WeakMap",v,m,u,!0,!0);l(function(){return 7!=(new y).set((Object.freeze||Object)(g),7).get(g)})&&(a((r=u.getConstructor(v,"WeakMap")).prototype,m),s.NEED=!0,i(["delete","has","get","set"],function(e){var t=y.prototype,n=t[e];o(t,e,function(t,i){if(c(t)&&!d(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)})}))},function(e,t,n){"use strict";var r=n(91),i=n(30).getWeak,o=n(19),s=n(5),a=n(92),u=n(93),c=n(29),l=n(27),h=n(50),f=c(5),d=c(6),p=0,g=function(e){return e._l||(e._l=new v)},v=function(){this.a=[]},m=function(e,t){return f(e.a,function(e){return e[0]===t})};v.prototype={get:function(e){var t=m(this,e);if(t)return t[1]},has:function(e){return!!m(this,e)},set:function(e,t){var n=m(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var c=e(function(e,r){a(e,c,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&u(r,n,e[o],e)});return r(c.prototype,{delete:function(e){if(!s(e))return!1;var n=i(e);return!0===n?g(h(this,t)).delete(e):n&&l(n,this._i)&&delete n[this._i]},has:function(e){if(!s(e))return!1;var n=i(e);return!0===n?g(h(this,t)).has(e):n&&l(n,this._i)}}),c},def:function(e,t,n){var r=i(o(t),!0);return!0===r?g(e).set(t,n):r[e._i]=n,e},ufstore:g}},function(e,t,n){n(47),n(64),n(134),n(294),e.exports=n(8).Set},function(e,t,n){"use strict";var r=n(135),i=n(50);e.exports=n(94)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";n.r(t),n.d(t,"Headers",function(){return c}),n.d(t,"Request",function(){return v}),n.d(t,"Response",function(){return y}),n.d(t,"DOMException",function(){return b}),n.d(t,"fetch",function(){return w});var r={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(r.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(e){return e&&i.indexOf(Object.prototype.toString.call(e))>-1};function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){return"string"!=typeof e&&(e=String(e)),e}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r.iterable&&(t[Symbol.iterator]=function(){return t}),t}function c(e){this.map={},e instanceof c?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:r.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r.arrayBuffer&&r.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||o(e))?this._bodyArrayBuffer=d(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,r=l(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(e,t){e=s(e),t=a(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},c.prototype.delete=function(e){delete this.map[s(e)]},c.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},c.prototype.set=function(e,t){this.map[s(e)]=a(t)},c.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},c.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},r.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var n,r,i=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),g.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function y(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},p.call(v.prototype),p.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];y.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})};var b=self.DOMException;try{new b}catch(e){(b=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),b.prototype.constructor=b}function w(e,t){return new Promise(function(n,i){var o=new v(e,t);if(o.signal&&o.signal.aborted)return i(new b("Aborted","AbortError"));var s=new XMLHttpRequest;function a(){s.abort()}s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new c,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL"),n(new y("response"in s?s.response:s.responseText,r))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.onabort=function(){i(new b("Aborted","AbortError"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&r.blob&&(s.responseType="blob"),o.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),o.signal&&(o.signal.addEventListener("abort",a),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",a)}),s.send(void 0===o._bodyInit?null:o._bodyInit)})}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=c,self.Request=v,self.Response=y)},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(298))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(299)),r(n(301)),r(n(308)),r(n(310))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(136)),r(n(300))},function(e,t,n){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0});var o,s=n(136);!function(e){e[e.ADMINISTRATOR=0]="ADMINISTRATOR",e[e.MODERATOR=1]="MODERATOR",e[e.USER=2]="USER"}(o=t.UserRole||(t.UserRole={})),t.USER_ROLE_LABELS=((r={})[o.USER]="User",r[o.MODERATOR]="Moderator",r[o.ADMINISTRATOR]="Administrator",r);var a=((i={})[o.ADMINISTRATOR]=[s.UserRight.ALL],i[o.MODERATOR]=[s.UserRight.MANAGE_VIDEO_BLACKLIST,s.UserRight.MANAGE_VIDEO_ABUSES,s.UserRight.REMOVE_ANY_VIDEO,s.UserRight.REMOVE_ANY_VIDEO_CHANNEL,s.UserRight.REMOVE_ANY_VIDEO_COMMENT,s.UserRight.UPDATE_ANY_VIDEO,s.UserRight.SEE_ALL_VIDEOS,s.UserRight.MANAGE_ACCOUNTS_BLOCKLIST,s.UserRight.MANAGE_SERVERS_BLOCKLIST],i[o.USER]=[],i);t.hasUserRight=function(e,t){var n=a[e];return-1!==n.indexOf(s.UserRight.ALL)||-1!==n.indexOf(t)}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(302)),r(n(303)),r(n(304)),r(n(305)),r(n(306)),r(n(307))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PENDING=1]="PENDING",e[e.REJECTED=2]="REJECTED",e[e.ACCEPTED=3]="ACCEPTED"}(t.VideoAbuseState||(t.VideoAbuseState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.WAITING="WAITING",e.ACCEPTED="ACCEPTED",e.REFUSED="REFUSED"}(t.VideoChangeOwnershipStatus||(t.VideoChangeOwnershipStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PUBLIC=1]="PUBLIC",e[e.UNLISTED=2]="UNLISTED",e[e.PRIVATE=3]="PRIVATE"}(t.VideoPrivacy||(t.VideoPrivacy={}))},function(e,t,n){"use strict";var r;function i(e,t,n){var i=function(e){switch(e){case r.H_240P:return 25e4;case r.H_360P:return 5e5;case r.H_480P:return 9e5;case r.H_720P:return 175e4;case r.H_1080P:default:return 33e5}}(e);return i+(1.4*i-i)/(n.MAX-n.AVERAGE)*(t-n.AVERAGE)}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.H_240P=240]="H_240P",e[e.H_360P=360]="H_360P",e[e.H_480P=480]="H_480P",e[e.H_720P=720]="H_720P",e[e.H_1080P=1080]="H_1080P"}(r=t.VideoResolution||(t.VideoResolution={})),t.getTargetBitrate=i,t.getMaxBitrate=function(e,t,n){return 2*i(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PUBLISHED=1]="PUBLISHED",e[e.TO_TRANSCODE=2]="TO_TRANSCODE",e[e.TO_IMPORT=3]="TO_IMPORT"}(t.VideoState||(t.VideoState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PENDING=1]="PENDING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILED=3]="FAILED"}(t.VideoImportState||(t.VideoImportState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(309))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.RSS="xml",e.ATOM="atom",e.JSON="json"}(t.FeedFormat||(t.FeedFormat={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(137))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(312),n(313),n(314),n(315),n(316),n(138),n(319),n(320),n(413),n(414);var r=n(24),i=n(39),o=n(137);function s(e,t,n){var r,i=a(e,n);if(!i)return Promise.resolve(void 0);r=s.cache[i]?Promise.resolve(s.cache[i]):fetch(i+"/player.json").then(function(e){return e.json()}).then(function(e){return s.cache[i]=e,e});var u=o.getCompleteLocale(n);return r.then(function(e){return t.addLanguage(o.getShortLocale(u),e)})}function a(e,t){var n=o.getCompleteLocale(t);if(o.is18nLocale(n)&&!o.isDefaultLocale(n))return e+"/client/locales/"+n}r.videojsUntyped.getComponent("PlaybackRateMenuButton").prototype.controlText_="Speed",r.videojsUntyped.getComponent("CaptionsButton").prototype.controlText_="Subtitles/CC",r.videojsUntyped.getComponent("CaptionsButton").prototype.label_=" ",t.getVideojsOptions=function(e){var t={textTrackSettings:!1,controls:void 0===e.controls||e.controls,muted:void 0!==e.controls&&e.muted,loop:void 0!==e.loop&&e.loop,poster:e.poster,autoplay:!1,inactivityTimeout:e.inactivityTimeout,playbackRates:[.5,.75,1,1.25,1.5,2],plugins:{peertube:{autoplay:e.autoplay,videoCaptions:e.videoCaptions,videoFiles:e.videoFiles,playerElement:e.playerElement,videoViewUrl:e.videoViewUrl,videoDuration:e.videoDuration,startTime:e.startTime,userWatching:e.userWatching}},controlBar:{children:function(e){var t=[];t.push("playbackRateMenuButton"),0!==e.videoCaptions.length&&t.push("captionsButton"),t.push("resolutionMenuButton");var n={playToggle:{},currentTimeDisplay:{},timeDivider:{},durationDisplay:{},liveDisplay:{},flexibleWidthSpacer:{},progressControl:{children:{seekBar:{children:{peerTubeLoadProgressBar:{},mouseTimeDisplay:{},playProgressBar:{}}}}},webTorrentButton:{},muteToggle:{},volumeControl:{},settingsButton:{setup:{maxHeightOffset:40},entries:t}};return!0===e.peertubeLink&&Object.assign(n,{peerTubeLinkButton:{}}),!0===e.theaterMode&&Object.assign(n,{theaterButton:{}}),Object.assign(n,{fullscreenToggle:{}}),n}(e)}};return!0===e.enableHotkeys&&Object.assign(t.plugins,{hotkeys:{enableVolumeScroll:!1,enableModifiersForNumbers:!1,fullscreenKey:function(e){return"f"===e.key||e.ctrlKey&&"Enter"===e.key},seekStep:function(e){return e.ctrlKey&&e.altKey?300:e.ctrlKey?60:e.altKey?10:5},customKeys:{increasePlaybackRateKey:{key:function(e){return">"===e.key},handler:function(e){e.playbackRate((e.playbackRate()+.1).toFixed(2))}},decreasePlaybackRateKey:{key:function(e){return"<"===e.key},handler:function(e){e.playbackRate((e.playbackRate()-.1).toFixed(2))}},frameByFrame:{key:function(e){return"."===e.key},handler:function(e){e.pause(),e.currentTime(e.currentTime()+1/30)}}}}}),e.language&&!o.isDefaultLocale(e.language)&&Object.assign(t,{language:e.language}),t},t.addContextMenu=function(e,t){e.contextmenuUI({content:[{label:e.localize("Copy the video URL"),listener:function(){i.copyToClipboard(i.buildVideoLink())}},{label:e.localize("Copy the video URL at the current time"),listener:function(){i.copyToClipboard(i.buildVideoLink(this.currentTime()))}},{label:e.localize("Copy embed code"),listener:function(){i.copyToClipboard(i.buildVideoEmbed(t))}},{label:e.localize("Copy magnet URI"),listener:function(){i.copyToClipboard(this.peertube().getCurrentVideoFile().magnetUri)}}]})},t.loadLocaleInVideoJS=s,function(e){e.cache={}}(s||(s={})),t.loadLocaleInVideoJS=s,t.getServerTranslations=function(e,t){var n=a(e,t);return n?fetch(n+"/server.json").then(function(e){return e.json()}):Promise.resolve(void 0)}},function(e,t,n){var r,i,o;o=function(e){"use strict";"undefined"!=typeof window&&(window.videojs_hotkeys={version:"0.2.22"}),(e.registerPlugin||e.plugin)("hotkeys",function(t){function n(e){return"function"==typeof a?a(e):a}var r=this,i=r.el(),o=document,s=(t=(e.mergeOptions||e.util.mergeOptions)({volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!1,enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:function(e){return 32===e.which||179===e.which},rewindKey:function(e){return 37===e.which||177===e.which},forwardKey:function(e){return 39===e.which||176===e.which},volumeUpKey:function(e){return 38===e.which},volumeDownKey:function(e){return 40===e.which},muteKey:function(e){return 77===e.which},fullscreenKey:function(e){return 70===e.which},customKeys:{}},t||{})).volumeStep,a=t.seekStep,u=t.enableMute,c=t.enableVolumeScroll,l=t.enableFullscreen,h=t.enableNumbers,f=t.enableJogStyle,d=t.alwaysCaptureHotkeys,p=t.enableModifiersForNumbers,g=t.enableInactiveFocus,v=t.skipInitialFocus;i.hasAttribute("tabIndex")||i.setAttribute("tabIndex","-1"),i.style.outline="none",!d&&r.autoplay()||v||r.one("play",function(){i.focus()}),g&&r.on("userinactive",function(){var e=function(){clearTimeout(t)},t=setTimeout(function(){r.off("useractive",e);var t=o.activeElement,n=i.querySelector(".vjs-control-bar");t&&t.parentElement==n&&i.focus()},10);r.one("useractive",e)}),r.on("play",function(){var e=i.querySelector(".iframeblocker");e&&""===e.style.display&&(e.style.display="block",e.style.bottom="39px")});var m=function(e){if(r.controls()){var t=o.activeElement;if((d||t==i||t==i.querySelector(".vjs-tech")||t==i.querySelector(".iframeblocker")||t==i.querySelector(".vjs-control-bar"))&&c){e=window.event||e;var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));e.preventDefault(),1==n?r.volume(r.volume()+s):-1==n&&r.volume(r.volume()-s)}}};return r.on("keydown",function(e){var a,c,g=e.which,v=e.preventDefault,m=r.duration();if(r.controls()){var y=o.activeElement;if(d||y==i||y==i.querySelector(".vjs-tech")||y==i.querySelector(".vjs-control-bar")||y==i.querySelector(".iframeblocker"))switch(function(e,n){return t.playPauseKey(e,n)?1:t.rewindKey(e,n)?2:t.forwardKey(e,n)?3:t.volumeUpKey(e,n)?4:t.volumeDownKey(e,n)?5:t.muteKey(e,n)?6:t.fullscreenKey(e,n)?7:void 0}(e,r)){case 1:v(),d&&e.stopPropagation(),r.paused()?r.play():r.pause();break;case 2:a=!r.paused(),v(),a&&r.pause(),(c=r.currentTime()-n(e))<=0&&(c=0),r.currentTime(c),a&&r.play();break;case 3:a=!r.paused(),v(),a&&r.pause(),(c=r.currentTime()+n(e))>=m&&(c=a?m-.001:m),r.currentTime(c),a&&r.play();break;case 5:v(),f?(c=r.currentTime()-1,r.currentTime()<=1&&(c=0),r.currentTime(c)):r.volume(r.volume()-s);break;case 4:v(),f?((c=r.currentTime()+1)>=m&&(c=m),r.currentTime(c)):r.volume(r.volume()+s);break;case 6:u&&r.muted(!r.muted());break;case 7:l&&(r.isFullscreen()?r.exitFullscreen():r.requestFullscreen());break;default:if((g>47&&g<59||g>95&&g<106)&&(p||!(e.metaKey||e.ctrlKey||e.altKey))&&h){var _=48;g>95&&(_=96);var b=g-_;v(),r.currentTime(r.duration()*b*.1)}for(var w in t.customKeys){var E=t.customKeys[w];E&&E.key&&E.handler&&E.key(e)&&(v(),E.handler(r,t,e))}}}}),r.on("dblclick",function(e){if(r.controls()){var t=e.relatedTarget||e.toElement||o.activeElement;t!=i&&t!=i.querySelector(".vjs-tech")&&t!=i.querySelector(".iframeblocker")||l&&(r.isFullscreen()?r.exitFullscreen():r.requestFullscreen())}}),r.on("mousewheel",m),r.on("DOMMouseScroll",m),this})},"undefined"!=typeof window&&window.videojs?o(window.videojs):(r=[n(2)],void 0===(i=function(e){return o(e.default||e)}.apply(t,r))||(e.exports=i))},function(e,t,n){"use strict";n.r(t),n.d(t,"Title",function(){return d}),n.d(t,"Shelf",function(){return p});var r=n(26),i=n.n(r),o=n(2),s=n.n(o);function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var u=1,c=function(){return u++},l=s.a.dom||s.a,h=s.a.registerPlugin||s.a.plugin,f=s.a.getComponent("Component"),d=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i=t.$(".vjs-tech");return i.setAttribute("aria-labelledby",r.title.id),i.setAttribute("aria-describedby",r.description.id),r}a(t,e);var n=t.prototype;return n.createEl=function(){var t=l.createEl("div",{className:"vjs-dock-title",title:this.options_.title,innerHTML:this.options_.title},{id:"vjs-dock-title-"+c()}),n=l.createEl("div",{className:"vjs-dock-description",title:this.options_.description,innerHTML:this.options_.description},{id:"vjs-dock-description-"+c()}),r=e.prototype.createEl.call(this,"div",{className:"vjs-dock-text"});return this.title=t,this.description=n,r.appendChild(t),r.appendChild(n),r},n.update=function(e,t){this.title.innerHTML="",this.description.innerHTML="",this.title.appendChild(i.a.createTextNode(e)),this.description.appendChild(i.a.createTextNode(t))},t}(f),p=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-dock-shelf"})},t}(f);s.a.registerComponent("Title",d),s.a.registerComponent("Shelf",p);var g=function(e){var t=e||{},n={title:{title:t.title||"",description:t.description||""}},r=this.title,i=this.shelf;this.addClass("vjs-dock");var o=this.children().indexOf(this.getChild("bigPlayButton")),s=o>0?o-1:null;i||(i=this.shelf=this.addChild("shelf",n,s)),r?r.update(n.title.title,n.title.description):r=this.title=this.addChild("title",n.title,s),this.one(r,"dispose",function(){this.title=null}),this.one(i,"dispose",function(){this.shelf=null})};g.VERSION="2.1.4",h("dock",g),t.default=g},function(e,t,n){"use strict";n.r(t);var r=n(41),i=n.n(r),o=n(2),s=n.n(o),a=n(26),u=n.n(a);function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var h=function(e){function t(){return e.apply(this,arguments)||this}return c(t,e),t.prototype.handleClick=function(t){var n=this;e.prototype.handleClick.call(this),this.options_.listener(),i.a.setTimeout(function(){n.player().contextmenuUI.menu.dispose()},1)},t}(s.a.getComponent("MenuItem")),f=s.a.getComponent("Menu"),d=s.a.dom||s.a,p=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).dispose=s.a.bind(l(l(r)),r.dispose),n.content.forEach(function(e){var n=function(){};"function"==typeof e.listener?n=e.listener:"string"==typeof e.href&&(n=function(){return i.a.open(e.href)}),r.addItem(new h(t,{label:e.label,listener:s.a.bind(t,n)}))}),r}return c(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this);return d.addClass(t,"vjs-contextmenu-ui-menu"),t.style.left=this.options_.position.left+"px",t.style.top=this.options_.position.top+"px",t},t}(f),g="5.1.0";function v(e){return e.hasOwnProperty("contextmenuUI")&&e.contextmenuUI.hasOwnProperty("menu")&&e.contextmenuUI.menu.el()}function m(e){var t,n,r,o,a,c,l,h,f,d=this;if(v(this))this.contextmenuUI.menu.dispose();else{var g=function(e,t){return{left:Math.round(t.width*e.x),top:Math.round(t.height-t.height*e.y)}}((n=e,r={},o=function(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=u.a.documentElement,r=u.a.body,o=t.top+(i.a.pageYOffset||r.scrollTop)-(n.clientTop||r.clientTop||0);return{left:Math.round(t.left+(i.a.pageXOffset||r.scrollLeft)-(n.clientLeft||r.clientLeft||0)),top:Math.round(o)}}(t=this.el()),a=t.offsetWidth,c=t.offsetHeight,l=o.left,h=n.pageY,f=n.pageX,n.changedTouches&&(f=n.changedTouches[0].pageX,h=n.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(o.top-h+c)/c)),r.x=Math.max(0,Math.min(1,(f-l)/a)),r),this.el().getBoundingClientRect());e.preventDefault();var m=this.contextmenuUI.menu=new p(this,{content:this.contextmenuUI.content,position:g});this.contextmenuUI.closeMenu=function(){s.a.log.warn("player.contextmenuUI.closeMenu() is deprecated, please use player.contextmenuUI.menu.dispose() instead!"),m.dispose()},m.on("dispose",function(){s.a.off(u.a,["click","tap"],m.dispose),d.removeChild(m),delete d.contextmenuUI.menu}),this.addChild(m);var y=m.el_.getBoundingClientRect(),_=u.a.body.getBoundingClientRect();(this.contextmenuUI.keepInside||y.right>_.width||y.bottom>_.height)&&(m.el_.style.left=Math.floor(Math.min(g.left,this.player_.currentWidth()-m.currentWidth()))+"px",m.el_.style.top=Math.floor(Math.min(g.top,this.player_.currentHeight()-m.currentHeight()))+"px"),s.a.on(u.a,["click","tap"],m.dispose)}}function y(e){var t=this;if(e=s.a.mergeOptions({keepInside:!0},e),!Array.isArray(e.content))throw new Error('"content" required');v(this)&&(this.contextmenuUI.menu.dispose(),this.off("contextmenu",this.contextmenuUI.onContextMenu),delete this.contextmenuUI);var n=this.contextmenuUI=function(){y.apply(this,arguments)};n.onContextMenu=s.a.bind(this,m),n.content=e.content,n.keepInside=e.keepInside,n.VERSION=g,this.on("contextmenu",n.onContextMenu),this.ready(function(){return t.addClass("vjs-contextmenu-ui")})}s.a.registerPlugin("contextmenuUI",y),y.VERSION=g,t.default=y},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),s=n(39),a=o.videojsUntyped.getComponent("Button"),u=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.createEl=function(){return this.buildElement()},t.prototype.updateHref=function(){this.el().setAttribute("href",s.buildVideoLink(this.player().currentTime()))},t.prototype.handleClick=function(){this.player_.pause()},t.prototype.buildElement=function(){var e=this,t=o.videojsUntyped.dom.createEl("a",{href:s.buildVideoLink(),innerHTML:"PeerTube",title:this.player_.localize("Go to the video page"),className:"vjs-peertube-link",target:"_blank"});return t.addEventListener("mouseenter",function(){return e.updateHref()}),t},t}(a);a.registerComponent("PeerTubeLinkButton",u)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),s=n(317),a=o.videojsUntyped.getComponent("Menu"),u=o.videojsUntyped.getComponent("MenuButton"),c=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.player=t,t.peertube().on("videoFileUpdate",function(){return r.updateLabel()}),t.peertube().on("autoResolutionUpdate",function(){return r.updateLabel()}),r}return i(t,e),t.prototype.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=o.videojsUntyped.dom.createEl("div",{className:"vjs-resolution-value",innerHTML:this.buildLabelHTML()}),t.appendChild(this.labelEl_),t},t.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-label","Quality")},t.prototype.createMenu=function(){for(var e=new a(this.player_),t=0,n=this.player_.peertube().videoFiles;t<n.length;t++){var r=n[t],i=r.resolution.label;r.fps&&r.fps>=50&&(i+=r.fps),e.addChild(new s.ResolutionMenuItem(this.player_,{id:r.resolution.id,label:i,src:r.magnetUri}))}return e.addChild(new s.ResolutionMenuItem(this.player_,{id:-1,label:this.player_.localize("Auto"),src:null})),e},t.prototype.updateLabel=function(){this.labelEl_&&(this.labelEl_.innerHTML=this.buildLabelHTML())},t.prototype.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-resolution-button"},t.prototype.buildWrapperCSSClass=function(){return"vjs-resolution-control "+e.prototype.buildWrapperCSSClass.call(this)},t.prototype.buildLabelHTML=function(){return this.player_.peertube().getCurrentResolutionLabel()},t}(u);c.prototype.controlText_="Quality",u.registerComponent("ResolutionMenuButton",c)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24).videojsUntyped.getComponent("MenuItem"),s=function(e){function t(t,n){var r=this,i=t.peertube().getCurrentResolutionId();return n.selectable=!0,n.selected=n.id===i,(r=e.call(this,t,n)||this).label=n.label,r.id=n.id,t.peertube().on("videoFileUpdate",function(){return r.updateSelection()}),t.peertube().on("autoResolutionUpdate",function(){return r.updateSelection()}),r}return i(t,e),t.prototype.handleClick=function(t){-1===this.id&&this.player_.peertube().isAutoResolutionForbidden()||(e.prototype.handleClick.call(this,t),-1!==this.id?(this.player_.peertube().disableAutoResolution(),this.player_.peertube().updateResolution(this.id)):this.player_.peertube().enableAutoResolution())},t.prototype.updateSelection=function(){-1===this.id&&(this.player_.peertube().isAutoResolutionForbidden()?this.addClass("disabled"):this.removeClass("disabled")),this.player_.peertube().isAutoResolutionOn()?this.selected(-1===this.id):this.selected(this.player_.peertube().getCurrentResolutionId()===this.id)},t.prototype.getLabel=function(){return-1===this.id?this.label+" <small>"+this.player_.peertube().getCurrentResolutionLabel()+"</small>":this.label},t}(o);t.ResolutionMenuItem=s,o.registerComponent("ResolutionMenuItem",s)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(39),s=n(24),a=s.videojsUntyped.getComponent("MenuItem"),u=s.videojsUntyped.getComponent("Component"),c=function(e){function t(t,n,r,i){var a=e.call(this,t,n)||this;a.settingsButton=i,a.dialog=a.settingsButton.dialog,a.mainMenu=a.settingsButton.menu,a.panel=a.dialog.getChild("settingsPanel"),a.panelChild=a.panel.getChild("settingsPanelChild"),a.panelChildEl=a.panelChild.el_,a.size=null,a.menuToLoad="mainmenu";var u=o.toTitleCase(r),c=s.videojsUntyped.getComponent(u);if(!c)throw new Error("Component "+u+" does not exist");a.subMenu=new c(a.player(),n,i,a);var l=a.subMenu.buildCSSClass().split(" ")[0];return a.settingsSubMenuEl_.className+=" "+l,a.eventHandlers(),t.ready(function(){setTimeout(function(){a.build(),t.on("ratechange",a.submenuClickHandler),a.reset()},0)}),a}return i(t,e),t.prototype.eventHandlers=function(){this.submenuClickHandler=this.onSubmenuClick.bind(this),this.transitionEndHandler=this.onTransitionEnd.bind(this)},t.prototype.onSubmenuClick=function(e){var t=this,n=null;(n="tap"===e.type?e.target:e.currentTarget)&&n.classList.contains("vjs-back-button")?this.loadMainMenu():setTimeout(function(){return t.update(e)},0)},t.prototype.createEl=function(){var e=s.videojsUntyped.dom.createEl("li",{className:"vjs-menu-item"});return this.settingsSubMenuTitleEl_=s.videojsUntyped.dom.createEl("div",{className:"vjs-settings-sub-menu-title"}),e.appendChild(this.settingsSubMenuTitleEl_),this.settingsSubMenuValueEl_=s.videojsUntyped.dom.createEl("div",{className:"vjs-settings-sub-menu-value"}),e.appendChild(this.settingsSubMenuValueEl_),this.settingsSubMenuEl_=s.videojsUntyped.dom.createEl("div",{className:"vjs-settings-sub-menu"}),e},t.prototype.handleClick=function(){var t=this;this.menuToLoad="submenu",s.videojsUntyped.dom.removeClass(this.el_,"open"),e.prototype.handleClick.call(this),this.mainMenu.el_.style.opacity="0",s.videojsUntyped.dom.hasClass(this.settingsSubMenuEl_,"vjs-hidden")?(s.videojsUntyped.dom.removeClass(this.settingsSubMenuEl_,"vjs-hidden"),setTimeout(function(){t.settingsSubMenuEl_.style.opacity="1",t.settingsSubMenuEl_.style.marginRight="0px"},0),this.settingsButton.setDialogSize(this.size)):s.videojsUntyped.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")},t.prototype.createBackButton=function(){var e=this.subMenu.menu.addChild("MenuItem",{},0);e.name_="BackButton",e.addClass("vjs-back-button"),e.el_.innerHTML=this.player_.localize(this.subMenu.controlText_)},t.prototype.PrefixedEvent=function(e,t,n,r){void 0===r&&(r="addEvent");for(var i=["webkit","moz","MS","o",""],o=0;o<i.length;o++)i[o]||(t=t.toLowerCase()),"addEvent"===r?e.addEventListener(i[o]+t,n,!1):"removeEvent"===r&&e.removeEventListener(i[o]+t,n,!1)},t.prototype.onTransitionEnd=function(e){"margin-right"===e.propertyName&&"mainmenu"===this.menuToLoad&&(s.videojsUntyped.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0")},t.prototype.reset=function(){s.videojsUntyped.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),this.settingsSubMenuEl_.style.opacity="0",this.setMargin()},t.prototype.loadMainMenu=function(){var e=this;this.menuToLoad="mainmenu",this.mainMenu.show(),this.mainMenu.el_.style.opacity="0",this.settingsButton.setDialogSize([this.mainMenu.width,this.mainMenu.height]),setTimeout(function(){e.setMargin(),e.mainMenu.el_.style.opacity="1"},0)},t.prototype.build=function(){var e=this,t=this.subMenu.updateLabel;this.subMenu.updateLabel=function(){e.update(),t.call(e.subMenu)},this.settingsSubMenuTitleEl_.innerHTML=this.player_.localize(this.subMenu.controlText_),this.settingsSubMenuEl_.appendChild(this.subMenu.menu.el_),this.panelChildEl.appendChild(this.settingsSubMenuEl_),this.update(),this.createBackButton(),this.getSize(),this.bindClickEvents(),this.PrefixedEvent(this.settingsSubMenuEl_,"TransitionEnd",this.transitionEndHandler,"addEvent")},t.prototype.update=function(e){var t=this,n=null,r=this.subMenu.name();if(e&&"tap"===e.type?n=e.target:e&&(n=e.currentTarget),"PlaybackRateMenuButton"===r)setTimeout(function(){return t.settingsSubMenuValueEl_.innerHTML=t.subMenu.labelEl_.innerHTML},250);else for(var i=0,o=this.subMenu.menu.children_;i<o.length;i++){var s=o[i];if(s instanceof u&&s.hasClass("vjs-selected")){if("function"==typeof s.getLabel){this.settingsSubMenuValueEl_.innerHTML=s.getLabel();break}this.settingsSubMenuValueEl_.innerHTML=s.options_.label}}n&&!n.classList.contains("vjs-back-button")&&this.settingsButton.hideDialog()},t.prototype.bindClickEvents=function(){for(var e=0,t=this.subMenu.menu.children();e<t.length;e++){var n=t[e];n instanceof u&&n.on(["tap","click"],this.submenuClickHandler)}},t.prototype.getSize=function(){this.dialog.removeClass("vjs-hidden"),this.size=this.settingsButton.getComponentSize(this.settingsSubMenuEl_),this.setMargin(),this.dialog.addClass("vjs-hidden"),s.videojsUntyped.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden")},t.prototype.setMargin=function(){this.settingsSubMenuEl_.style.marginRight="-"+this.size[0]+"px"},t.prototype.hideSubMenu=function(){this.el_&&s.videojsUntyped.dom.hasClass(this.el_,"open")&&(s.videojsUntyped.dom.addClass(this.settingsSubMenuEl_,"vjs-hidden"),s.videojsUntyped.dom.removeClass(this.el_,"open"))},t}(a);t.SettingsMenuItem=c,c.prototype.contentElType="button",s.videojsUntyped.registerComponent("SettingsMenuItem",c)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),s=n(39),a=o.videojsUntyped.getComponent("Button"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.createEl=function(){var e=this,t=o.videojsUntyped.dom.createEl("div",{className:"vjs-peertube"}),n=o.videojsUntyped.dom.createEl("div",{className:"vjs-peertube-hidden"});t.appendChild(n);var r=o.videojsUntyped.dom.createEl("span",{className:"icon icon-download"});n.appendChild(r);var i=o.videojsUntyped.dom.createEl("span",{className:"download-speed-text"}),a=o.videojsUntyped.dom.createEl("span",{className:"download-speed-number"}),u=o.videojsUntyped.dom.createEl("span");i.appendChild(a),i.appendChild(u),n.appendChild(i);var c=o.videojsUntyped.dom.createEl("span",{className:"icon icon-upload"});n.appendChild(c);var l=o.videojsUntyped.dom.createEl("span",{className:"upload-speed-text"}),h=o.videojsUntyped.dom.createEl("span",{className:"upload-speed-number"}),f=o.videojsUntyped.dom.createEl("span");l.appendChild(h),l.appendChild(f),n.appendChild(l);var d=o.videojsUntyped.dom.createEl("span",{className:"peers-text"}),p=o.videojsUntyped.dom.createEl("span",{className:"peers-number"});n.appendChild(p),n.appendChild(d);var g=o.videojsUntyped.dom.createEl("div",{className:"vjs-peertube-hidden"}),v=o.videojsUntyped.dom.createEl("span",{className:"http-fallback",textContent:"HTTP"});return g.appendChild(v),t.appendChild(g),this.player_.peertube().on("torrentInfo",function(t,r){if(!r)return g.className="vjs-peertube-displayed",void(n.className="vjs-peertube-hidden");var i=s.bytes(r.downloadSpeed),o=s.bytes(r.uploadSpeed),c=s.bytes(r.downloaded),l=s.bytes(r.uploaded),v=r.numPeers;n.title=e.player_.localize("Total downloaded: ")+c.join(" ")+"\n"+e.player_.localize("Total uploaded: "+l.join(" ")),a.textContent=i[0],u.textContent=" "+i[1],h.textContent=o[0],f.textContent=" "+o[1],p.textContent=v,d.textContent=" "+e.player_.localize("peers"),g.className="vjs-peertube-hidden",n.className="vjs-peertube-displayed"}),t},t}(a);a.registerComponent("WebTorrentButton",u)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(321),a=n(408);n(138);var u=n(24),c=n(39),l=n(409),h=n(164),f=n(411),d=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.autoplay=!1,r.startTime=0,r.CONSTANTS={INFO_SCHEDULER:1e3,AUTO_QUALITY_SCHEDULER:3e3,AUTO_QUALITY_THRESHOLD_PERCENT:30,AUTO_QUALITY_OBSERVATION_TIME:1e4,AUTO_QUALITY_HIGHER_RESOLUTION_DELAY:5e3,BANDWIDTH_AVERAGE_NUMBER_OF_VALUES:5,USER_WATCHING_VIDEO_INTERVAL:5e3},r.webtorrent=new s({tracker:{rtcConfig:{iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"stun:stun.framasoft.org"}]}},dht:!1}),r.destoyingFakeRenderer=!1,r.autoResolution=!0,r.forbidAutoResolution=!1,r.isAutoResolutionObservation=!1,r.playerRefusedP2P=!1,r.downloadSpeeds=[],r.autoplay=n.autoplay&&!1===r.isIOS(),r.playerRefusedP2P=!h.getStoredWebTorrentEnabled(),r.startTime=c.timeToInt(n.startTime),r.videoFiles=n.videoFiles,r.videoViewUrl=n.videoViewUrl,r.videoDuration=n.videoDuration,r.videoCaptions=n.videoCaptions,r.savePlayerSrcFunction=r.player.src,r.playerElement=n.playerElement,!0===r.autoplay&&r.player.addClass("vjs-has-autoplay"),r.player.ready(function(){var e=h.getStoredVolume();void 0!==e&&r.player.volume(e);var t=h.getStoredMute();void 0!==t&&r.player.muted(t),r.player.duration(n.videoDuration),r.initializePlayer(),r.runTorrentInfoScheduler(),r.runViewAdd(),n.userWatching&&r.runUserWatchVideo(n.userWatching),r.player.one("play",function(){r.runAutoQualitySchedulerTimer=setTimeout(function(){return r.runAutoQualityScheduler()},r.CONSTANTS.AUTO_QUALITY_SCHEDULER)})}),r.player.on("volumechange",function(){h.saveVolumeInStore(r.player.volume()),h.saveMuteInStore(r.player.muted())}),r}return i(t,e),t.prototype.dispose=function(){clearTimeout(this.addTorrentDelay),clearTimeout(this.qualityObservationTimer),clearTimeout(this.runAutoQualitySchedulerTimer),clearInterval(this.videoViewInterval),clearInterval(this.torrentInfoInterval),clearInterval(this.autoQualityInterval),this.userWatchingVideoInterval&&clearInterval(this.userWatchingVideoInterval),this.flushVideoFile(this.currentVideoFile,!1),this.destroyFakeRenderer()},t.prototype.getCurrentResolutionId=function(){return this.currentVideoFile?this.currentVideoFile.resolution.id:-1},t.prototype.getCurrentResolutionLabel=function(){return this.currentVideoFile?this.currentVideoFile.resolution.label+(this.currentVideoFile.fps>=50?this.currentVideoFile.fps:""):""},t.prototype.updateVideoFile=function(e,t,n){var r=this;if(void 0===t&&(t={}),void 0===n&&(n=function(){}),void 0===e){var i=h.getAverageBandwidthInStore();e=i?this.getAppropriateFile(i):this.pickAverageVideoFile()}if(void 0===this.currentVideoFile||this.currentVideoFile.magnetUri!==e.magnetUri){this.disableErrorDisplay(),this.player.src=function(){return!0};var o=this.player.playbackRate(),s=this.currentVideoFile;if(this.currentVideoFile=e,this.isIOS()||this.playerRefusedP2P)return this.fallbackToHttp(t,function(){return r.player.playbackRate(o),n()});this.addTorrent(this.currentVideoFile.magnetUri,s,t,function(){return r.player.playbackRate(o),n()}),this.trigger("videoFileUpdate")}},t.prototype.updateResolution=function(e,t){void 0===t&&(t=0);var n=this.player.currentTime(),r=this.player.paused();this.playerElement.poster="",r||this.player.bigPlayButton.hide();var i=this.videoFiles.find(function(t){return t.resolution.id===e});this.updateVideoFile(i,{forcePlay:!1,delay:t,seek:n+t/1e3})},t.prototype.flushVideoFile=function(e,t){void 0===t&&(t=!0),void 0!==e&&this.webtorrent.get(e.magnetUri)&&(!0===t&&this.renderer&&this.renderer.destroy&&this.renderer.destroy(),this.webtorrent.remove(e.magnetUri),console.log("Removed "+e.magnetUri))},t.prototype.isAutoResolutionOn=function(){return this.autoResolution},t.prototype.enableAutoResolution=function(){this.autoResolution=!0,this.trigger("autoResolutionUpdate")},t.prototype.disableAutoResolution=function(e){void 0===e&&(e=!1),!0===e&&(this.forbidAutoResolution=!0),this.autoResolution=!1,this.trigger("autoResolutionUpdate")},t.prototype.isAutoResolutionForbidden=function(){return!0===this.forbidAutoResolution},t.prototype.getCurrentVideoFile=function(){return this.currentVideoFile},t.prototype.getTorrent=function(){return this.torrent},t.prototype.addTorrent=function(e,t,n,r){var i=this;console.log("Adding "+e+".");var o=this.torrent;this.torrent=this.webtorrent.add(e,{store:function(e,t){return new f(new l.PeertubeChunkStore(e,t),{max:100})}},function(s){console.log("Added "+e+"."),o&&(i.stopTorrent(o),n.delay&&i.renderFileInFakeElement(s.files[0],n.delay)),i.addTorrentDelay=setTimeout(function(){i.destroyFakeRenderer();var e=i.player.paused();i.flushVideoFile(t),n.seek&&i.player.currentTime(n.seek),a.renderVideo(s.files[0],i.playerElement,{autoplay:!1,controls:!0},function(t,o){return i.renderer=o,t?i.fallbackToHttp(n,r):i.tryToPlay(function(t){return t?r(t):(n.seek&&i.seek(n.seek),!1===n.forcePlay&&!0===e&&i.player.pause(),r())})})},n.delay||0)}),this.torrent.on("error",function(e){return console.error(e)}),this.torrent.on("warning",function(e){if(-1===e.message.indexOf("Unsupported tracker protocol"))if(-1===e.message.indexOf("Ice connection failed")){if(-1!==e.message.indexOf("incorrect info hash"))return console.error("Incorrect info hash detected, falling back to torrent file."),i.addTorrent(i.torrent.xs,t,{forcePlay:!0,seek:n.seek},r);-1!==e.message.indexOf("from xs param")&&i.handleError(e),console.warn(e)}else console.log(e)})},t.prototype.tryToPlay=function(e){var t=this;e||(e=function(){});var n=this.player.play();return void 0!==n?n.then(e).catch(function(n){if(-1===n.message.indexOf("The play() request was interrupted by a call to pause()"))return console.error(n),t.player.pause(),t.player.posterImage.show(),t.player.removeClass("vjs-has-autoplay"),t.player.removeClass("vjs-has-big-play-button-clicked"),e()}):e()},t.prototype.seek=function(e){this.player.currentTime(e),this.player.handleTechSeeked_()},t.prototype.getAppropriateFile=function(e){var t=this;if(void 0!==this.videoFiles&&0!==this.videoFiles.length){if(1===this.videoFiles.length)return this.videoFiles[0];if(this.torrent&&1===this.torrent.progress&&this.player.ended())return this.currentVideoFile;e||(e=this.getAndSaveActualDownloadSpeed());for(var n=this.playerElement.offsetHeight,r=this.videoFiles[0].resolution.id,i=this.videoFiles.length-1;i>=0;i--){var o=this.videoFiles[i].resolution.id;if(o>=n){r=o;break}}var s=this.videoFiles.filter(function(e){return e.resolution.id<=r}).filter(function(n){var r=n.size/t.videoDuration,i=r;return(!t.currentVideoFile||n.resolution.id>t.currentVideoFile.resolution.id)&&(i+=r*t.CONSTANTS.AUTO_QUALITY_THRESHOLD_PERCENT/100),e>i});return 0===s.length?c.videoFileMinByResolution(this.videoFiles):c.videoFileMaxByResolution(s)}},t.prototype.getAndSaveActualDownloadSpeed=function(){var e=Math.max(this.downloadSpeeds.length-this.CONSTANTS.BANDWIDTH_AVERAGE_NUMBER_OF_VALUES,0),t=this.downloadSpeeds.slice(e,this.downloadSpeeds.length);if(0===t.length)return-1;var n=t.reduce(function(e,t){return e+t}),r=Math.round(n/t.length);return h.saveAverageBandwidth(r),r},t.prototype.initializePlayer=function(){var e=this;if(c.isMobile()&&this.player.addClass("vjs-is-mobile"),this.initSmoothProgressBar(),this.initCaptions(),this.alterInactivity(),!0===this.autoplay)return this.player.posterImage.hide(),this.updateVideoFile(void 0,{forcePlay:!0,seek:this.startTime});var t=this.player.play.bind(this.player);this.player.play=function(){e.player.addClass("vjs-has-big-play-button-clicked"),e.player.play=t,e.updateVideoFile(void 0,{forcePlay:!0,seek:e.startTime})}},t.prototype.runAutoQualityScheduler=function(){var e=this;this.autoQualityInterval=setInterval(function(){if(null!=e.torrent&&!1!==e.isAutoResolutionOn()&&!0!==e.isAutoResolutionObservation){var t=e.getAppropriateFile(),n=!1,r=0;e.isPlayerWaiting()&&t.resolution.id<e.currentVideoFile.resolution.id?(console.log("Downgrading automatically the resolution to: %s",t.resolution.label),n=!0):t.resolution.id>e.currentVideoFile.resolution.id&&(console.log("Upgrading automatically the resolution to: %s",t.resolution.label),n=!0,r=e.CONSTANTS.AUTO_QUALITY_HIGHER_RESOLUTION_DELAY),!0===n&&(e.updateResolution(t.resolution.id,r),e.isAutoResolutionObservation=!0,e.qualityObservationTimer=setTimeout(function(){e.isAutoResolutionObservation=!1},e.CONSTANTS.AUTO_QUALITY_OBSERVATION_TIME))}},this.CONSTANTS.AUTO_QUALITY_SCHEDULER)},t.prototype.isPlayerWaiting=function(){return this.player&&this.player.hasClass("vjs-waiting")},t.prototype.runTorrentInfoScheduler=function(){var e=this;this.torrentInfoInterval=setInterval(function(){if(void 0!==e.torrent)return null===e.torrent?e.trigger("torrentInfo",!1):(0!==e.webtorrent.downloadSpeed&&e.downloadSpeeds.push(e.webtorrent.downloadSpeed),e.trigger("torrentInfo",{downloadSpeed:e.torrent.downloadSpeed,numPeers:e.torrent.numPeers,uploadSpeed:e.torrent.uploadSpeed,downloaded:e.torrent.downloaded,uploaded:e.torrent.uploaded}))},this.CONSTANTS.INFO_SCHEDULER)},t.prototype.runViewAdd=function(){var e=this;this.clearVideoViewInterval();var t=30;this.videoDuration<t&&(t=3*this.videoDuration/4);var n=0;this.videoViewInterval=setInterval(function(){e.player&&!e.player.paused()&&(n+=1)>t&&(e.clearVideoViewInterval(),e.addViewToVideo().catch(function(e){return console.error(e)}))},1e3)},t.prototype.runUserWatchVideo=function(e){var t=this,n=0;this.userWatchingVideoInterval=setInterval(function(){var r=Math.floor(t.player.currentTime());r-n>=1&&(n=r,t.notifyUserIsWatching(r,e.url,e.authorizationHeader).catch(function(e){return console.error("Cannot notify user is watching.",e)}))},this.CONSTANTS.USER_WATCHING_VIDEO_INTERVAL)},t.prototype.clearVideoViewInterval=function(){void 0!==this.videoViewInterval&&(clearInterval(this.videoViewInterval),this.videoViewInterval=void 0)},t.prototype.addViewToVideo=function(){return this.videoViewUrl?fetch(this.videoViewUrl,{method:"POST"}):Promise.resolve(void 0)},t.prototype.notifyUserIsWatching=function(e,t,n){var r=new URLSearchParams;r.append("currentTime",e.toString());var i=new Headers({Authorization:n});return fetch(t,{method:"PUT",body:r,headers:i})},t.prototype.fallbackToHttp=function(e,t){var n=this,r=this.player.paused();this.disableAutoResolution(!0),this.flushVideoFile(this.currentVideoFile,!0),this.torrent=null,this.player.one("error",function(){return n.enableErrorDisplay()});var i=this.currentVideoFile.fileUrl;return this.player.src=this.savePlayerSrcFunction,this.player.src(i),this.tryToPlay(function(i){return i&&t?t(i):(e.seek&&n.seek(e.seek),!1===e.forcePlay&&!0===r&&n.player.pause(),t?t():void 0)})},t.prototype.handleError=function(e){return this.player.trigger("customError",{err:e})},t.prototype.enableErrorDisplay=function(){this.player.addClass("vjs-error-display-enabled")},t.prototype.disableErrorDisplay=function(){this.player.removeClass("vjs-error-display-enabled")},t.prototype.isIOS=function(){return!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},t.prototype.alterInactivity=function(){var e,t=this,n=function(){e=t.player.options_.inactivityTimeout,t.player.options_.inactivityTimeout=0},r=function(){t.player.options_.inactivityTimeout=e},i=this.player.children_.find(function(e){return"SettingsDialog"===e.name_});this.player.controlBar.on("mouseenter",function(){return n()}),i.on("mouseenter",function(){return n()}),this.player.controlBar.on("mouseleave",function(){return r()}),i.on("mouseleave",function(){return r()})},t.prototype.pickAverageVideoFile=function(){return 1===this.videoFiles.length?this.videoFiles[0]:this.videoFiles[Math.floor(this.videoFiles.length/2)]},t.prototype.stopTorrent=function(e){e.pause(),e.removePeer(e.ws)},t.prototype.renderFileInFakeElement=function(e,t){var n=this;this.destoyingFakeRenderer=!1;var r=document.createElement("video");a.renderVideo(e,r,{autoplay:!1,controls:!1},function(e,i){n.fakeRenderer=i,!1===n.destoyingFakeRenderer&&e&&console.error("Cannot render new torrent in fake video element.",e),r.currentTime=n.player.currentTime()+(t-2e3)})},t.prototype.destroyFakeRenderer=function(){if(this.fakeRenderer){if(this.destoyingFakeRenderer=!0,this.fakeRenderer.destroy)try{this.fakeRenderer.destroy()}catch(e){console.log("Cannot destroy correctly fake renderer.",e)}this.fakeRenderer=void 0}},t.prototype.initCaptions=function(){for(var e=0,t=this.videoCaptions;e<t.length;e++){var n=t[e];this.player.addRemoteTextTrack({kind:"captions",label:n.label,language:n.language,id:n.language,src:n.src},!1)}},t.prototype.initSmoothProgressBar=function(){var e=u.videojsUntyped.getComponent("SeekBar");e.prototype.getPercent=function(){var e=this.player_.currentTime()/this.player_.duration();return e>=1?1:e},e.prototype.handleMouseMove=function(e){var t=this.calculateDistance(e)*this.player_.duration();t===this.player_.duration()&&(t-=.1),this.player_.currentTime(t),this.update()}},t}(o.getPlugin("plugin"));t.PeerTubePlugin=d,o.registerPlugin("peertube",d)},function(e,t,n){(function(t,r){const{Buffer:i}=n(25),{EventEmitter:o}=n(18),s=n(140),a=n(324),u=n(16)("webtorrent"),c=n(345),l=n(346),h=n(53),f=n(149),d=n(33),p=n(96),g=n(55),v=n(97),m=n(361),y=n(362),_=n(100).version,b=_.replace(/\d*./g,e=>`0${e%100}`.slice(-2)).slice(0,4),w=`-WW${b}-`;class E extends o{constructor(e={}){super(),this.peerId="string"==typeof e.peerId?e.peerId:i.isBuffer(e.peerId)?e.peerId.toString("hex"):i.from(w+g(9).toString("base64")).toString("hex"),this.peerIdBuffer=i.from(this.peerId,"hex"),this.nodeId="string"==typeof e.nodeId?e.nodeId:i.isBuffer(e.nodeId)?e.nodeId.toString("hex"):g(20).toString("hex"),this.nodeIdBuffer=i.from(this.nodeId,"hex"),this._debugId=this.peerId.toString("hex").substring(0,7),this.destroyed=!1,this.listening=!1,this.torrentPort=e.torrentPort||0,this.dhtPort=e.dhtPort||0,this.tracker=void 0!==e.tracker?e.tracker:{},this.torrents=[],this.maxConns=Number(e.maxConns)||55,this._debug("new webtorrent (peerId %s, nodeId %s, port %s)",this.peerId,this.nodeId,this.torrentPort),this.tracker&&("object"!=typeof this.tracker&&(this.tracker={}),e.rtcConfig&&(console.warn("WebTorrent: opts.rtcConfig is deprecated. Use opts.tracker.rtcConfig instead"),this.tracker.rtcConfig=e.rtcConfig),e.wrtc&&(console.warn("WebTorrent: opts.wrtc is deprecated. Use opts.tracker.wrtc instead"),this.tracker.wrtc=e.wrtc),t.WRTC&&!this.tracker.wrtc&&(this.tracker.wrtc=t.WRTC)),"function"==typeof m?this._tcpPool=new m(this):r.nextTick(()=>{this._onListening()}),this._downloadSpeed=v(),this._uploadSpeed=v(),!1!==e.dht&&"function"==typeof c?(this.dht=new c(Object.assign({},{nodeId:this.nodeId},e.dht)),this.dht.once("error",e=>{this._destroy(e)}),this.dht.once("listening",()=>{const e=this.dht.address();e&&(this.dhtPort=e.port)}),this.dht.setMaxListeners(0),this.dht.listen(this.dhtPort)):this.dht=!1,this.enableWebSeeds=!1!==e.webSeeds;const n=()=>{this.destroyed||(this.ready=!0,this.emit("ready"))};"function"==typeof l&&null!=e.blocklist?l(e.blocklist,{headers:{"user-agent":`WebTorrent/${_} (https://webtorrent.io)`}},(e,t)=>{if(e)return this.error(`Failed to load blocklist: ${e.message}`);this.blocked=t,n()}):r.nextTick(n)}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){const e=this.torrents.filter(e=>1!==e.progress);return e.reduce((e,t)=>e+t.downloaded,0)/(e.reduce((e,t)=>e+(t.length||0),0)||1)}get ratio(){return this.torrents.reduce((e,t)=>e+t.uploaded,0)/(this.torrents.reduce((e,t)=>e+t.received,0)||1)}get(e){if(e instanceof y){if(this.torrents.includes(e))return e}else{let t;try{t=f(e)}catch(e){}if(!t)return null;if(!t.infoHash)throw new Error("Invalid torrent identifier");for(const e of this.torrents)if(e.infoHash===t.infoHash)return e}return null}download(e,t,n){return console.warn("WebTorrent: client.download() is deprecated. Use client.add() instead"),this.add(e,t,n)}add(e,t={},n){if(this.destroyed)throw new Error("client is destroyed");"function"==typeof t&&([t,n]=[{},t]);const r=()=>{if(!this.destroyed)for(const e of this.torrents)if(e.infoHash===o.infoHash&&e!==o)return void o._destroy(new Error(`Cannot add duplicate torrent ${o.infoHash}`))},i=()=>{this.destroyed||("function"==typeof n&&n(o),this.emit("torrent",o))};this._debug("add"),t=t?Object.assign({},t):{};const o=new y(e,this,t);return this.torrents.push(o),o.once("_infoHash",r),o.once("ready",i),o.once("close",function e(){o.removeListener("_infoHash",r),o.removeListener("ready",i),o.removeListener("close",e)}),o}seed(e,t,n){if(this.destroyed)throw new Error("client is destroyed");"function"==typeof t&&([t,n]=[{},t]),this._debug("seed"),t=t?Object.assign({},t):{},"string"==typeof e&&(t.path=d.dirname(e)),t.createdBy||(t.createdBy=`WebTorrent/${b}`);const r=e=>{this._debug("on seed"),"function"==typeof n&&n(e),e.emit("seed"),this.emit("seed",e)},i=this.add(null,t,e=>{const t=[t=>{e.load(o,t)}];this.dht&&t.push(t=>{e.once("dhtAnnounce",t)}),h(t,t=>{if(!this.destroyed)return t?e._destroy(t):void r(e)})});let o;return"undefined"!=typeof FileList&&e instanceof FileList?e=Array.from(e):Array.isArray(e)||(e=[e]),h(e.map(e=>t=>{!function(t){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}()?t(null,e):s(e,t)}),(e,n)=>{if(!this.destroyed)return e?i._destroy(e):void a.parseInput(n,t,(e,r)=>{if(!this.destroyed){if(e)return i._destroy(e);o=r.map(e=>e.getStream),a(n,t,(e,t)=>{if(this.destroyed)return;if(e)return i._destroy(e);const n=this.get(t);n?i._destroy(new Error(`Cannot add duplicate torrent ${n.infoHash}`)):i._onTorrentId(t)})}})}),i}remove(e,t){if(this._debug("remove"),!this.get(e))throw new Error(`No torrent with id ${e}`);this._remove(e,t)}_remove(e,t){const n=this.get(e);n&&(this.torrents.splice(this.torrents.indexOf(n),1),n.destroy(t))}address(){return this.listening?this._tcpPool?this._tcpPool.server.address():{address:"0.0.0.0",family:"IPv4",port:0}:null}destroy(e){if(this.destroyed)throw new Error("client already destroyed");this._destroy(null,e)}_destroy(e,t){this._debug("client destroy"),this.destroyed=!0;const n=this.torrents.map(e=>t=>{e.destroy(t)});this._tcpPool&&n.push(e=>{this._tcpPool.destroy(e)}),this.dht&&n.push(e=>{this.dht.destroy(e)}),h(n,t),e&&this.emit("error",e),this.torrents=[],this._tcpPool=null,this.dht=null}_onListening(){if(this._debug("listening"),this.listening=!0,this._tcpPool){const e=this._tcpPool.server.address();e&&(this.torrentPort=e.port)}this.emit("listening")}_debug(){const e=[].slice.call(arguments);e[0]=`[${this._debugId}] ${e[0]}`,u(...e)}}E.WEBRTC_SUPPORT=p.WEBRTC_SUPPORT,E.VERSION=_,e.exports=E}).call(this,n(10),n(4))},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[1];return 3*(t[0]+n)/4-n},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],s=n[1],a=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),u=0,l=s>0?r-4:r,h=0;h<l;h+=4)t=i[e.charCodeAt(h)]<<18|i[e.charCodeAt(h+1)]<<12|i[e.charCodeAt(h+2)]<<6|i[e.charCodeAt(h+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;return 2===s&&(t=i[e.charCodeAt(h)]<<2|i[e.charCodeAt(h+1)]>>4,a[u++]=255&t),1===s&&(t=i[e.charCodeAt(h)]<<10|i[e.charCodeAt(h+1)]<<4|i[e.charCodeAt(h+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t),a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(e,s,s+16383>a?a:s+16383));return 1===i?o.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&o.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o=[],s=t;s<n;s+=3)o.push(r[(i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*u-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=p,s/=256,c-=8);e[n+d-p]|=128*g}},function(e,t,n){(function(t,r,i){const o=n(66),s=n(141),a=n(333),u=n(33),c=n(335),l=n(338),h=n(68),f=n(339),d=n(340),p=n(148),g=n(34),v=n(53),m=n(54),y=n(11);function _(e,n,i){if("undefined"!=typeof FileList&&e instanceof FileList&&(e=Array.from(e)),Array.isArray(e)||(e=[e]),0===e.length)throw new Error("invalid input type");e.forEach(e=>{if(null==e)throw new Error(`invalid input type: ${e}`)}),1!==(e=e.map(e=>k(e)&&"string"==typeof e.path&&"function"==typeof h.stat?e.path:e)).length||"string"==typeof e[0]||e[0].name||(e[0].name=n.name);let o=null;e.forEach((t,n)=>{if("string"==typeof t)return;let r=t.fullPath||t.name;r||(r=`Unknown File ${n+1}`,t.unknownName=!0),t.path=r.split("/"),t.path[0]||t.path.shift(),t.path.length<2?o=null:0===n&&e.length>1?o=t.path[0]:t.path[0]!==o&&(o=null)}),e=e.filter(e=>{if("string"==typeof e)return!0;const t=e.path[e.path.length-1];return w(t)&&d.not(t)}),o&&e.forEach(e=>{const n=(t.isBuffer(e)||T(e))&&!e.path;"string"==typeof e||n||e.path.shift()}),!n.name&&o&&(n.name=o),n.name||e.some(e=>"string"==typeof e?(n.name=u.basename(e),!0):e.unknownName?void 0:(n.name=e.path[e.path.length-1],!0)),n.name||(n.name=`Unnamed Torrent ${Date.now()}`);const s=e.reduce((e,t)=>e+Number("string"==typeof t),0);let a=1===e.length;if(1===e.length&&"string"==typeof e[0]){if("function"!=typeof h.stat)throw new Error("filesystem paths do not work in the browser");f(e[0],(e,t)=>{if(e)return i(e);a=t,p()})}else r.nextTick(()=>{p()});function p(){v(e.map(e=>n=>{const r={};if(k(e))r.getStream=function(e){return()=>new c(e)}(e),r.length=e.size;else if(t.isBuffer(e))r.getStream=function(e){return()=>{const t=new y.PassThrough;return t.end(e),t}}(e),r.length=e.length;else{if(!T(e)){if("string"==typeof e){if("function"!=typeof h.stat)throw new Error("filesystem paths do not work in the browser");return void function(e,t,n){!function e(t,n,r){h.stat(t,(i,o)=>{if(i)return r(i);o.isDirectory()?h.readdir(t,(i,o)=>{if(i)return r(i);v(o.filter(w).filter(d.not).map(r=>i=>{e(u.join(t,r),n,i)}),r)}):o.isFile()&&n(t,r)})}(e,b,(r,i)=>{if(r)return n(r);i=Array.isArray(i)?l(i):[i],e=u.normalize(e),t&&(e=e.slice(0,e.lastIndexOf(u.sep)+1)),e[e.length-1]!==u.sep&&(e+=u.sep),i.forEach(t=>{t.getStream=function(e){return()=>h.createReadStream(e)}(t.path),t.path=t.path.replace(e,"").split(u.sep)}),n(null,i)})}(e,s>1||a,n)}throw new Error("invalid input type")}r.getStream=function(e,t){return()=>{const n=new y.Transform;return n._transform=function(e,n,r){t.length+=e.length,this.push(e),r()},e.pipe(n),n}}(e,r),r.length=0}r.path=e.path,n(null,r)}),(e,t)=>{if(e)return i(e);t=l(t),i(null,t,a)})}}function b(e,t){t=g(t),h.stat(e,(n,r)=>{if(n)return t(n);t(null,{length:r.size,path:e})})}function w(e){return"."!==e[0]}function E(e,t){return e+t.length}function k(e){return"undefined"!=typeof Blob&&e instanceof Blob}function T(e){return"object"==typeof e&&null!=e&&"function"==typeof e.pipe}e.exports=function(n,r,u){"function"==typeof r&&([r,u]=[u,r]),_(n,r=r?Object.assign({},r):{},(n,c,l)=>{if(n)return u(n);r.singleFileTorrent=l,function(n,r,u){let c=r.announceList;c||("string"==typeof r.announce?c=[[r.announce]]:Array.isArray(r.announce)&&(c=r.announce.map(e=>[e]))),c||(c=[]),i.WEBTORRENT_ANNOUNCE&&("string"==typeof i.WEBTORRENT_ANNOUNCE?c.push([[i.WEBTORRENT_ANNOUNCE]]):Array.isArray(i.WEBTORRENT_ANNOUNCE)&&(c=c.concat(i.WEBTORRENT_ANNOUNCE.map(e=>[e])))),void 0===r.announce&&void 0===r.announceList&&(c=c.concat(e.exports.announceList)),"string"==typeof r.urlList&&(r.urlList=[r.urlList]);const l={info:{name:r.name},"creation date":Math.ceil((Number(r.creationDate)||Date.now())/1e3),encoding:"UTF-8"};0!==c.length&&(l.announce=c[0][0],l["announce-list"]=c),void 0!==r.comment&&(l.comment=r.comment),void 0!==r.createdBy&&(l["created by"]=r.createdBy),void 0!==r.private&&(l.info.private=Number(r.private)),void 0!==r.sslCert&&(l.info["ssl-cert"]=r.sslCert),void 0!==r.urlList&&(l["url-list"]=r.urlList);const h=r.pieceLength||a(n.reduce(E,0));l.info["piece length"]=h,function(e,n,r){r=g(r);const i=[];let o=0;const a=e.map(e=>e.getStream);let u=0,c=0,l=!1;const h=new p(a),f=new s(n,{zeroPadding:!1});function d(e){o+=e.length;const t=c;m(e,e=>{i[t]=e,u-=1,b()}),u+=1,c+=1}function v(){l=!0,b()}function y(e){_(),r(e)}function _(){h.removeListener("error",y),f.removeListener("data",d),f.removeListener("end",v),f.removeListener("error",y)}function b(){l&&0===u&&(_(),r(null,t.from(i.join(""),"hex"),o))}h.on("error",y),h.pipe(f).on("data",d).on("end",v).on("error",y)}(n,h,(e,t,i)=>{if(e)return u(e);l.info.pieces=t,n.forEach(e=>{delete e.getStream}),r.singleFileTorrent?l.info.length=i:l.info.files=n,u(null,o.encode(l))})}(c,r,u)})},e.exports.parseInput=function(e,t,n){"function"==typeof t&&([t,n]=[n,t]),_(e,t=t?Object.assign({},t):{},n)},e.exports.announceList=[["udp://tracker.leechers-paradise.org:6969"],["udp://tracker.coppersurfer.tk:6969"],["udp://tracker.opentrackr.org:1337"],["udp://explodie.org:6969"],["udp://tracker.empire-js.us:1337"],["wss://tracker.btorrent.xyz"],["wss://tracker.openwebtorrent.com"],["wss://tracker.fastcast.nz"]]}).call(this,n(1).Buffer,n(4),n(10))},function(e,t,n){var r=n(25).Buffer;function i(e,t,n){var o=[],s=null;return i._encode(o,e),s=r.concat(o),i.bytes=s.length,r.isBuffer(t)?(s.copy(t,n),t):s}i.bytes=-1,i._floatConversionDetected=!1,i.getType=function(e){return r.isBuffer(e)?"buffer":Array.isArray(e)?"array":ArrayBuffer.isView(e)?"arraybufferview":e instanceof Number?"number":e instanceof Boolean?"boolean":e instanceof ArrayBuffer?"arraybuffer":typeof e},i._encode=function(e,t){if(null!=t)switch(i.getType(t)){case"buffer":i.buffer(e,t);break;case"object":i.dict(e,t);break;case"array":i.list(e,t);break;case"string":i.string(e,t);break;case"number":case"boolean":i.number(e,t);break;case"arraybufferview":i.buffer(e,r.from(t.buffer,t.byteOffset,t.byteLength));break;case"arraybuffer":i.buffer(e,r.from(t))}};var o=r.from("e"),s=r.from("d"),a=r.from("l");i.buffer=function(e,t){e.push(new r(t.length+":"),t)},i.string=function(e,t){e.push(r.from(r.byteLength(t)+":"+t))},i.number=function(e,t){var n=2147483648*(t/2147483648<<0)+(t%2147483648<<0);e.push(r.from("i"+n+"e")),n===t||i._floatConversionDetected||(i._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+t+'":','Bencoding only defines support for integers, value was converted to "'+n+'"'),console.trace())},i.dict=function(e,t){e.push(s);for(var n,r=0,a=Object.keys(t).sort(),u=a.length;r<u;r++)null!=t[n=a[r]]&&(i.string(e,n),i._encode(e,t[n]));e.push(o)},i.list=function(e,t){var n=0,r=t.length;for(e.push(a);n<r;n++)null!=t[n]&&i._encode(e,t[n]);e.push(o)},e.exports=i},function(e,t,n){(function(t){function n(e,t,n){for(var r=0,i=1,o=t;o<n;o++){var s=e[o];if(s<58&&s>=48)r=10*r+(s-48);else if(o!==t||43!==s){if(o!==t||45!==s){if(46===s)break;throw new Error("not a number: buffer["+o+"] = "+s)}i=-1}}return r*i}function r(e,n,i,o){return null==e||0===e.length?null:("number"!=typeof n&&null==o&&(o=n,n=void 0),"number"!=typeof i&&null==o&&(o=i,i=void 0),r.position=0,r.encoding=o||null,r.data=t.isBuffer(e)?e.slice(n,i):new t(e),r.bytes=r.data.length,r.next())}r.bytes=0,r.position=0,r.data=null,r.encoding=null,r.next=function(){switch(r.data[r.position]){case 100:return r.dictionary();case 108:return r.list();case 105:return r.integer();default:return r.buffer()}},r.find=function(e){for(var t=r.position,n=r.data.length,i=r.data;t<n;){if(i[t]===e)return t;t++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(e)+'" [0x'+e.toString(16)+"]")},r.dictionary=function(){r.position++;for(var e={};101!==r.data[r.position];)e[r.buffer()]=r.next();return r.position++,e},r.list=function(){r.position++;for(var e=[];101!==r.data[r.position];)e.push(r.next());return r.position++,e},r.integer=function(){var e=r.find(101),t=n(r.data,r.position+1,e);return r.position+=e+1-r.position,t},r.buffer=function(){var e=r.find(58),t=n(r.data,r.position,e),i=++e+t;return r.position=i,r.encoding?r.data.toString(r.encoding,e,i):r.data.slice(e,i)},e.exports=r}).call(this,n(1).Buffer)},function(e,t){},function(e,t,n){"use strict";var r=n(25).Buffer,i=n(329);e.exports=function(){function e(){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t=r.allocUnsafe(e>>>0),n=this.head,i=0;n;)n.data.copy(t,i),i+=n.data.length,n=n.next;return t},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(10))},function(e,t,n){"use strict";e.exports=o;var r=n(147),i=n(52);function o(e){if(!(this instanceof o))return new o(e);r.call(this,e)}i.inherits=n(7),i.inherits(o,r),o.prototype._transform=function(e,t,n){n(null,e)}},function(e,t){e.exports=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}},function(e,t,n){for(var r=n(334),i=Math.pow(2,10),o=13,s=[];o++<22;)s.push(Math.pow(2,o));e.exports=function(e){return r(e/i,s)}},function(e,t){var n=Math.abs;e.exports=function(e,t,r){for(var i,o,s,a=1/0,u=0,c=t.length-1;u<=c&&((s=t[i=u+(c-u>>1)]-e)<0?u=i+1:s>0&&(c=i-1),(s=n(s))<a&&(a=s,o=i),t[i]!==e););return r?o:t[o]}},function(e,t,n){var r=n(11).Readable,i=n(7),o=n(336);function s(e,t){var n=this;if(!(this instanceof s))return new s(e,t);r.call(this,t=t||{}),this._offset=0,this._ready=!1,this._file=e,this._size=e.size,this._chunkSize=t.chunkSize||Math.max(this._size/1e3,204800),this.reader=new FileReader,this._generateHeaderBlocks(e,t,function(e,t){if(e)return n.emit("error",e);Array.isArray(t)&&t.forEach(function(e){n.push(e)}),n._ready=!0,n.emit("_ready")})}i(s,r),e.exports=s,s.prototype._generateHeaderBlocks=function(e,t,n){n(null,[])},s.prototype._read=function(){if(this._ready){var e=this,t=this.reader,n=this._offset,r=this._offset+this._chunkSize;if(r>this._size&&(r=this._size),n===this._size)return this.destroy(),void this.push(null);t.onload=function(){e._offset=r,e.push(o(t.result))},t.onerror=function(){e.emit("error",t.error)},t.readAsArrayBuffer(this._file.slice(n,r))}else this.once("_ready",this._read.bind(this))},s.prototype.destroy=function(){if(this._file=null,this.reader){this.reader.onload=null,this.reader.onerror=null;try{this.reader.abort()}catch(e){}}this.reader=null}},function(e,t,n){(function(t){var r=n(337).strict;e.exports=function(e){if(r(e)){var n=t.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(n=n.slice(e.byteOffset,e.byteOffset+e.byteLength)),n}return t.from(e)}}).call(this,n(1).Buffer)},function(e,t){e.exports=i,i.strict=o,i.loose=s;var n=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function i(e){return o(e)||s(e)}function o(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function s(e){return r[n.call(e)]}},function(e,t){e.exports=function(e,t){return(t="number"==typeof t?t:1/0)?function e(n,r){return n.reduce(function(n,i){return Array.isArray(i)&&r<t?n.concat(e(i,r+1)):n.concat(i)},[])}(e,1):Array.isArray(e)?e.map(function(e){return e}):e}},function(e,t,n){"use strict";var r=n(68);function i(e){return r.existsSync(e)&&r.statSync(e).isFile()}e.exports=function(e,t){if(!t)return i(e);r.stat(e,function(e,n){return e?t(e):t(null,n.isFile())})},e.exports.sync=i},function(e,t,n){"use strict";t.re=/^npm-debug\.log$|^\..*\.swp$|^\.DS_Store$|^\.AppleDouble$|^\.LSOverride$|^Icon\r$|^\._.*|^\.Spotlight-V100$|\.Trashes|^__MACOSX$|~$|^Thumbs\.db$|^ehthumbs\.db$|^Desktop\.ini$/,t.is=function(e){return t.re.test(e)},t.not=t.isnt=function(e){return!t.is(e)}},function(e,t){e.exports=function e(t,n){if(t&&n)return e(t)(n);if("function"!=typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach(function(e){r[e]=t[e]}),r;function r(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];var r=t.apply(this,e),i=e[e.length-1];return"function"==typeof r&&r!==i&&Object.keys(i).forEach(function(e){r[e]=i[e]}),r}}},function(e,t,n){var r;"undefined"!=typeof self&&self,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){var r=n(5),i=n(1),o=i.toHex,s=i.ceilHeapSize,a=n(6),u=function(e){for(e+=9;e%64>0;e+=1);return e},c=function(e,t){var n=new Int32Array(e,t+320,5),r=new Int32Array(5),i=new DataView(r.buffer);return i.setInt32(0,n[0],!1),i.setInt32(4,n[1],!1),i.setInt32(8,n[2],!1),i.setInt32(12,n[3],!1),i.setInt32(16,n[4],!1),r},l=function(){function e(t){if(function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),(t=t||65536)%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=t,this._padMaxChunkLen=u(t),this._heap=new ArrayBuffer(s(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new r({Int32Array},{},this._heap)}return e.prototype._initState=function(e,t){this._offset=0;var n=new Int32Array(e,t+320,5);n[0]=1732584193,n[1]=-271733879,n[2]=-1732584194,n[3]=271733878,n[4]=-1009589776},e.prototype._padChunk=function(e,t){var n=u(e),r=new Int32Array(this._heap,0,n>>2);return function(e,t){var n=new Uint8Array(e.buffer),r=t%4,i=t-r;switch(r){case 0:n[i+3]=0;case 1:n[i+2]=0;case 2:n[i+1]=0;case 3:n[i+0]=0}for(var o=1+(t>>2);o<e.length;o++)e[o]=0}(r,e),function(e,t,n){e[t>>2]|=128<<24-(t%4<<3),e[14+(2+(t>>2)&-16)]=n/(1<<29)|0,e[15+(2+(t>>2)&-16)]=n<<3}(r,e,t),n},e.prototype._write=function(e,t,n,r){a(e,this._h8,this._h32,t,n,r||0)},e.prototype._coreCall=function(e,t,n,r,i){var o=n;this._write(e,t,n),i&&(o=this._padChunk(n,r)),this._core.hash(o,this._padMaxChunkLen)},e.prototype.rawDigest=function(e){var t=e.byteLength||e.length||e.size||0;this._initState(this._heap,this._padMaxChunkLen);var n=0,r=this._maxChunkLen;for(n=0;t>n+r;n+=r)this._coreCall(e,n,r,t,!1);return this._coreCall(e,n,t-n,t,!0),c(this._heap,this._padMaxChunkLen)},e.prototype.digest=function(e){return o(this.rawDigest(e).buffer)},e.prototype.digestFromString=function(e){return this.digest(e)},e.prototype.digestFromBuffer=function(e){return this.digest(e)},e.prototype.digestFromArrayBuffer=function(e){return this.digest(e)},e.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},e.prototype.append=function(e){var t=0,n=e.byteLength||e.length||e.size||0,r=this._offset%this._maxChunkLen,i=void 0;for(this._offset+=n;t<n;)i=Math.min(n-t,this._maxChunkLen-r),this._write(e,t,i,r),t+=i,(r+=i)===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),r=0);return this},e.prototype.getState=function(){var e=void 0;if(this._offset%this._maxChunkLen)e=this._heap.slice(0);else{var t=new Int32Array(this._heap,this._padMaxChunkLen+320,5);e=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{offset:this._offset,heap:e}},e.prototype.setState=function(e){return this._offset=e.offset,20===e.heap.byteLength?new Int32Array(this._heap,this._padMaxChunkLen+320,5).set(new Int32Array(e.heap)):this._h32.set(new Int32Array(e.heap)),this},e.prototype.rawEnd=function(){var e=this._offset,t=this._padChunk(e%this._maxChunkLen,e);this._core.hash(t,this._padMaxChunkLen);var n=c(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),n},e.prototype.end=function(){return o(this.rawEnd().buffer)},e}();e.exports=l,e.exports._core=r},function(e,t){for(var n=new Array(256),r=0;r<256;r++)n[r]=(r<16?"0":"")+r.toString(16);e.exports.toHex=function(e){for(var t=new Uint8Array(e),r=new Array(e.byteLength),i=0;i<r.length;i++)r[i]=n[t[i]];return r.join("")},e.exports.ceilHeapSize=function(e){var t=0;if(e<=65536)return 65536;if(e<16777216)for(t=1;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},e.exports.isDedicatedWorkerScope=function(e){return"WorkerGlobalScope"in e&&e instanceof e.WorkerGlobalScope&&!("SharedWorkerGlobalScope"in e&&e instanceof e.SharedWorkerGlobalScope)&&!("ServiceWorkerGlobalScope"in e&&e instanceof e.ServiceWorkerGlobalScope)}},function(e,t,n){e.exports=function(){var e=n(0),t=function(e,n,r,i,o){var s=new self.FileReader;s.onloadend=function(){if(s.error)return o(s.error);var a=s.result;n+=s.result.byteLength;try{e.append(a)}catch(e){return void o(e)}n<i.size?t(e,n,r,i,o):o(null,e.end())},s.readAsArrayBuffer(i.slice(n,n+r))},r=!0;return self.onmessage=function(n){if(r){var i=n.data.data,o=n.data.file,s=n.data.id;if(void 0!==s&&(o||i)){var a=n.data.blockSize||4194304,u=new e(a);u.resetState();var c=function(e,t){e?self.postMessage({id:s,error:e.name}):self.postMessage({id:s,hash:t})};i&&function(e,t,n){try{n(null,e.digest(t))}catch(e){return n(e)}}(u,i,c),o&&t(u,0,a,o,c)}}},function(){r=!1}}},function(e,t,n){var r=n(4),i=n(0),o=n(7),s=n(2),a=n(1),u="undefined"!=typeof self&&(0,a.isDedicatedWorkerScope)(self);i.disableWorkerBehaviour=u?s():function(){},i.createWorker=function(){var e=r(2),t=e.terminate;return e.terminate=function(){URL.revokeObjectURL(e.objectURL),t.call(e)},e},i.createHash=o,e.exports=i},function(e,t,n){function r(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var r=n(n.s=ENTRY_MODULE);return r.default||r}var i="[\\.|\\-|\\+|\\w|/|@]+",o="\\((/\\*.*?\\*/)?s?.*?("+i+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,r){var a={};a[r]=[];var u=t.toString(),c=u.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return a;for(var l,h=c[1],f=new RegExp("(\\\\n|\\W)"+s(h)+o,"g");l=f.exec(u);)"dll-reference"!==l[3]&&a[r].push(l[3]);for(f=new RegExp("\\("+s(h)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+o,"g");l=f.exec(u);)e[l[2]]||(a[r].push(l[1]),e[l[2]]=n(l[1]).m),a[l[2]]=a[l[2]]||[],a[l[2]].push(l[4]);return a}function u(e){return Object.keys(e).reduce(function(t,n){return t||e[n].length>0},!1)}e.exports=function(e,t){var i={main:n.m},o=(t=t||{}).all?{main:Object.keys(i)}:function(e,t){for(var n={main:[t]},r={main:[]},i={main:{}};u(n);)for(var o=Object.keys(n),s=0;s<o.length;s++){var c=o[s],l=n[c].pop();if(i[c]=i[c]||{},!i[c][l]&&e[c][l]){i[c][l]=!0,r[c]=r[c]||[],r[c].push(l);for(var h=a(e,e[c][l],c),f=Object.keys(h),d=0;d<f.length;d++)n[f[d]]=n[f[d]]||[],n[f[d]]=n[f[d]].concat(h[f[d]])}}return r}(i,e),s="";Object.keys(o).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;o[e][t];)t++;o[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map(function(t){return JSON.stringify(t)+": "+i[e][t].toString()}).join(",")+"});\n"}),s=s+"("+r.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map(function(e){return JSON.stringify(e)+": "+i.main[e].toString()}).join(",")+"})(self);";var c=new window.Blob([s],{type:"text/javascript"});if(t.bare)return c;var l=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(c),h=new window.Worker(l);return h.objectURL=l,h}},function(e,t){e.exports=function(e,t,n){"use asm";var r=new e.Int32Array(n);function i(e,t){e=e|0;t=t|0;var n=0,i=0,o=0,s=0,a=0,u=0,c=0,l=0,h=0,f=0,d=0,p=0,g=0,v=0;o=r[t+320>>2]|0;a=r[t+324>>2]|0;c=r[t+328>>2]|0;h=r[t+332>>2]|0;d=r[t+336>>2]|0;for(n=0;(n|0)<(e|0);n=n+64|0){s=o;u=a;l=c;f=h;p=d;for(i=0;(i|0)<64;i=i+4|0){v=r[n+i>>2]|0;g=((o<<5|o>>>27)+(a&c|~a&h)|0)+((v+d|0)+1518500249|0)|0;d=h;h=c;c=a<<30|a>>>2;a=o;o=g;r[e+i>>2]=v}for(i=e+64|0;(i|0)<(e+80|0);i=i+4|0){v=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;g=((o<<5|o>>>27)+(a&c|~a&h)|0)+((v+d|0)+1518500249|0)|0;d=h;h=c;c=a<<30|a>>>2;a=o;o=g;r[i>>2]=v}for(i=e+80|0;(i|0)<(e+160|0);i=i+4|0){v=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;g=((o<<5|o>>>27)+(a^c^h)|0)+((v+d|0)+1859775393|0)|0;d=h;h=c;c=a<<30|a>>>2;a=o;o=g;r[i>>2]=v}for(i=e+160|0;(i|0)<(e+240|0);i=i+4|0){v=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;g=((o<<5|o>>>27)+(a&c|a&h|c&h)|0)+((v+d|0)-1894007588|0)|0;d=h;h=c;c=a<<30|a>>>2;a=o;o=g;r[i>>2]=v}for(i=e+240|0;(i|0)<(e+320|0);i=i+4|0){v=(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])<<1|(r[i-12>>2]^r[i-32>>2]^r[i-56>>2]^r[i-64>>2])>>>31;g=((o<<5|o>>>27)+(a^c^h)|0)+((v+d|0)-899497514|0)|0;d=h;h=c;c=a<<30|a>>>2;a=o;o=g;r[i>>2]=v}o=o+s|0;a=a+u|0;c=c+l|0;h=h+f|0;d=d+p|0}r[t+320>>2]=o;r[t+324>>2]=a;r[t+328>>2]=c;r[t+332>>2]=h;r[t+336>>2]=d}return{hash:i}}},function(e,t){var n=this,r=void 0;"undefined"!=typeof self&&void 0!==self.FileReaderSync&&(r=new self.FileReaderSync);var i=function(e,t,n,r,i,o){var s=void 0,a=o%4,u=(i+a)%4,c=i-u;switch(a){case 0:t[o]=e[r+3];case 1:t[o+1-(a<<1)|0]=e[r+2];case 2:t[o+2-(a<<1)|0]=e[r+1];case 3:t[o+3-(a<<1)|0]=e[r]}if(!(i<u+(4-a))){for(s=4-a;s<c;s=s+4|0)n[o+s>>2|0]=e[r+s]<<24|e[r+s+1]<<16|e[r+s+2]<<8|e[r+s+3];switch(u){case 3:t[o+c+1|0]=e[r+c+2];case 2:t[o+c+2|0]=e[r+c+1];case 1:t[o+c+3|0]=e[r+c]}}};e.exports=function(e,t,o,s,a,u){if("string"==typeof e)return function(e,t,n,r,i,o){var s=void 0,a=o%4,u=(i+a)%4,c=i-u;switch(a){case 0:t[o]=e.charCodeAt(r+3);case 1:t[o+1-(a<<1)|0]=e.charCodeAt(r+2);case 2:t[o+2-(a<<1)|0]=e.charCodeAt(r+1);case 3:t[o+3-(a<<1)|0]=e.charCodeAt(r)}if(!(i<u+(4-a))){for(s=4-a;s<c;s=s+4|0)n[o+s>>2]=e.charCodeAt(r+s)<<24|e.charCodeAt(r+s+1)<<16|e.charCodeAt(r+s+2)<<8|e.charCodeAt(r+s+3);switch(u){case 3:t[o+c+1|0]=e.charCodeAt(r+c+2);case 2:t[o+c+2|0]=e.charCodeAt(r+c+1);case 1:t[o+c+3|0]=e.charCodeAt(r+c)}}}(e,t,o,s,a,u);if(e instanceof Array)return i(e,t,o,s,a,u);if(n&&n.Buffer&&n.Buffer.isBuffer(e))return i(e,t,o,s,a,u);if(e instanceof ArrayBuffer)return i(new Uint8Array(e),t,o,s,a,u);if(e.buffer instanceof ArrayBuffer)return i(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t,o,s,a,u);if(e instanceof Blob)return function(t,n,i,o,s,a){var u=void 0,c=a%4,l=(s+c)%4,h=s-l,f=new Uint8Array(r.readAsArrayBuffer(e.slice(o,o+s)));switch(c){case 0:n[a]=f[3];case 1:n[a+1-(c<<1)|0]=f[2];case 2:n[a+2-(c<<1)|0]=f[1];case 3:n[a+3-(c<<1)|0]=f[0]}if(!(s<l+(4-c))){for(u=4-c;u<h;u=u+4|0)i[a+u>>2|0]=f[u]<<24|f[u+1]<<16|f[u+2]<<8|f[u+3];switch(l){case 3:n[a+h+1|0]=f[h+2];case 2:n[a+h+2|0]=f[h+1];case 1:n[a+h+3|0]=f[h]}}}(0,t,o,s,a,u);throw new Error("Unsupported data type.")}},function(e,t,n){var r=n(0),i=n(1).toHex,o=function(){function e(){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this._rusha=new r,this._rusha.resetState()}return e.prototype.update=function(e){return this._rusha.append(e),this},e.prototype.digest=function(e){var t=this._rusha.rawEnd().buffer;if(!e)return t;if("hex"===e)return i(t);throw new Error("unsupported digest encoding")},e}();e.exports=function(){return new o}}])},e.exports=r()},function(e,t,n){var r;function i(e){function n(){if(n.enabled){var e=n,i=+new Date;e.diff=i-(r||i),e.prev=r,e.curr=i,r=i;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];return"function"==typeof i&&(n=i.call(e,o[a]),o.splice(a,1),a--),n}),t.formatArgs.call(e,o),(n.log||t.log||console.log.bind(console)).apply(e,o)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(344),t.names=[],t.skips=[],t.formatters={}},function(e,t){var n=1e3,r=6e4,i=36e5,o=24*i;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?s(a=e,o,"day")||s(a,i,"hour")||s(a,r,"minute")||s(a,n,"second")||a+" ms":function(e){return e>=o?Math.round(e/o)+"d":e>=i?Math.round(e/i)+"h":e>=r?Math.round(e/r)+"m":e>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){},function(e,t){},function(e,t,n){(function(t){e.exports=function(e,n){if("undefined"==typeof Blob||!(e instanceof Blob))throw new Error("first argument must be a Blob");if("function"!=typeof n)throw new Error("second argument must be a function");var r=new FileReader;r.addEventListener("loadend",function e(i){r.removeEventListener("loadend",e,!1),i.error?n(i.error):n(null,t.from(r.result))},!1),r.readAsArrayBuffer(e)}}).call(this,n(1).Buffer)},function(e,t,n){(function(t,r,i){var o=n(151),s=n(7),a=n(152),u=n(11),c=n(153),l=a.IncomingMessage,h=a.readyStates,f=e.exports=function(e){var n,r=this;u.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+new t(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(t){r.setHeader(t,e.headers[t])});var i=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!o.abortController)i=!1,n=!0;else if("prefer-streaming"===e.mode)n=!1;else if("allow-wrong-content-type"===e.mode)n=!o.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");n=!0}r._mode=function(e,t){return o.fetch&&t?"fetch":o.mozchunkedarraybuffer?"moz-chunked-arraybuffer":o.msstream?"ms-stream":o.arraybuffer&&e?"arraybuffer":o.vbArray&&e?"text:vbarray":"text"}(n,i),r._fetchTimer=null,r.on("finish",function(){r._onFinish()})};s(f,u.Writable),f.prototype.setHeader=function(e,t){var n=e.toLowerCase();-1===d.indexOf(n)&&(this._headers[n]={name:e,value:t})},f.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},f.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},f.prototype._onFinish=function(){var e=this;if(!e._destroyed){var n=e._opts,s=e._headers,a=null;"GET"!==n.method&&"HEAD"!==n.method&&(a=o.arraybuffer?c(t.concat(e._body)):o.blobConstructor?new r.Blob(e._body.map(function(e){return c(e)}),{type:(s["content-type"]||{}).value||""}):t.concat(e._body).toString());var u=[];if(Object.keys(s).forEach(function(e){var t=s[e].name,n=s[e].value;Array.isArray(n)?n.forEach(function(e){u.push([t,e])}):u.push([t,n])}),"fetch"===e._mode){var l=null;if(o.abortController){var f=new AbortController;l=f.signal,e._fetchAbortController=f,"requestTimeout"in n&&0!==n.requestTimeout&&(e._fetchTimer=r.setTimeout(function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()},n.requestTimeout))}r.fetch(e._opts.url,{method:e._opts.method,headers:u,body:a||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:l}).then(function(t){e._fetchResponse=t,e._connect()},function(t){r.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)})}else{var d=e._xhr=new r.XMLHttpRequest;try{d.open(e._opts.method,e._opts.url,!0)}catch(t){return void i.nextTick(function(){e.emit("error",t)})}"responseType"in d&&(d.responseType=e._mode.split(":")[0]),"withCredentials"in d&&(d.withCredentials=!!n.withCredentials),"text"===e._mode&&"overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(d.timeout=n.requestTimeout,d.ontimeout=function(){e.emit("requestTimeout")}),u.forEach(function(e){d.setRequestHeader(e[0],e[1])}),e._response=null,d.onreadystatechange=function(){switch(d.readyState){case h.LOADING:case h.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(d.onprogress=function(){e._onXHRProgress()}),d.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{d.send(a)}catch(t){return void i.nextTick(function(){e.emit("error",t)})}}}},f.prototype._onXHRProgress=function(){(function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},f.prototype._connect=function(){var e=this;e._destroyed||(e._response=new l(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",function(t){e.emit("error",t)}),e.emit("response",e._response))},f.prototype._write=function(e,t,n){this._body.push(e),n()},f.prototype.abort=f.prototype.destroy=function(){this._destroyed=!0,r.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},f.prototype.end=function(e,t,n){"function"==typeof e&&(n=e,e=void 0),u.Writable.prototype.end.call(this,e,t,n)},f.prototype.flushHeaders=function(){},f.prototype.setTimeout=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,n(1).Buffer,n(10),n(4))},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,n){(function(e,r){var i;!function(r){var o,s=2147483647,a=36,u=1,c=26,l=38,h=700,f=72,d=128,p="-",g=/^xn--/,v=/[^\x20-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=a-u,b=Math.floor,w=String.fromCharCode;function E(e){throw new RangeError(y[e])}function k(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function T(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+k((e=e.replace(m,".")).split("."),t).join(".")}function S(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function C(e){return k(e,function(e){var t="";return e>65535&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+w(e)}).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function A(e,t,n){var r=0;for(e=n?b(e/h):e>>1,e+=b(e/t);e>_*c>>1;r+=a)e=b(e/_);return b(r+(_+1)*e/(e+l))}function I(e){var t,n,r,i,o,l,h,g,v,m,y,_=[],w=e.length,k=0,T=d,S=f;for((n=e.lastIndexOf(p))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&E("not-basic"),_.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<w;){for(o=k,l=1,h=a;i>=w&&E("invalid-input"),((g=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:a)>=a||g>b((s-k)/l))&&E("overflow"),k+=g*l,!(g<(v=h<=S?u:h>=S+c?c:h-S));h+=a)l>b(s/(m=a-v))&&E("overflow"),l*=m;S=A(k-o,t=_.length+1,0==o),b(k/t)>s-T&&E("overflow"),T+=b(k/t),k%=t,_.splice(k++,0,T)}return C(_)}function O(e){var t,n,r,i,o,l,h,g,v,m,y,_,k,T,C,I=[];for(_=(e=S(e)).length,t=d,n=0,o=f,l=0;l<_;++l)(y=e[l])<128&&I.push(w(y));for(r=i=I.length,i&&I.push(p);r<_;){for(h=s,l=0;l<_;++l)(y=e[l])>=t&&y<h&&(h=y);for(h-t>b((s-n)/(k=r+1))&&E("overflow"),n+=(h-t)*k,t=h,l=0;l<_;++l)if((y=e[l])<t&&++n>s&&E("overflow"),y==t){for(g=n,v=a;!(g<(m=v<=o?u:v>=o+c?c:v-o));v+=a)I.push(w(x(m+(C=g-m)%(T=a-m),0))),g=b(C/T);I.push(w(x(g,0))),o=A(n,k,r==i),n=0,++r}++n,++t}return I.join("")}o={version:"1.4.1",ucs2:{decode:S,encode:C},decode:I,encode:O,toASCII:function(e){return T(e,function(e){return v.test(e)?"xn--"+O(e):e})},toUnicode:function(e){return T(e,function(e){return g.test(e)?I(e.slice(4).toLowerCase()):e})}},void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(351)(e),n(10))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t=t||"&");var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,d,p,g=e[l].replace(a,"%20"),v=g.indexOf(n);v>=0?(h=g.substr(0,v),f=g.substr(v+1)):(h=g,f=""),d=decodeURIComponent(h),p=decodeURIComponent(f),r(s,d)?i(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(s(e),function(s){var a=encodeURIComponent(r(s))+n;return i(e[s])?o(e[s],function(e){return a+encodeURIComponent(r(e))}).join(t):a+encodeURIComponent(r(e[s]))}).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){var r=n(150),i=n(70),o=e.exports;for(var s in r)r.hasOwnProperty(s)&&(o[s]=r[s]);function a(e){if("string"==typeof e&&(e=i.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}o.request=function(e,t){return e=a(e),r.request.call(this,e,t)},o.get=function(e,t){return e=a(e),r.get.call(this,e,t)}},function(e,t){},function(e,t,n){(function(t){e.exports=o,e.exports.decode=o,e.exports.encode=function(e){(e=Object.assign({},e)).infoHashBuffer&&(e.xt=`urn:btih:${e.infoHashBuffer.toString("hex")}`),e.infoHash&&(e.xt=`urn:btih:${e.infoHash}`),e.name&&(e.dn=e.name),e.keywords&&(e.kt=e.keywords),e.announce&&(e.tr=e.announce),e.urlList&&(e.ws=e.urlList,delete e.as);let t="magnet:?";return Object.keys(e).filter(e=>2===e.length).forEach((n,r)=>{(Array.isArray(e[n])?e[n]:[e[n]]).forEach((e,i)=>{!(r>0||i>0)||"kt"===n&&0!==i||(t+="&"),"dn"===n&&(e=encodeURIComponent(e).replace(/%20/g,"+")),"tr"!==n&&"xs"!==n&&"as"!==n&&"ws"!==n||(e=encodeURIComponent(e)),"kt"===n&&(e=encodeURIComponent(e)),t+="kt"===n&&i>0?`+${e}`:`${n}=${e}`})}),t};const r=n(358),i=n(71);function o(e){const n={},o=e.split("magnet:?")[1];let s;return(o&&o.length>=0?o.split("&"):[]).forEach(e=>{const t=e.split("=");if(2!==t.length)return;const r=t[0];let i=t[1];"dn"===r&&(i=decodeURIComponent(i).replace(/\+/g," ")),"tr"!==r&&"xs"!==r&&"as"!==r&&"ws"!==r||(i=decodeURIComponent(i)),"kt"===r&&(i=decodeURIComponent(i).split("+")),"ix"===r&&(i=Number(i)),n[r]?Array.isArray(n[r])?n[r].push(i):n[r]=[n[r],i]:n[r]=i}),n.xt&&(Array.isArray(n.xt)?n.xt:[n.xt]).forEach(e=>{if(s=e.match(/^urn:btih:(.{40})/))n.infoHash=s[1].toLowerCase();else if(s=e.match(/^urn:btih:(.{32})/)){const e=r.decode(s[1]);n.infoHash=t.from(e,"binary").toString("hex")}}),n.infoHash&&(n.infoHashBuffer=t.from(n.infoHash,"hex")),n.dn&&(n.name=n.dn),n.kt&&(n.keywords=n.kt),n.announce="string"==typeof n.tr?[n.tr]:Array.isArray(n.tr)?n.tr:[],n.urlList=[],("string"==typeof n.as||Array.isArray(n.as))&&(n.urlList=n.urlList.concat(n.as)),("string"==typeof n.ws||Array.isArray(n.ws))&&(n.urlList=n.urlList.concat(n.ws)),i(n.announce),i(n.urlList),n}}).call(this,n(1).Buffer)},function(e,t,n){var r=n(359);t.encode=r.encode,t.decode=r.decode},function(e,t,n){"use strict";(function(e){var n=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];t.encode=function(t){e.isBuffer(t)||(t=new e(t));for(var n,r,i=0,o=0,s=0,a=0,u=new e(8*(n=t,r=Math.floor(n.length/5),n.length%5==0?r:r+1));i<t.length;){var c=t[i];s>3?(a=(a=c&255>>s)<<(s=(s+5)%8)|(i+1<t.length?t[i+1]:0)>>8-s,i++):(a=c>>8-(s+5)&31,0==(s=(s+5)%8)&&i++),u[o]="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".charCodeAt(a),o++}for(i=o;i<u.length;i++)u[i]=61;return u},t.decode=function(t){var r,i=0,o=0,s=0;e.isBuffer(t)||(t=new e(t));for(var a=new e(Math.ceil(5*t.length/8)),u=0;u<t.length&&61!==t[u];u++){var c=t[u]-48;if(!(c<n.length))throw new Error("Invalid input - it is not base32 encoded string");o=n[c],i<=3?0==(i=(i+5)%8)?(a[s]=r|=o,s++,r=0):r|=255&o<<8-i:(a[s]=r|=255&o>>>(i=(i+5)%8),s++,r=255&o<<8-i)}return a.slice(0,s)}}).call(this,n(1).Buffer)},function(e,t){e.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}},function(e,t){},function(e,t,n){(function(t,r){const i=n(363),o=n(72),s=n(364),a=n(16)("webtorrent:torrent"),u=n(365),c=n(18).EventEmitter,l=n(68),h=n(376),f=n(95),d=n(377),p=n(148),g=n(378),v=n(379),m=n(53),y=n(380),_=n(149),b=n(33),w=n(381),E=n(156),k=n(383),T=n(54),S=n(97),C=n(71),x=n(384),A=n(385),I=n(386),O=n(387),P=n(404),R=n(406),j=n(407),M=3*w.BLOCK_LENGTH,L=t.browser?1/0:2,B=[1e3,5e3,15e3],N=`WebTorrent/${n(100).version} (https://webtorrent.io)`;let U;try{U=b.join(l.statSync("/tmp")&&"/tmp","webtorrent")}catch(e){U=b.join("function"==typeof v.tmpdir?v.tmpdir():"/","webtorrent")}function D(e,t){return 2+Math.ceil(t*e.downloadSpeed()/w.BLOCK_LENGTH)}function F(){}e.exports=class extends c{constructor(e,t,n){super(),this._debugId="unknown infohash",this.client=t,this.announce=n.announce,this.urlList=n.urlList,this.path=n.path,this.skipVerify=!!n.skipVerify,this._store=n.store||h,this._getAnnounceOpts=n.getAnnounceOpts,this.strategy=n.strategy||"sequential",this.maxWebConns=n.maxWebConns||4,this._rechokeNumSlots=!1===n.uploads||0===n.uploads?0:+n.uploads||10,this._rechokeOptimisticWire=null,this._rechokeOptimisticTime=0,this._rechokeIntervalId=null,this.ready=!1,this.destroyed=!1,this.paused=!1,this.done=!1,this.metadata=null,this.store=null,this.files=[],this.pieces=[],this._amInterested=!1,this._selections=[],this._critical=[],this.wires=[],this._queue=[],this._peers={},this._peersLength=0,this.received=0,this.uploaded=0,this._downloadSpeed=S(),this._uploadSpeed=S(),this._servers=[],this._xsRequests=[],this._fileModtimes=n.fileModtimes,null!==e&&this._onTorrentId(e),this._debug("new torrent")}get timeRemaining(){return this.done?0:0===this.downloadSpeed?1/0:(this.length-this.downloaded)/this.downloadSpeed*1e3}get downloaded(){if(!this.bitfield)return 0;let e=0;for(let t=0,n=this.pieces.length;t<n;++t)if(this.bitfield.get(t))e+=t===n-1?this.lastPieceLength:this.pieceLength;else{const n=this.pieces[t];e+=n.length-n.missing}return e}get downloadSpeed(){return this._downloadSpeed()}get uploadSpeed(){return this._uploadSpeed()}get progress(){return this.length?this.downloaded/this.length:0}get ratio(){return this.uploaded/(this.received||1)}get numPeers(){return this.wires.length}get torrentFileBlobURL(){if("undefined"==typeof window)throw new Error("browser-only property");return this.torrentFile?URL.createObjectURL(new Blob([this.torrentFile],{type:"application/x-bittorrent"})):null}get _numQueued(){return this._queue.length+(this._peersLength-this._numConns)}get _numConns(){let e=0;for(const t in this._peers)this._peers[t].connected&&(e+=1);return e}get swarm(){return console.warn("WebTorrent: `torrent.swarm` is deprecated. Use `torrent` directly instead."),this}_onTorrentId(e){if(this.destroyed)return;let n;try{n=_(e)}catch(e){}n?(this.infoHash=n.infoHash,this._debugId=n.infoHash.toString("hex").substring(0,7),t.nextTick(()=>{this.destroyed||this._onParsedTorrent(n)})):_.remote(e,(e,t)=>{if(!this.destroyed)return e?this._destroy(e):void this._onParsedTorrent(t)})}_onParsedTorrent(e){if(!this.destroyed){if(this._processParsedTorrent(e),!this.infoHash)return this._destroy(new Error("Malformed torrent data: No info hash"));this.path||(this.path=b.join(U,this.infoHash)),this._rechokeIntervalId=setInterval(()=>{this._rechoke()},1e4),this._rechokeIntervalId.unref&&this._rechokeIntervalId.unref(),this.emit("_infoHash",this.infoHash),this.destroyed||(this.emit("infoHash",this.infoHash),this.destroyed||(this.client.listening?this._onListening():this.client.once("listening",()=>{this._onListening()})))}}_processParsedTorrent(e){this._debugId=e.infoHash.toString("hex").substring(0,7),this.announce&&(e.announce=e.announce.concat(this.announce)),this.client.tracker&&r.WEBTORRENT_ANNOUNCE&&!this.private&&(e.announce=e.announce.concat(r.WEBTORRENT_ANNOUNCE)),this.urlList&&(e.urlList=e.urlList.concat(this.urlList)),C(e.announce),C(e.urlList),Object.assign(this,e),this.magnetURI=_.toMagnetURI(e),this.torrentFile=_.toTorrentFile(e)}_onListening(){if(this.discovery||this.destroyed)return;let e=this.client.tracker;e&&(e=Object.assign({},this.client.tracker,{getAnnounceOpts:()=>{const e={uploaded:this.uploaded,downloaded:this.downloaded,left:Math.max(this.length-this.downloaded,0)};return this.client.tracker.getAnnounceOpts&&Object.assign(e,this.client.tracker.getAnnounceOpts()),this._getAnnounceOpts&&Object.assign(e,this._getAnnounceOpts()),e}})),this.discovery=new u({infoHash:this.infoHash,announce:this.announce,peerId:this.client.peerId,dht:!this.private&&this.client.dht,tracker:e,port:this.client.torrentPort,userAgent:N}),this.discovery.on("error",e=>{this._destroy(e)}),this.discovery.on("peer",e=>{"string"==typeof e&&this.done||this.addPeer(e)}),this.discovery.on("trackerAnnounce",()=>{this.emit("trackerAnnounce"),0===this.numPeers&&this.emit("noPeers","tracker")}),this.discovery.on("dhtAnnounce",()=>{this.emit("dhtAnnounce"),0===this.numPeers&&this.emit("noPeers","dht")}),this.discovery.on("warning",e=>{this.emit("warning",e)}),this.info?this._onMetadata(this):this.xs&&this._getMetadataFromServer()}_getMetadataFromServer(){const e=this,t=(Array.isArray(this.xs)?this.xs:[this.xs]).map(t=>n=>{!function(t,n){if(0!==t.indexOf("http://")&&0!==t.indexOf("https://"))return e.emit("warning",new Error(`skipping non-http xs param: ${t}`)),n(null);const r={url:t,method:"GET",headers:{"user-agent":N}};let i;try{i=f.concat(r,function(r,i,o){if(e.destroyed)return n(null);if(e.metadata)return n(null);if(r)return e.emit("warning",new Error(`http error from xs param: ${t}`)),n(null);if(200!==i.statusCode)return e.emit("warning",new Error(`non-200 status code ${i.statusCode} from xs param: ${t}`)),n(null);let s;try{s=_(o)}catch(r){}return s?s.infoHash!==e.infoHash?(e.emit("warning",new Error(`got torrent file with incorrect info hash from xs param: ${t}`)),n(null)):(e._onMetadata(s),void n(null)):(e.emit("warning",new Error(`got invalid torrent file from xs param: ${t}`)),n(null))})}catch(r){return e.emit("warning",new Error(`skipping invalid url xs param: ${t}`)),n(null)}e._xsRequests.push(i)}(t,n)});m(t)}_onMetadata(e){if(this.metadata||this.destroyed)return;let t;if(this._debug("got metadata"),this._xsRequests.forEach(e=>{e.abort()}),this._xsRequests=[],e&&e.infoHash)t=e;else try{t=_(e)}catch(e){return this._destroy(e)}if(this._processParsedTorrent(t),this.metadata=this.torrentFile,this.client.enableWebSeeds&&this.urlList.forEach(e=>{this.addWebSeed(e)}),this._rarityMap=new R(this),this.store=new d(new this._store(this.pieceLength,{torrent:{infoHash:this.infoHash},files:this.files.map(e=>({path:b.join(this.path,e.path),length:e.length,offset:e.offset})),length:this.length,name:this.infoHash})),this.files=this.files.map(e=>new O(this,e)),this.so){const e=I.parse(this.so);this.files.forEach((t,n)=>{e.includes(n)&&this.files[n].select(!0)})}else 0!==this.pieces.length&&this.select(0,this.pieces.length-1,!1);this._hashes=this.pieces,this.pieces=this.pieces.map((e,t)=>new w(t===this.pieces.length-1?this.lastPieceLength:this.pieceLength)),this._reservations=this.pieces.map(()=>[]),this.bitfield=new o(this.pieces.length),this.wires.forEach(e=>{e.ut_metadata&&e.ut_metadata.setMetadata(this.metadata),this._onWireWithMetadata(e)}),this.skipVerify?(this._markAllVerified(),this._onStore()):(this._debug("verifying existing torrent data"),this._fileModtimes&&this._store===h?this.getFileModtimes((e,t)=>{if(e)return this._destroy(e);this.files.map((e,n)=>t[n]===this._fileModtimes[n]).every(e=>e)?(this._markAllVerified(),this._onStore()):this._verifyPieces()}):this._verifyPieces()),this.emit("metadata")}getFileModtimes(e){const t=[];y(this.files.map((e,n)=>r=>{l.stat(b.join(this.path,e.path),(e,i)=>{if(e&&"ENOENT"!==e.code)return r(e);t[n]=i&&i.mtime.getTime(),r(null)})}),L,n=>{this._debug("done getting file modtimes"),e(n,t)})}_verifyPieces(){y(this.pieces.map((e,n)=>e=>{if(this.destroyed)return e(new Error("torrent is destroyed"));this.store.get(n,(r,i)=>this.destroyed?e(new Error("torrent is destroyed")):r?t.nextTick(e,null):void T(i,t=>{if(this.destroyed)return e(new Error("torrent is destroyed"));if(t===this._hashes[n]){if(!this.pieces[n])return;this._debug("piece verified %s",n),this._markVerified(n)}else this._debug("piece invalid %s",n);e(null)}))}),L,e=>{if(e)return this._destroy(e);this._debug("done verifying"),this._onStore()})}_markAllVerified(){for(let e=0;e<this.pieces.length;e++)this._markVerified(e)}_markVerified(e){this.pieces[e]=null,this._reservations[e]=null,this.bitfield.set(e,!0)}_onStore(){this.destroyed||(this._debug("on store"),this.ready=!0,this.emit("ready"),this._checkDone(),this._updateSelections())}destroy(e){this._destroy(null,e)}_destroy(e,t){if(this.destroyed)return;this.destroyed=!0,this._debug("destroy"),this.client._remove(this),clearInterval(this._rechokeIntervalId),this._xsRequests.forEach(e=>{e.abort()}),this._rarityMap&&this._rarityMap.destroy();for(const e in this._peers)this.removePeer(e);this.files.forEach(e=>{e instanceof O&&e._destroy()});const n=this._servers.map(e=>t=>{e.destroy(t)});this.discovery&&n.push(e=>{this.discovery.destroy(e)}),this.store&&n.push(e=>{this.store.close(e)}),m(n,t),e&&(0===this.listenerCount("error")?this.client.emit("error",e):this.emit("error",e)),this.emit("close"),this.client=null,this.files=[],this.discovery=null,this.store=null,this._rarityMap=null,this._peers=null,this._servers=null,this._xsRequests=null}addPeer(e){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.infoHash)throw new Error("addPeer() must not be called before the `infoHash` event");if(this.client.blocked){let t;if("string"==typeof e){let n;try{n=i(e)}catch(t){return this._debug("ignoring peer: invalid %s",e),this.emit("invalidPeer",e),!1}t=n[0]}else"string"==typeof e.remoteAddress&&(t=e.remoteAddress);if(t&&this.client.blocked.contains(t))return this._debug("ignoring peer: blocked %s",e),"string"!=typeof e&&e.destroy(),this.emit("blockedPeer",e),!1}const t=!!this._addPeer(e);return this.emit(t?"peer":"invalidPeer",e),t}_addPeer(e){if(this.destroyed)return"string"!=typeof e&&e.destroy(),null;if("string"==typeof e&&!this._validAddr(e))return this._debug("ignoring peer: invalid %s",e),null;const t=e&&e.id||e;if(this._peers[t])return this._debug("ignoring peer: duplicate (%s)",t),"string"!=typeof e&&e.destroy(),null;if(this.paused)return this._debug("ignoring peer: torrent is paused"),"string"!=typeof e&&e.destroy(),null;let n;return this._debug("add peer %s",t),n="string"==typeof e?P.createTCPOutgoingPeer(e,this):P.createWebRTCPeer(e,this),this._peers[n.id]=n,this._peersLength+=1,"string"==typeof e&&(this._queue.push(n),this._drain()),n}addWebSeed(e){if(this.destroyed)throw new Error("torrent is destroyed");if(!/^https?:\/\/.+/.test(e))return this.emit("warning",new Error(`ignoring invalid web seed: ${e}`)),void this.emit("invalidPeer",e);if(this._peers[e])return this.emit("warning",new Error(`ignoring duplicate web seed: ${e}`)),void this.emit("invalidPeer",e);this._debug("add web seed %s",e);const t=P.createWebSeedPeer(e,this);this._peers[t.id]=t,this._peersLength+=1,this.emit("peer",e)}_addIncomingPeer(e){return this.destroyed?e.destroy(new Error("torrent is destroyed")):this.paused?e.destroy(new Error("torrent is paused")):(this._debug("add incoming peer %s",e.id),this._peers[e.id]=e,void(this._peersLength+=1))}removePeer(e){const t=e&&e.id||e;(e=this._peers[t])&&(this._debug("removePeer %s",t),delete this._peers[t],this._peersLength-=1,e.destroy(),this._drain())}select(e,t,n,r){if(this.destroyed)throw new Error("torrent is destroyed");if(e<0||t<e||this.pieces.length<=t)throw new Error("invalid selection ",e,":",t);n=Number(n)||0,this._debug("select %s-%s (priority %s)",e,t,n),this._selections.push({from:e,to:t,offset:0,priority:n,notify:r||F}),this._selections.sort((e,t)=>t.priority-e.priority),this._updateSelections()}deselect(e,t,n){if(this.destroyed)throw new Error("torrent is destroyed");n=Number(n)||0,this._debug("deselect %s-%s (priority %s)",e,t,n);for(let r=0;r<this._selections.length;++r){const i=this._selections[r];if(i.from===e&&i.to===t&&i.priority===n){this._selections.splice(r,1);break}}this._updateSelections()}critical(e,t){if(this.destroyed)throw new Error("torrent is destroyed");this._debug("critical %s-%s",e,t);for(let n=e;n<=t;++n)this._critical[n]=!0;this._updateSelections()}_onWire(e,n){if(this._debug("got wire %s (%s)",e._debugId,n||"Unknown"),e.on("download",e=>{this.destroyed||(this.received+=e,this._downloadSpeed(e),this.client._downloadSpeed(e),this.emit("download",e),this.client.emit("download",e))}),e.on("upload",e=>{this.destroyed||(this.uploaded+=e,this._uploadSpeed(e),this.client._uploadSpeed(e),this.emit("upload",e),this.client.emit("upload",e))}),this.wires.push(e),n){const t=i(n);e.remoteAddress=t[0],e.remotePort=t[1]}this.client.dht&&this.client.dht.listening&&e.on("port",t=>{if(!this.destroyed&&!this.client.dht.destroyed){if(!e.remoteAddress)return this._debug("ignoring PORT from peer with no address");if(0===t||t>65536)return this._debug("ignoring invalid PORT from peer");this._debug("port: %s (from %s)",t,n),this.client.dht.addNode({host:e.remoteAddress,port:t})}}),e.on("timeout",()=>{this._debug("wire timeout (%s)",n),e.destroy()}),e.setTimeout(3e4,!0),e.setKeepAlive(!0),e.use(x(this.metadata)),e.ut_metadata.on("warning",e=>{this._debug("ut_metadata warning: %s",e.message)}),this.metadata||(e.ut_metadata.on("metadata",e=>{this._debug("got metadata via ut_metadata"),this._onMetadata(e)}),e.ut_metadata.fetch()),"function"!=typeof A||this.private||(e.use(A()),e.ut_pex.on("peer",e=>{this.done||(this._debug("ut_pex: got peer: %s (from %s)",e,n),this.addPeer(e))}),e.ut_pex.on("dropped",e=>{const t=this._peers[e];t&&!t.connected&&(this._debug("ut_pex: dropped peer: %s (from %s)",e,n),this.removePeer(e))}),e.once("close",()=>{e.ut_pex.reset()})),this.emit("wire",e,n),this.metadata&&t.nextTick(()=>{this._onWireWithMetadata(e)})}_onWireWithMetadata(e){let t=null;const n=()=>{this.destroyed||e.destroyed||(this._numQueued>2*(this._numConns-this.numPeers)&&e.amInterested?e.destroy():(t=setTimeout(n,5e3)).unref&&t.unref())};let r;const i=()=>{if(e.peerPieces.buffer.length===this.bitfield.buffer.length){for(r=0;r<this.pieces.length;++r)if(!e.peerPieces.get(r))return;e.isSeeder=!0,e.choke()}};e.on("bitfield",()=>{i(),this._update()}),e.on("have",()=>{i(),this._update()}),e.once("interested",()=>{e.unchoke()}),e.once("close",()=>{clearTimeout(t)}),e.on("choke",()=>{clearTimeout(t),(t=setTimeout(n,5e3)).unref&&t.unref()}),e.on("unchoke",()=>{clearTimeout(t),this._update()}),e.on("request",(t,n,r,i)=>{if(r>131072)return e.destroy();this.pieces[t]||this.store.get(t,{offset:n,length:r},i)}),e.bitfield(this.bitfield),e.uninterested(),e.peerExtensions.dht&&this.client.dht&&this.client.dht.listening&&e.port(this.client.dht.address().port),"webSeed"!==e.type&&(t=setTimeout(n,5e3)).unref&&t.unref(),e.isSeeder=!1,i()}_updateSelections(){this.ready&&!this.destroyed&&(t.nextTick(()=>{this._gcSelections()}),this._updateInterest(),this._update())}_gcSelections(){for(let e=0;e<this._selections.length;++e){const t=this._selections[e],n=t.offset;for(;this.bitfield.get(t.from+t.offset)&&t.from+t.offset<t.to;)t.offset+=1;n!==t.offset&&t.notify(),t.to===t.from+t.offset&&this.bitfield.get(t.from+t.offset)&&(this._selections.splice(e,1),e-=1,t.notify(),this._updateInterest())}this._selections.length||this.emit("idle")}_updateInterest(){const e=this._amInterested;this._amInterested=!!this._selections.length,this.wires.forEach(e=>{let t=!1;for(let n=0;n<this.pieces.length;++n)if(this.pieces[n]&&e.peerPieces.get(n)){t=!0;break}t?e.interested():e.uninterested()}),e!==this._amInterested&&this.emit(this._amInterested?"interested":"uninterested")}_update(){if(this.destroyed)return;const e=k(this.wires);let t;for(;t=e();)this._updateWireWrapper(t)}_updateWireWrapper(e){const t=this;"undefined"!=typeof window&&"function"==typeof window.requestIdleCallback?window.requestIdleCallback(function(){t._updateWire(e)}):t._updateWire(e)}_updateWire(e){const t=this;if(e.peerChoking)return;if(!e.downloaded)return function(){if(e.requests.length)return;let n=t._selections.length;for(;n--;){const r=t._selections[n];let o;if("rarest"===t.strategy){const n=r.from+r.offset,s=r.to,a=s-n+1,u={};let c=0;const l=i(n,s,u);for(;c<a&&!((o=t._rarityMap.getRarestPiece(l))<0);){if(t._request(e,o,!1))return;u[o]=!0,c+=1}}else for(o=r.to;o>=r.from+r.offset;--o)if(e.peerPieces.get(o)&&t._request(e,o,!1))return}}();const n=D(e,.5);if(e.requests.length>=n)return;const r=D(e,1);function i(t,n,r,i){return o=>o>=t&&o<=n&&!(o in r)&&e.peerPieces.get(o)&&(!i||i(o))}function o(e){let n=e;for(let r=e;r<t._selections.length&&t._selections[r].priority;r++)n=r;const r=t._selections[e];t._selections[e]=t._selections[n],t._selections[n]=r}function s(n){if(e.requests.length>=r)return!0;const s=function(){const n=e.downloadSpeed()||1;if(n>M)return()=>!0;const r=Math.max(1,e.requests.length)*w.BLOCK_LENGTH/n;let i=10,o=0;return e=>{if(!i||t.bitfield.get(e))return!0;let s=t.pieces[e].missing;for(;o<t.wires.length;o++){const a=t.wires[o],u=a.downloadSpeed();if(!(u<M)&&!(u<=n)&&a.peerPieces.get(e)&&!((s-=u*r)>0))return i--,!1}return!0}}();for(let a=0;a<t._selections.length;a++){const u=t._selections[a];let c;if("rarest"===t.strategy){const l=u.from+u.offset,h=u.to,f=h-l+1,d={};let p=0;const g=i(l,h,d,s);for(;p<f&&!((c=t._rarityMap.getRarestPiece(g))<0);){for(;t._request(e,c,t._critical[c]||n););if(!(e.requests.length<r))return u.priority&&o(a),!0;d[c]=!0,p++}}else for(c=u.from+u.offset;c<=u.to;c++)if(e.peerPieces.get(c)&&s(c)){for(;t._request(e,c,t._critical[c]||n););if(!(e.requests.length<r))return u.priority&&o(a),!0}}return!1}s(!1)||s(!0)}_rechoke(){if(!this.ready)return;this._rechokeOptimisticTime>0?this._rechokeOptimisticTime-=1:this._rechokeOptimisticWire=null;const e=[];this.wires.forEach(t=>{t.isSeeder||t===this._rechokeOptimisticWire||e.push({wire:t,downloadSpeed:t.downloadSpeed(),uploadSpeed:t.uploadSpeed(),salt:Math.random(),isChoked:!0})}),e.sort(function(e,t){return e.downloadSpeed!==t.downloadSpeed?t.downloadSpeed-e.downloadSpeed:e.uploadSpeed!==t.uploadSpeed?t.uploadSpeed-e.uploadSpeed:e.wire.amChoking!==t.wire.amChoking?e.wire.amChoking?1:-1:e.salt-t.salt});let t=0,n=0;for(;n<e.length&&t<this._rechokeNumSlots;++n)e[n].isChoked=!1,e[n].wire.peerInterested&&(t+=1);if(!this._rechokeOptimisticWire&&n<e.length&&this._rechokeNumSlots){const t=e.slice(n).filter(e=>e.wire.peerInterested),i=t[(r=t.length,Math.random()*r|0)];i&&(i.isChoked=!1,this._rechokeOptimisticWire=i.wire,this._rechokeOptimisticTime=2)}var r;e.forEach(e=>{e.wire.amChoking!==e.isChoked&&(e.isChoked?e.wire.choke():e.wire.unchoke())})}_hotswap(e,t){const n=e.downloadSpeed();if(n<w.BLOCK_LENGTH)return!1;if(!this._reservations[t])return!1;const r=this._reservations[t];if(!r)return!1;let i,o,s=1/0;for(o=0;o<r.length;o++){const t=r[o];if(!t||t===e)continue;const a=t.downloadSpeed();a>=M||2*a>n||a>s||(i=t,s=a)}if(!i)return!1;for(o=0;o<r.length;o++)r[o]===i&&(r[o]=null);for(o=0;o<i.requests.length;o++){const e=i.requests[o];e.piece===t&&this.pieces[t].cancel(e.offset/w.BLOCK_LENGTH|0)}return this.emit("hotswap",i,e,t),!0}_request(e,n,r){const i=this,o=e.requests.length,s="webSeed"===e.type;if(i.bitfield.get(n))return!1;if(o>=(s?Math.min(function(e,t,n){return 1+Math.ceil(1*e.downloadSpeed()/n)}(e,0,i.pieceLength),i.maxWebConns):D(e,1)))return!1;const a=i.pieces[n];let u=s?a.reserveRemaining():a.reserve();if(-1===u&&r&&i._hotswap(e,n)&&(u=s?a.reserveRemaining():a.reserve()),-1===u)return!1;let c=i._reservations[n];c||(c=i._reservations[n]=[]);let l=c.indexOf(null);-1===l&&(l=c.length),c[l]=e;const h=a.chunkOffset(u),f=s?a.chunkLengthRemaining(u):a.chunkLength(u);function d(){t.nextTick(()=>{i._update()})}return e.request(n,h,f,function t(r,o){if(i.destroyed)return;if(!i.ready)return i.once("ready",()=>{t(r,o)});if(c[l]===e&&(c[l]=null),a!==i.pieces[n])return d();if(r)return i._debug("error getting piece %s (offset: %s length: %s) from %s: %s",n,h,f,`${e.remoteAddress}:${e.remotePort}`,r.message),s?a.cancelRemaining(u):a.cancel(u),void d();if(i._debug("got piece %s (offset: %s length: %s) from %s",n,h,f,`${e.remoteAddress}:${e.remotePort}`),!a.set(u,o,e))return d();const p=a.flush();T(p,e=>{if(!i.destroyed){if(e===i._hashes[n]){if(!i.pieces[n])return;i._debug("piece verified %s",n),i.pieces[n]=null,i._reservations[n]=null,i.bitfield.set(n,!0),i.store.put(n,p),i.wires.forEach(e=>{e.have(n)}),i._checkDone()&&!i.destroyed&&i.discovery.complete()}else i.pieces[n]=new w(a.length),i.emit("warning",new Error(`Piece ${n} failed verification`));d()}})}),!0}_checkDone(){if(this.destroyed)return;this.files.forEach(e=>{if(!e.done){for(let t=e._startPiece;t<=e._endPiece;++t)if(!this.bitfield.get(t))return;e.done=!0,e.emit("done"),this._debug(`file done: ${e.name}`)}});let e=!0;for(let t=0;t<this._selections.length;t++){const n=this._selections[t];for(let t=n.from;t<=n.to;t++)if(!this.bitfield.get(t)){e=!1;break}if(!e)break}return!this.done&&e&&(this.done=!0,this._debug(`torrent done: ${this.infoHash}`),this.emit("done")),this._gcSelections(),e}load(e,t){if(this.destroyed)throw new Error("torrent is destroyed");if(!this.ready)return this.once("ready",()=>{this.load(e,t)});Array.isArray(e)||(e=[e]),t||(t=F);const n=new p(e),r=new s(this.store,this.pieceLength);E(n,r,e=>{if(e)return t(e);this._markAllVerified(),this._checkDone(),t(null)})}createServer(e){if("function"!=typeof j)throw new Error("node.js-only method");if(this.destroyed)throw new Error("torrent is destroyed");const t=new j(this,e);return this._servers.push(t),t}pause(){this.destroyed||(this._debug("pause"),this.paused=!0)}resume(){this.destroyed||(this._debug("resume"),this.paused=!1,this._drain())}_debug(){const e=[].slice.call(arguments);e[0]=`[${this.client._debugId}] [${this._debugId}] ${e[0]}`,a(...e)}_drain(){if(this._debug("_drain numConns %s maxConns %s",this._numConns,this.client.maxConns),"function"!=typeof g.connect||this.destroyed||this.paused||this._numConns>=this.client.maxConns)return;this._debug("drain (%s queued, %s/%s peers)",this._numQueued,this.numPeers,this.client.maxConns);const e=this._queue.shift();if(!e)return;this._debug("tcp connect attempt to %s",e.addr);const t=i(e.addr),n=e.conn=g.connect({host:t[0],port:t[1]});n.once("connect",()=>{e.onConnect()}),n.once("error",t=>{e.destroy(t)}),e.startConnectTimeout(),n.on("close",()=>{if(this.destroyed)return;if(e.retries>=B.length)return void this._debug("conn %s closed: will not re-add (max %s attempts)",e.addr,B.length);const t=B[e.retries];this._debug("conn %s closed: will re-add to queue in %sms (attempt %s)",e.addr,t,e.retries+1);const n=setTimeout(()=>{const t=this._addPeer(e.addr);t&&(t.retries=e.retries+1)},t);n.unref&&n.unref()})}_validAddr(e){let t;try{t=i(e)}catch(e){return!1}const n=t[1];return n>0&&n<65535&&!("127.0.0.1"===t[0]&&n===this.client.torrentPort)}}}).call(this,n(4),n(10))},function(e,t){const n=/^\[?([^\]]+)\]?:(\d+)$/;let r={},i=0;e.exports=function(t){if(1e5===i&&e.exports.reset(),!r[t]){const e=n.exec(t);if(!e)throw new Error(`invalid addr: ${t}`);r[t]=[e[1],Number(e[2])],i+=1}return r[t]},e.exports.reset=function(){r={},i=0}},function(e,t,n){const r=n(141),i=n(11);e.exports=class extends i.Writable{constructor(e,t,n={}){if(super(n),!e||!e.put||!e.get)throw new Error("First argument must be an abstract-chunk-store compliant store");if(!(t=Number(t)))throw new Error("Second argument must be a chunk length");this._blockstream=new r(t,{zeroPadding:!1});let i=0;this._blockstream.on("data",t=>{this.destroyed||(e.put(i,t),i+=1)}).on("error",e=>{this.destroy(e)}),this.on("finish",()=>this._blockstream.end())}_write(e,t,n){this._blockstream.write(e,t,n)}destroy(e){this.destroyed||(this.destroyed=!0,e&&this.emit("error",e),this.emit("close"))}}},function(e,t,n){(function(t){const r=n(16)("torrent-discovery"),i=n(366),o=n(18).EventEmitter,s=n(53),a=n(367);e.exports=class extends o{constructor(e){if(super(),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!t.browser&&!e.port)throw new Error("Option `port` is required");this.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),this.infoHash="string"==typeof e.infoHash?e.infoHash.toLowerCase():e.infoHash.toString("hex"),this._port=e.port,this._userAgent=e.userAgent,this.destroyed=!1,this._announce=e.announce||[],this._intervalMs=e.intervalMs||9e5,this._trackerOpts=null,this._dhtAnnouncing=!1,this._dhtTimeout=!1,this._internalDHT=!1,this._onWarning=(e=>{this.emit("warning",e)}),this._onError=(e=>{this.emit("error",e)}),this._onDHTPeer=((e,t)=>{t.toString("hex")===this.infoHash&&this.emit("peer",`${e.host}:${e.port}`,"dht")}),this._onTrackerPeer=(e=>{this.emit("peer",e,"tracker")}),this._onTrackerAnnounce=(()=>{this.emit("trackerAnnounce")});const n=(e,t)=>{const n=new i(t);return n.on("warning",this._onWarning),n.on("error",this._onError),n.listen(e),this._internalDHT=!0,n};!1===e.tracker?this.tracker=null:e.tracker&&"object"==typeof e.tracker?(this._trackerOpts=Object.assign({},e.tracker),this.tracker=this._createTracker()):this.tracker=this._createTracker(),this.dht=!1===e.dht||"function"!=typeof i?null:e.dht&&"function"==typeof e.dht.addNode?e.dht:e.dht&&"object"==typeof e.dht?n(e.dhtPort,e.dht):n(e.dhtPort),this.dht&&(this.dht.on("peer",this._onDHTPeer),this._dhtAnnounce())}updatePort(e){e!==this._port&&(this._port=e,this.dht&&this._dhtAnnounce(),this.tracker&&(this.tracker.stop(),this.tracker.destroy(()=>{this.tracker=this._createTracker()})))}complete(e){this.tracker&&this.tracker.complete(e)}destroy(e){if(this.destroyed)return;this.destroyed=!0,clearTimeout(this._dhtTimeout);const t=[];this.tracker&&(this.tracker.stop(),this.tracker.removeListener("warning",this._onWarning),this.tracker.removeListener("error",this._onError),this.tracker.removeListener("peer",this._onTrackerPeer),this.tracker.removeListener("update",this._onTrackerAnnounce),t.push(e=>{this.tracker.destroy(e)})),this.dht&&this.dht.removeListener("peer",this._onDHTPeer),this._internalDHT&&(this.dht.removeListener("warning",this._onWarning),this.dht.removeListener("error",this._onError),t.push(e=>{this.dht.destroy(e)})),s(t,e),this.dht=null,this.tracker=null,this._announce=null}_createTracker(){const e=Object.assign({},this._trackerOpts,{infoHash:this.infoHash,announce:this._announce,peerId:this.peerId,port:this._port,userAgent:this._userAgent}),t=new a(e);return t.on("warning",this._onWarning),t.on("error",this._onError),t.on("peer",this._onTrackerPeer),t.on("update",this._onTrackerAnnounce),t.setInterval(this._intervalMs),t.start(),t}_dhtAnnounce(){this._dhtAnnouncing||(r("dht announce"),this._dhtAnnouncing=!0,clearTimeout(this._dhtTimeout),this.dht.announce(this.infoHash,this._port,e=>{this._dhtAnnouncing=!1,r("dht announce complete"),e&&this.emit("warning",e),this.emit("dhtAnnounce"),this.destroyed||(this._dhtTimeout=setTimeout(()=>{this._dhtAnnounce()},this._intervalMs+Math.floor(Math.random()*this._intervalMs/5)),this._dhtTimeout.unref&&this._dhtTimeout.unref())}))}}}).call(this,n(4))},function(e,t){},function(e,t,n){(function(t){e.exports=m;var r=n(25).Buffer,i=n(16)("bittorrent-tracker:client"),o=n(18).EventEmitter,s=n(69),a=n(7),u=n(34),c=n(53),l=n(96),h=n(71),f=n(70),d=n(155),p=n(370),g=n(371),v=n(372);function m(e){var n=this;if(!(n instanceof m))return new m(e);if(o.call(n),e||(e={}),!e.peerId)throw new Error("Option `peerId` is required");if(!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");if(!t.browser&&!e.port)throw new Error("Option `port` is required");n.peerId="string"==typeof e.peerId?e.peerId:e.peerId.toString("hex"),n._peerIdBuffer=r.from(n.peerId,"hex"),n._peerIdBinary=n._peerIdBuffer.toString("binary"),n.infoHash="string"==typeof e.infoHash?e.infoHash.toLowerCase():e.infoHash.toString("hex"),n._infoHashBuffer=r.from(n.infoHash,"hex"),n._infoHashBinary=n._infoHashBuffer.toString("binary"),i("new client %s",n.infoHash),n.destroyed=!1,n._port=e.port,n._getAnnounceOpts=e.getAnnounceOpts,n._rtcConfig=e.rtcConfig,n._userAgent=e.userAgent,n._wrtc="function"==typeof e.wrtc?e.wrtc():e.wrtc;var s="string"==typeof e.announce?[e.announce]:null==e.announce?[]:e.announce;s=s.map(function(e){return"/"===(e=e.toString())[e.length-1]&&(e=e.substring(0,e.length-1)),e}),s=h(s);var a=!1!==n._wrtc&&(!!n._wrtc||l.WEBRTC_SUPPORT);function u(e){t.nextTick(function(){n.emit("warning",e)})}n._trackers=s.map(function(e){var t=f.parse(e).protocol;return"http:"!==t&&"https:"!==t||"function"!=typeof p?"udp:"===t&&"function"==typeof g?new g(n,e):"ws:"!==t&&"wss:"!==t||!a?(u(new Error("Unsupported tracker protocol: "+e)),null):"ws:"===t&&"undefined"!=typeof window&&"https:"===window.location.protocol?(u(new Error("Unsupported tracker protocol: "+e)),null):new v(n,e):new p(n,e)}).filter(Boolean)}a(m,o),m.scrape=function(e,t){if(t=u(t),!e.infoHash)throw new Error("Option `infoHash` is required");if(!e.announce)throw new Error("Option `announce` is required");var n=new m(s(e,{infoHash:Array.isArray(e.infoHash)?e.infoHash[0]:e.infoHash,peerId:r.from("01234567890123456789"),port:6881}));n.once("error",t),n.once("warning",t);var i=Array.isArray(e.infoHash)?e.infoHash.length:1,o={};return n.on("scrape",function(e){if(i-=1,o[e.infoHash]=e,0===i){n.destroy();var r=Object.keys(o);t(null,1===r.length?o[r[0]]:o)}}),e.infoHash=Array.isArray(e.infoHash)?e.infoHash.map(function(e){return r.from(e,"hex")}):r.from(e.infoHash,"hex"),n.scrape({infoHash:e.infoHash}),n},m.prototype.start=function(e){i("send `start`"),(e=this._defaultAnnounceOpts(e)).event="started",this._announce(e),this._trackers.forEach(function(e){e.setInterval()})},m.prototype.stop=function(e){i("send `stop`"),(e=this._defaultAnnounceOpts(e)).event="stopped",this._announce(e)},m.prototype.complete=function(e){i("send `complete`"),e||(e={}),(e=this._defaultAnnounceOpts(e)).event="completed",this._announce(e)},m.prototype.update=function(e){i("send `update`"),(e=this._defaultAnnounceOpts(e)).event&&delete e.event,this._announce(e)},m.prototype._announce=function(e){this._trackers.forEach(function(t){t.announce(e)})},m.prototype.scrape=function(e){i("send `scrape`"),e||(e={}),this._trackers.forEach(function(t){t.scrape(e)})},m.prototype.setInterval=function(e){i("setInterval %d",e),this._trackers.forEach(function(t){t.setInterval(e)})},m.prototype.destroy=function(e){if(!this.destroyed){this.destroyed=!0,i("destroy");var t=this._trackers.map(function(e){return function(t){e.destroy(t)}});c(t,e),this._trackers=[],this._getAnnounceOpts=null}},m.prototype._defaultAnnounceOpts=function(e){return e||(e={}),null==e.numwant&&(e.numwant=d.DEFAULT_ANNOUNCE_PEERS),null==e.uploaded&&(e.uploaded=0),null==e.downloaded&&(e.downloaded=0),this._getAnnounceOpts&&(e=s(e,this._getAnnounceOpts())),e}}).call(this,n(4))},function(e,t){e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){e.exports=d;var r=n(16)("bittorrent-tracker:websocket-tracker"),i=n(69),o=n(7),s=n(96),a=n(55),u=n(373),c=n(155),l=n(375),h={};d._socketPool=h;var f=5e4;function d(e,t,n){l.call(this,e,t),r("new websocket tracker %s",t),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}function p(){}o(d,l),d.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,d.prototype.announce=function(e){var t=this;if(!t.destroyed&&!t.reconnecting)if(t.socket.connected){var n=i(e,{action:"announce",info_hash:t.client._infoHashBinary,peer_id:t.client._peerIdBinary});if(t._trackerId&&(n.trackerid=t._trackerId),"stopped"===e.event||"completed"===e.event)t._send(n);else{var r=Math.min(e.numwant,10);t._generateOffers(r,function(e){n.numwant=r,n.offers=e,t._send(n)})}}else t.socket.once("connect",function(){t.announce(e)})},d.prototype.scrape=function(e){var t=this;if(!t.destroyed&&!t.reconnecting)if(t.socket.connected){var n=Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(function(e){return e.toString("binary")}):e.infoHash&&e.infoHash.toString("binary")||t.client._infoHashBinary;t._send({action:"scrape",info_hash:n})}else t.socket.once("connect",function(){t.scrape(e)})},d.prototype.destroy=function(e){if(e||(e=p),this.destroyed)return e(null);for(var t in this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer),this.peers){var n=this.peers[t];clearTimeout(n.trackerTimeout),n.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,h[this.announceUrl]&&(h[this.announceUrl].consumers-=1),h[this.announceUrl].consumers>0)return e();var r=h[this.announceUrl];if(delete h[this.announceUrl],r.on("error",p),r.once("close",e),!this.expectingResponse)return o();var i=setTimeout(o,c.DESTROY_TIMEOUT);function o(){i&&(clearTimeout(i),i=null),r.removeListener("data",o),r.destroy(),r=null}r.once("data",o)},d.prototype._openSocket=function(){var e=this;e.destroyed=!1,e.peers||(e.peers={}),e._onSocketConnectBound=function(){e._onSocketConnect()},e._onSocketErrorBound=function(t){e._onSocketError(t)},e._onSocketDataBound=function(t){e._onSocketData(t)},e._onSocketCloseBound=function(){e._onSocketClose()},e.socket=h[e.announceUrl],e.socket?h[e.announceUrl].consumers+=1:(e.socket=h[e.announceUrl]=new u(e.announceUrl),e.socket.consumers=1,e.socket.once("connect",e._onSocketConnectBound)),e.socket.on("data",e._onSocketDataBound),e.socket.once("close",e._onSocketCloseBound),e.socket.once("error",e._onSocketErrorBound)},d.prototype._onSocketConnect=function(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))},d.prototype._onSocketData=function(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(e)}catch(e){return void this.client.emit("warning",new Error("Invalid tracker response"))}"announce"===e.action?this._onAnnounceResponse(e):"scrape"===e.action?this._onScrapeResponse(e):this._onSocketError(new Error("invalid action in WS response: "+e.action))}},d.prototype._onAnnounceResponse=function(e){var t=this;if(e.info_hash===t.client._infoHashBinary){if(!e.peer_id||e.peer_id!==t.client._peerIdBinary){r("received %s from %s for %s",JSON.stringify(e),t.announceUrl,t.client.infoHash);var n=e["failure reason"];if(n)return t.client.emit("warning",new Error(n));var i=e["warning message"];i&&t.client.emit("warning",new Error(i));var o=e.interval||e["min interval"];o&&t.setInterval(1e3*o);var s,a=e["tracker id"];if(a&&(t._trackerId=a),null!=e.complete){var u=Object.assign({},e,{announce:t.announceUrl,infoHash:c.binaryToHex(e.info_hash)});t.client.emit("update",u)}if(e.offer&&e.peer_id&&(r("creating peer (from remote offer)"),(s=t._createPeer()).id=c.binaryToHex(e.peer_id),s.once("signal",function(n){var r={action:"announce",info_hash:t.client._infoHashBinary,peer_id:t.client._peerIdBinary,to_peer_id:e.peer_id,answer:n,offer_id:e.offer_id};t._trackerId&&(r.trackerid=t._trackerId),t._send(r)}),s.signal(e.offer),t.client.emit("peer",s)),e.answer&&e.peer_id){var l=c.binaryToHex(e.offer_id);(s=t.peers[l])?(s.id=c.binaryToHex(e.peer_id),s.signal(e.answer),t.client.emit("peer",s),clearTimeout(s.trackerTimeout),s.trackerTimeout=null,delete t.peers[l]):r("got unexpected answer: "+JSON.stringify(e.answer))}}}else r("ignoring websocket data from %s for %s (looking for %s: reused socket)",t.announceUrl,c.binaryToHex(e.info_hash),t.client.infoHash)},d.prototype._onScrapeResponse=function(e){var t=this;e=e.files||{};var n=Object.keys(e);0!==n.length?n.forEach(function(n){var r=Object.assign(e[n],{announce:t.announceUrl,infoHash:c.binaryToHex(n)});t.client.emit("scrape",r)}):t.client.emit("warning",new Error("invalid scrape response"))},d.prototype._onSocketClose=function(){this.destroyed||(this.destroy(),this._startReconnectTimer())},d.prototype._onSocketError=function(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())},d.prototype._startReconnectTimer=function(){var e=this,t=Math.floor(3e4*Math.random())+Math.min(15e3*Math.pow(2,e.retries),18e5);e.reconnecting=!0,clearTimeout(e.reconnectTimer),e.reconnectTimer=setTimeout(function(){e.retries++,e._openSocket()},t),e.reconnectTimer.unref&&e.reconnectTimer.unref(),r("reconnecting socket in %s ms",t)},d.prototype._send=function(e){if(!this.destroyed){this.expectingResponse=!0;var t=JSON.stringify(e);r("send %s",t),this.socket.send(t)}},d.prototype._generateOffers=function(e,t){var n=this,i=[];r("generating %s offers",e);for(var o=0;o<e;++o)s();function s(){var e=a(20).toString("hex");r("creating peer (from _generateOffers)");var t=n.peers[e]=n._createPeer({initiator:!0});t.once("signal",function(t){i.push({offer:t,offer_id:c.hexToBinary(e)}),u()}),t.trackerTimeout=setTimeout(function(){r("tracker timeout: destroying peer"),t.trackerTimeout=null,delete n.peers[e],t.destroy()},f),t.trackerTimeout.unref&&t.trackerTimeout.unref()}function u(){i.length===e&&(r("generated %s offers",e),t(i))}u()},d.prototype._createPeer=function(e){var t=this;e=Object.assign({trickle:!1,config:t.client._rtcConfig,wrtc:t.client._wrtc},e);var n=new s(e);return n.once("error",r),n.once("connect",function e(){n.removeListener("error",r),n.removeListener("connect",e)}),n;function r(e){t.client.emit("warning",new Error("Connection error: "+e.message)),n.destroy()}}},function(e,t,n){(function(t,r){e.exports=l;var i=n(16)("simple-websocket"),o=n(7),s=n(55),a=n(11),u=n(374),c="function"!=typeof u?WebSocket:u;function l(e){var n=this;if(!(n instanceof l))return new l(e);if(e||(e={}),"string"==typeof e&&(e={url:e}),null==e.url&&null==e.socket)throw new Error("Missing required `url` or `socket` option");if(null!=e.url&&null!=e.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(n._id=s(4).toString("hex").slice(0,7),n._debug("new websocket: %o",e),e=Object.assign({allowHalfOpen:!1},e),a.Duplex.call(n,e),n.connected=!1,n.destroyed=!1,n._chunk=null,n._cb=null,n._interval=null,e.socket)n.url=e.socket.url,n._ws=e.socket;else{n.url=e.url;try{n._ws="function"==typeof u?new c(e.url,e):new c(e.url)}catch(e){return void t.nextTick(function(){n.destroy(e)})}}n._ws.binaryType="arraybuffer",n._ws.onopen=function(){n._onOpen()},n._ws.onmessage=function(e){n._onMessage(e)},n._ws.onclose=function(){n._onClose()},n._ws.onerror=function(){n.destroy(new Error("connection error to "+n.url))},n._onFinishBound=function(){n._onFinish()},n.once("finish",n._onFinishBound)}o(l,a.Duplex),l.WEBSOCKET_SUPPORT=!!c,l.prototype.send=function(e){this._ws.send(e)},l.prototype.destroy=function(e){this._destroy(e,function(){})},l.prototype._destroy=function(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._ws){var n=this._ws,r=function(){n.onclose=null};if(n.readyState===c.CLOSED)r();else try{n.onclose=r,n.close()}catch(e){r()}n.onopen=null,n.onmessage=null,n.onerror=function(){}}if(this._ws=null,e){if("undefined"!=typeof DOMException&&e instanceof DOMException){var i=e.code;(e=new Error(e.message)).code=i}this.emit("error",e)}this.emit("close"),t()}},l.prototype._read=function(){},l.prototype._write=function(e,t,n){if(this.destroyed)return n(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(e){return this.destroy(e)}"function"!=typeof u&&this._ws.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},l.prototype._onFinish=function(){var e=this;function t(){setTimeout(function(){e.destroy()},1e3)}e.destroyed||(e.connected?t():e.once("connect",t))},l.prototype._onMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=r.from(t)),this.push(t)}},l.prototype._onOpen=function(){var e=this;if(!e.connected&&!e.destroyed){if(e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(t){return e.destroy(t)}e._chunk=null,e._debug('sent chunk from "write before connect"');var t=e._cb;e._cb=null,t(null)}"function"!=typeof u&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}},l.prototype._onInterval=function(){if(this._cb&&this._ws&&!(this._ws.bufferedAmount>65536)){this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);var e=this._cb;this._cb=null,e(null)}},l.prototype._onClose=function(){this.destroyed||(this._debug("on close"),this.destroy())},l.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],i.apply(null,e)}}).call(this,n(4),n(1).Buffer)},function(e,t){},function(e,t,n){e.exports=i;var r=n(18).EventEmitter;function i(e,t){r.call(this),this.client=e,this.announceUrl=t,this.interval=null,this.destroyed=!1}n(7)(i,r),i.prototype.setInterval=function(e){var t=this;null==e&&(e=t.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(t.interval),e&&(t.interval=setInterval(function(){t.announce(t.client._defaultAnnounceOpts())},e),t.interval.unref&&t.interval.unref())}},function(e,t,n){(function(t){function n(e,t){if(!(this instanceof n))return new n(e,t);if(t||(t={}),this.chunkLength=Number(e),!this.chunkLength)throw new Error("First argument must be a chunk length");this.chunks=[],this.closed=!1,this.length=Number(t.length)||1/0,this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1)}function r(e,n,r){t.nextTick(function(){e&&e(n,r)})}e.exports=n,n.prototype.put=function(e,t,n){if(this.closed)return r(n,new Error("Storage is closed"));var i=e===this.lastChunkIndex;return i&&t.length!==this.lastChunkLength?r(n,new Error("Last chunk length must be "+this.lastChunkLength)):i||t.length===this.chunkLength?(this.chunks[e]=t,void r(n,null)):r(n,new Error("Chunk length must be "+this.chunkLength))},n.prototype.get=function(e,t,n){if("function"==typeof t)return this.get(e,null,t);if(this.closed)return r(n,new Error("Storage is closed"));var i=this.chunks[e];if(!i){var o=new Error("Chunk not found");return o.notFound=!0,r(n,o)}if(!t)return r(n,null,i);var s=t.offset||0;r(n,null,i.slice(s,(t.length||i.length-s)+s))},n.prototype.close=n.prototype.destroy=function(e){if(this.closed)return r(e,new Error("Storage is closed"));this.closed=!0,this.chunks=null,r(e,null)}}).call(this,n(4))},function(e,t,n){(function(t){e.exports=class{constructor(e){if(this.store=e,this.chunkLength=e.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.mem=[]}put(e,t,n){this.mem[e]=t,this.store.put(e,t,t=>{this.mem[e]=null,n&&n(t)})}get(e,n,r){if("function"==typeof n)return this.get(e,null,n);const i=n&&n.offset||0,o=this.mem[e];if(o)return function(e,n,r){t.nextTick(()=>{e&&e(null,r)})}(r,0,n?o.slice(i,n&&n.length&&i+n.length):o);this.store.get(e,n,r)}close(e){this.store.close(e)}destroy(e){this.store.destroy(e)}}}).call(this,n(4))},function(e,t){},function(e,t){},function(e,t,n){(function(t){e.exports=function(e,n,r){if("number"!=typeof n)throw new Error("second argument must be a Number");var i,o,s,a,u,c=!0;function l(e){function n(){r&&r(e,i),r=null}c?t.nextTick(n):n()}function h(t,n,r){if(i[t]=r,n&&(u=!0),0==--s||n)l(n);else if(!u&&f<o){var c;a?(c=a[f],f+=1,e[c](function(e,t){h(c,e,t)})):(c=f,f+=1,e[c](function(e,t){h(c,e,t)}))}}Array.isArray(e)?(i=[],s=o=e.length):(a=Object.keys(e),i={},s=o=a.length);var f=n;s?a?a.some(function(t,r){if(e[t](function(e,n){h(t,e,n)}),r===n-1)return!0}):e.some(function(e,t){if(e(function(e,n){h(t,e,n)}),t===n-1)return!0}):l(null),c=!1}}).call(this,n(4))},function(e,t,n){(function(t){const n=16384;class r{constructor(e){this.length=e,this.missing=e,this.sources=null,this._chunks=Math.ceil(e/n),this._remainder=e%n||n,this._buffered=0,this._buffer=null,this._cancellations=null,this._reservations=0,this._flushed=!1}chunkLength(e){return e===this._chunks-1?this._remainder:n}chunkLengthRemaining(e){return this.length-e*n}chunkOffset(e){return e*n}reserve(){return this.init()?this._cancellations.length?this._cancellations.pop():this._reservations<this._chunks?this._reservations++:-1:-1}reserveRemaining(){if(!this.init())return-1;if(this._reservations<this._chunks){const e=this._reservations;return this._reservations=this._chunks,e}return-1}cancel(e){this.init()&&this._cancellations.push(e)}cancelRemaining(e){this.init()&&(this._reservations=e)}get(e){return this.init()?this._buffer[e]:null}set(e,t,r){if(!this.init())return!1;const i=Math.ceil(t.length/n);for(let o=0;o<i;o++)if(!this._buffer[e+o]){const i=o*n,s=t.slice(i,i+n);this._buffered++,this._buffer[e+o]=s,this.missing-=s.length,this.sources.includes(r)||this.sources.push(r)}return this._buffered===this._chunks}flush(){if(!this._buffer||this._chunks!==this._buffered)return null;const e=t.concat(this._buffer,this.length);return this._buffer=null,this._cancellations=null,this.sources=null,this._flushed=!0,e}init(){return!(this._flushed||!this._buffer&&(this._buffer=new Array(this._chunks),this._cancellations=[],this.sources=[],0))}}Object.defineProperty(r,"BLOCK_LENGTH",{value:n}),e.exports=r}).call(this,n(1).Buffer)},function(e,t){},function(e,t){e.exports=function(e){var t=0;return function(){if(t===e.length)return null;var n=e.length-t,r=Math.random()*n|0,i=e[t+r],o=e[t];return e[t]=i,e[t+r]=o,t++,i}}},function(e,t,n){(function(t){const{EventEmitter:r}=n(18),i=n(66),o=n(72),s=n(16)("ut_metadata"),a=n(54),u=1e7,c=1e3,l=16384;e.exports=(e=>{class n extends r{constructor(n){super(),this._wire=n,this._fetching=!1,this._metadataComplete=!1,this._metadataSize=null,this._remainingRejects=null,this._bitfield=new o(0,{grow:c}),t.isBuffer(e)&&this.setMetadata(e)}onHandshake(e,t,n){this._infoHash=e}onExtendedHandshake(e){return e.m&&e.m.ut_metadata?e.metadata_size?"number"!=typeof e.metadata_size||u<e.metadata_size||e.metadata_size<=0?this.emit("warning",new Error("Peer gave invalid metadata size")):(this._metadataSize=e.metadata_size,this._numPieces=Math.ceil(this._metadataSize/l),this._remainingRejects=2*this._numPieces,void(this._fetching&&this._requestPieces())):this.emit("warning",new Error("Peer does not have metadata")):this.emit("warning",new Error("Peer does not support ut_metadata"))}onMessage(e){let t,n;try{const r=e.toString(),o=r.indexOf("ee")+2;t=i.decode(r.substring(0,o)),n=e.slice(o)}catch(e){return}switch(t.msg_type){case 0:this._onRequest(t.piece);break;case 1:this._onData(t.piece,n,t.total_size);break;case 2:this._onReject(t.piece)}}fetch(){this._metadataComplete||(this._fetching=!0,this._metadataSize&&this._requestPieces())}cancel(){this._fetching=!1}setMetadata(e){if(this._metadataComplete)return!0;s("set metadata");try{const t=i.decode(e).info;t&&(e=i.encode(t))}catch(e){}return!(this._infoHash&&this._infoHash!==a.sync(e)||(this.cancel(),this.metadata=e,this._metadataComplete=!0,this._metadataSize=this.metadata.length,this._wire.extendedHandshake.metadata_size=this._metadataSize,this.emit("metadata",i.encode({info:i.decode(this.metadata)})),0))}_send(e,n){let r=i.encode(e);t.isBuffer(n)&&(r=t.concat([r,n])),this._wire.extended("ut_metadata",r)}_request(e){this._send({msg_type:0,piece:e})}_data(e,t,n){const r={msg_type:1,piece:e};"number"==typeof n&&(r.total_size=n),this._send(r,t)}_reject(e){this._send({msg_type:2,piece:e})}_onRequest(e){if(!this._metadataComplete)return void this._reject(e);const t=e*l;let n=t+l;n>this._metadataSize&&(n=this._metadataSize);const r=this.metadata.slice(t,n);this._data(e,r,this._metadataSize)}_onData(e,t,n){t.length>l||(t.copy(this.metadata,e*l),this._bitfield.set(e),this._checkDone())}_onReject(e){this._remainingRejects>0&&this._fetching?(this._request(e),this._remainingRejects-=1):this.emit("warning",new Error('Peer sent "reject" too much'))}_requestPieces(){this.metadata=t.alloc(this._metadataSize);for(let e=0;e<this._numPieces;e++)this._request(e)}_checkDone(){let e=!0;for(let t=0;t<this._numPieces;t++)if(!this._bitfield.get(t)){e=!1;break}e&&(this.setMetadata(this.metadata)||this._failedMetadata())}_failedMetadata(){this._bitfield=new o(0,{grow:c}),this._remainingRejects-=this._numPieces,this._remainingRejects>0?this._requestPieces():this.emit("warning",new Error("Peer sent invalid metadata"))}}return n.prototype.name="ut_metadata",n})}).call(this,n(1).Buffer)},function(e,t){},function(e,t){e.exports.parse=function(e){var t=e.split(",").map(function(e){return function(e){if(/^-?\d+$/.test(e))return parseInt(e,10);var t;if(t=e.match(/^(-?\d+)(-|\.\.\.?|\u2025|\u2026|\u22EF)(-?\d+)$/)){var n=t[1],r=t[2],i=t[3];if(n&&i){var o=[],s=(n=parseInt(n))<(i=parseInt(i))?1:-1;"-"!=r&&".."!=r&&"\u2025"!=r||(i+=s);for(var a=n;a!=i;a+=s)o.push(a);return o}}return[]}(e)});return 0===t.length?[]:1===t.length?Array.isArray(t[0])?t[0]:t:t.reduce(function(e,t){return Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.concat(t)})}},function(e,t,n){(function(t){const{EventEmitter:r}=n(18),{PassThrough:i}=n(11),o=n(157),s=n(33),a=n(388),u=n(159),c=n(158),l=n(402),h=n(403);e.exports=class extends r{constructor(e,t){super(),this._torrent=e,this._destroyed=!1,this.name=t.name,this.path=t.path,this.length=t.length,this.offset=t.offset,this.done=!1;const n=t.offset,r=n+t.length-1;this._startPiece=n/this._torrent.pieceLength|0,this._endPiece=r/this._torrent.pieceLength|0,0===this.length&&(this.done=!0,this.emit("done"))}get downloaded(){if(!this._torrent.bitfield)return 0;const{pieces:e,bitfield:t,pieceLength:n}=this._torrent,{_startPiece:r,_endPiece:i}=this,o=e[r];let s=t.get(r)?n-this.offset:Math.max(o.length-o.missing-this.offset,0);for(let o=r+1;o<=i;++o)if(t.get(o))s+=n;else{const t=e[o];s+=t.length-t.missing}return Math.min(s,this.length)}get progress(){return this.length?this.downloaded/this.length:0}select(e){0!==this.length&&this._torrent.select(this._startPiece,this._endPiece,e)}deselect(){0!==this.length&&this._torrent.deselect(this._startPiece,this._endPiece,!1)}createReadStream(e){if(0===this.length){const e=new i;return t.nextTick(()=>{e.end()}),e}const n=new h(this,e);return this._torrent.select(n._startPiece,n._endPiece,!0,()=>{n._notify()}),o(n,()=>{this._destroyed||this._torrent.destroyed||this._torrent.deselect(n._startPiece,n._endPiece,!0)}),n}getBuffer(e){l(this.createReadStream(),this.length,e)}getBlob(e){if("undefined"==typeof window)throw new Error("browser-only method");u(this.createReadStream(),this._getMimeType(),e)}getBlobURL(e){if("undefined"==typeof window)throw new Error("browser-only method");c(this.createReadStream(),this._getMimeType(),e)}appendTo(e,t,n){if("undefined"==typeof window)throw new Error("browser-only method");a.append(this,e,t,n)}renderTo(e,t,n){if("undefined"==typeof window)throw new Error("browser-only method");a.render(this,e,t,n)}_getMimeType(){return a.mime[s.extname(this.name).toLowerCase()]}_destroy(){this._destroyed=!0,this._torrent=null}}}).call(this,n(4))},function(e,t,n){t.render=function(e,t,n,r){"function"==typeof n&&(r=n,n={}),n||(n={}),r||(r=function(){}),_(e),b(n),"string"==typeof t&&(t=document.querySelector(t)),m(e,function(n){if(t.nodeName!==n.toUpperCase()){var r=s.extname(e.name).toLowerCase();throw new Error('Cannot render "'+r+'" inside a "'+t.nodeName.toLowerCase()+'" element, expected "'+n+'"')}return t},n,r)},t.append=function(e,t,n,r){if("function"==typeof n&&(r=n,n={}),n||(n={}),r||(r=function(){}),_(e),b(n),"string"==typeof t&&(t=document.querySelector(t)),t&&("VIDEO"===t.nodeName||"AUDIO"===t.nodeName))throw new Error("Invalid video/audio node argument. Argument must be root element that video/audio tag will be appended to.");function i(e){var n=document.createElement(e);return t.appendChild(n),n}m(e,function(e){return"video"===e||"audio"===e?function(e){var r=i(e);return n.autoplay&&(r.autoplay=!0),n.muted&&(r.muted=!0),n.controls&&(r.controls=!0),t.appendChild(r),r}(e):i(e)},n,function(e,t){e&&t&&t.remove(),r(e,t)})},t.mime=n(389);var r=n(16)("render-media"),i=n(390),o=n(98),s=n(33),a=n(158),u=n(160),c=[".m4a",".m4v",".mp4"],l=[".m4v",".mkv",".mp4",".webm"],h=[].concat(l,[".m4a",".mp3"]),f=[".aac",".oga",".ogg",".wav",".flac"],d=[".bmp",".gif",".jpeg",".jpg",".png",".svg"],p=[".css",".html",".js",".md",".pdf",".txt"],g=2e8,v="undefined"!=typeof window&&window.MediaSource;function m(e,t,n,a){var g,m=s.extname(e.name).toLowerCase(),_=0;function b(){g.removeEventListener("loadstart",b),n.autoplay&&g.play()}function w(){g.removeEventListener("canplay",w),a(null,g)}function E(){y(e,function(e,n){if(e)return k(e);".pdf"!==m?((g=t("iframe")).sandbox="allow-forms allow-scripts",g.src=n):((g=t("object")).setAttribute("typemustmatch",!0),g.setAttribute("type","application/pdf"),g.setAttribute("data",n)),a(null,g)})}function k(t){t.message='Error rendering file "'+e.name+'": '+t.message,r(t.message),a(t)}h.indexOf(m)>=0?function(){var i=l.indexOf(m)>=0?"video":"audio";function a(){r("Use MediaSource API for "+e.name),d(),g.addEventListener("error",f),g.addEventListener("loadstart",b),g.addEventListener("canplay",w);var t=new o(g).createWriteStream({".m4a":'audio/mp4; codecs="mp4a.40.5"',".m4v":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".mkv":'video/webm; codecs="avc1.640029, mp4a.40.5"',".mp3":"audio/mpeg",".mp4":'video/mp4; codecs="avc1.640029, mp4a.40.5"',".webm":'video/webm; codecs="vorbis, vp8"'}[s.extname(e.name).toLowerCase()]);e.createReadStream().pipe(t),_&&(g.currentTime=_)}function h(){r("Use Blob URL for "+e.name),d(),g.addEventListener("error",k),g.addEventListener("loadstart",b),g.addEventListener("canplay",w),y(e,function(e,t){if(e)return k(e);g.src=t,_&&(g.currentTime=_)})}function f(t){if(r("MediaSource API error: fallback to Blob URL: %o",t.message||t),"number"==typeof e.length&&e.length>n.maxBlobLength)return r("File length too large for Blob URL approach: %d (max: %d)",e.length,n.maxBlobLength),k(new Error("File length too large for Blob URL approach: "+e.length+" (max: "+n.maxBlobLength+")"));g.removeEventListener("error",f),g.removeEventListener("canplay",w),h()}function d(){g||(g=t(i)).addEventListener("progress",function(){_=g.currentTime})}v?c.indexOf(m)>=0?(r("Use `videostream` package for "+e.name),d(),g.addEventListener("error",function e(t){r("videostream error: fallback to MediaSource API: %o",t.message||t),g.removeEventListener("error",e),g.removeEventListener("canplay",w),a()}),g.addEventListener("loadstart",b),g.addEventListener("canplay",w),u(e,g)):a():h()}():f.indexOf(m)>=0?(g=t("audio"),y(e,function(e,t){if(e)return k(e);g.addEventListener("error",k),g.addEventListener("loadstart",b),g.addEventListener("canplay",w),g.src=t})):d.indexOf(m)>=0?(g=t("img"),y(e,function(t,n){if(t)return k(t);g.src=n,g.alt=e.name,a(null,g)})):p.indexOf(m)>=0?E():function(){r('Unknown file extension "%s" - will attempt to render into iframe',m);var t="";e.createReadStream({start:0,end:1e3}).setEncoding("utf8").on("data",function(e){t+=e}).on("end",function(){i(t)?(r('File extension "%s" appears ascii, so will render.',m),E()):(r('File extension "%s" appears non-ascii, will not render.',m),a(new Error('Unsupported file type "'+m+'": Cannot append to DOM')))}).on("error",a)}()}function y(e,n){var r=s.extname(e.name).toLowerCase();a(e.createReadStream(),t.mime[r],n)}function _(e){if(null==e)throw new Error("file cannot be null or undefined");if("string"!=typeof e.name)throw new Error("missing or invalid file.name property");if("function"!=typeof e.createReadStream)throw new Error("missing or invalid file.createReadStream property")}function b(e){null==e.autoplay&&(e.autoplay=!1),null==e.muted&&(e.muted=!1),null==e.controls&&(e.controls=!0),null==e.maxBlobLength&&(e.maxBlobLength=g)}},function(e){e.exports={".3gp":"video/3gpp",".aac":"audio/aac",".aif":"audio/x-aiff",".aiff":"audio/x-aiff",".atom":"application/atom+xml",".avi":"video/x-msvideo",".bmp":"image/bmp",".bz2":"application/x-bzip2",".conf":"text/plain",".css":"text/css",".csv":"text/plain",".diff":"text/x-diff",".doc":"application/msword",".flv":"video/x-flv",".gif":"image/gif",".gz":"application/x-gzip",".htm":"text/html",".html":"text/html",".ico":"image/vnd.microsoft.icon",".ics":"text/calendar",".iso":"application/octet-stream",".jar":"application/java-archive",".jpeg":"image/jpeg",".jpg":"image/jpeg",".js":"application/javascript",".json":"application/json",".less":"text/css",".log":"text/plain",".m3u":"audio/x-mpegurl",".m4a":"audio/mp4",".m4v":"video/mp4",".manifest":"text/cache-manifest",".markdown":"text/x-markdown",".mathml":"application/mathml+xml",".md":"text/x-markdown",".mid":"audio/midi",".midi":"audio/midi",".mov":"video/quicktime",".mp3":"audio/mpeg",".mp4":"video/mp4",".mp4v":"video/mp4",".mpeg":"video/mpeg",".mpg":"video/mpeg",".odp":"application/vnd.oasis.opendocument.presentation",".ods":"application/vnd.oasis.opendocument.spreadsheet",".odt":"application/vnd.oasis.opendocument.text",".oga":"audio/ogg",".ogg":"application/ogg",".pdf":"application/pdf",".png":"image/png",".pps":"application/vnd.ms-powerpoint",".ppt":"application/vnd.ms-powerpoint",".ps":"application/postscript",".psd":"image/vnd.adobe.photoshop",".qt":"video/quicktime",".rar":"application/x-rar-compressed",".rdf":"application/rdf+xml",".rss":"application/rss+xml",".rtf":"application/rtf",".svg":"image/svg+xml",".svgz":"image/svg+xml",".swf":"application/x-shockwave-flash",".tar":"application/x-tar",".tbz":"application/x-bzip-compressed-tar",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".torrent":"application/x-bittorrent",".ttf":"application/x-font-ttf",".txt":"text/plain",".wav":"audio/wav",".webm":"video/webm",".wma":"audio/x-ms-wma",".wmv":"video/x-ms-wmv",".xls":"application/vnd.ms-excel",".xml":"application/xml",".yaml":"text/yaml",".yml":"text/yaml",".zip":"application/zip"}},function(e,t){e.exports=function(e){for(var t=0,n=e.length;t<n;++t)if(e.charCodeAt(t)>127)return!1;return!0}},function(e,t,n){(function(t){var r=n(392),i=n(18).EventEmitter,o=n(7),s=n(393),a=n(73),u=n(401);function c(e){i.call(this),this._tracks=[],this._fragmentSequence=1,this._file=e,this._decoder=null,this._findMoov(0)}function l(e,t){this._entries=e,this._countName=t||"count",this._index=0,this._offset=0,this.value=this._entries[0]}e.exports=c,o(c,i),c.prototype._findMoov=function(e){var t=this;t._decoder&&t._decoder.destroy(),t._decoder=s.decode();var n=t._file.createReadStream({start:e});n.pipe(t._decoder),t._decoder.once("box",function(r){"moov"===r.type?t._decoder.decode(function(e){n.destroy();try{t._processMoov(e)}catch(e){e.message="Cannot parse mp4 file: "+e.message,t.emit("error",e)}}):(n.destroy(),t._findMoov(e+r.length))})},l.prototype.inc=function(){this._offset++,this._offset>=this._entries[this._index][this._countName]&&(this._index++,this._offset=0),this.value=this._entries[this._index]},c.prototype._processMoov=function(e){var n=e.traks;this._tracks=[],this._hasVideo=!1,this._hasAudio=!1;for(var r=0;r<n.length;r++){var i,o,s=n[r],u=s.mdia.minf.stbl,c=u.stsd.entries[0],h=s.mdia.hdlr.handlerType;if("vide"===h&&"avc1"===c.type){if(this._hasVideo)continue;this._hasVideo=!0,i="avc1",c.avcC&&(i+="."+c.avcC.mimeCodec),o='video/mp4; codecs="'+i+'"'}else{if("soun"!==h||"mp4a"!==c.type)continue;if(this._hasAudio)continue;this._hasAudio=!0,i="mp4a",c.esds&&c.esds.mimeCodec&&(i+="."+c.esds.mimeCodec),o='audio/mp4; codecs="'+i+'"'}var f=[],d=0,p=0,g=0,v=0,m=0,y=0,_=new l(u.stts.entries),b=null;u.ctts&&(b=new l(u.ctts.entries));for(var w=0;;){var E=u.stsc.entries[m],k=u.stsz.entries[d],T=_.value.duration,S=!0;if(u.stss&&(S=u.stss.entries[w]===d+1),f.push({size:k,duration:T,dts:y,presentationOffset:b?b.value.compositionOffset:0,sync:S,offset:v+(u.stco||u.co64).entries[g]}),++d>=u.stsz.entries.length)break;if(v+=k,++p>=E.samplesPerChunk){p=0,v=0,g++;var C=u.stsc.entries[m+1];C&&g+1>=C.firstChunk&&m++}y+=T,_.inc(),b&&b.inc(),S&&w++}s.mdia.mdhd.duration=0,s.tkhd.duration=0,this._tracks.push({trackId:s.tkhd.trackId,timeScale:s.mdia.mdhd.timeScale,samples:f,currSample:null,currTime:null,moov:{type:"moov",mvhd:e.mvhd,traks:[{tkhd:s.tkhd,mdia:{mdhd:s.mdia.mdhd,hdlr:s.mdia.hdlr,elng:s.mdia.elng,minf:{vmhd:s.mdia.minf.vmhd,smhd:s.mdia.minf.smhd,dinf:s.mdia.minf.dinf,stbl:{stsd:u.stsd,stts:{version:0,flags:0,entries:[]},ctts:{version:0,flags:0,entries:[]},stsc:{version:0,flags:0,entries:[]},stsz:{version:0,flags:0,entries:[]},stco:{version:0,flags:0,entries:[]},stss:{version:0,flags:0,entries:[]}}}}}],mvex:{mehd:{fragmentDuration:e.mvhd.duration},trexs:[{trackId:s.tkhd.trackId,defaultSampleDescriptionIndex:E.sampleDescriptionId,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0}]}},mime:o})}if(0!==this._tracks.length){e.mvhd.duration=0,this._ftyp={type:"ftyp",brand:"iso5",brandVersion:0,compatibleBrands:["iso5"]};var x=a.encode(this._ftyp),A=this._tracks.map(function(e){var n=a.encode(e.moov);return{mime:e.mime,init:t.concat([x,n])}});this.emit("ready",A)}else this.emit("error",new Error("no playable tracks"))},c.prototype.seek=function(e){var t=this;if(!t._tracks)throw new Error("Not ready yet; wait for 'ready' event");t._fileStream&&(t._fileStream.destroy(),t._fileStream=null);var n=-1;if(t._tracks.map(function(r,i){r.outStream&&r.outStream.destroy(),r.inStream&&(r.inStream.destroy(),r.inStream=null);var o=r.outStream=s.encode(),a=t._generateFragment(i,e);if(!a)return o.finalize();(-1===n||a.ranges[0].start<n)&&(n=a.ranges[0].start),function e(n){o.destroyed||o.box(n.moof,function(s){if(s)return t.emit("error",s);o.destroyed||r.inStream.slice(n.ranges).pipe(o.mediaData(n.length,function(n){if(n)return t.emit("error",n);if(!o.destroyed){var r=t._generateFragment(i);if(!r)return o.finalize();e(r)}}))})}(a)}),n>=0){var r=t._fileStream=t._file.createReadStream({start:n});t._tracks.forEach(function(e){e.inStream=new u(n,{highWaterMark:1e7}),r.pipe(e.inStream)})}return t._tracks.map(function(e){return e.outStream})},c.prototype._findSampleBefore=function(e,t){var n=this._tracks[e],i=Math.floor(n.timeScale*t),o=r(n.samples,i,function(e,t){return e.dts+e.presentationOffset-t});for(-1===o?o=0:o<0&&(o=-o-2);!n.samples[o].sync;)o--;return o},c.prototype._generateFragment=function(e,t){var n,r=this._tracks[e];if((n=void 0!==t?this._findSampleBefore(e,t):r.currSample)>=r.samples.length)return null;for(var i=r.samples[n].dts,o=0,s=[],a=n;a<r.samples.length;a++){var u=r.samples[a];if(u.sync&&u.dts-i>=1*r.timeScale)break;o+=u.size;var c=s.length-1;c<0||s[c].end!==u.offset?s.push({start:u.offset,end:u.offset+u.size}):s[c].end+=u.size}return r.currSample=a,{moof:this._generateMoof(e,n,a),ranges:s,length:o}},c.prototype._generateMoof=function(e,t,n){for(var r=this._tracks[e],i=[],o=0,s=t;s<n;s++){var u=r.samples[s];u.presentationOffset<0&&(o=1),i.push({sampleDuration:u.duration,sampleSize:u.size,sampleFlags:u.sync?33554432:16842752,sampleCompositionTimeOffset:u.presentationOffset})}var c={type:"moof",mfhd:{sequenceNumber:this._fragmentSequence++},trafs:[{tfhd:{flags:131072,trackId:r.trackId},tfdt:{baseMediaDecodeTime:r.samples[t].dts},trun:{flags:3841,dataOffset:8,entries:i,version:o}}]};return c.trafs[0].trun.dataOffset+=a.encodingLength(c),c}}).call(this,n(1).Buffer)},function(e,t){e.exports=function(e,t,n,r,i){var o,s;if(void 0===r)r=0;else if((r|=0)<0||r>=e.length)throw new RangeError("invalid lower bound");if(void 0===i)i=e.length-1;else if((i|=0)<r||i>=e.length)throw new RangeError("invalid upper bound");for(;r<=i;)if((s=+n(e[o=r+(i-r>>1)],t,o,e))<0)r=o+1;else{if(!(s>0))return o;i=o-1}return~r}},function(e,t,n){t.decode=n(394),t.encode=n(400)},function(e,t,n){(function(t){var r=n(11),i=n(7),o=n(395),s=n(73),a=n(56),u=a(0);function c(){if(!(this instanceof c))return new c;r.Writable.call(this),this.destroyed=!1,this._pending=0,this._missing=0,this._buf=null,this._str=null,this._cb=null,this._ondrain=null,this._writeBuffer=null,this._writeCb=null,this._ondrain=null,this._kick()}function l(e){this._parent=e,this.destroyed=!1,r.PassThrough.call(this)}e.exports=c,i(c,r.Writable),c.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,e&&this.emit("error",e),this.emit("close"))},c.prototype._write=function(e,t,n){if(!this.destroyed){for(var r=!this._str||!this._str._writableState.needDrain;e.length&&!this.destroyed;){if(!this._missing)return this._writeBuffer=e,void(this._writeCb=n);var i=e.length<this._missing?e.length:this._missing;if(this._buf?e.copy(this._buf,this._buf.length-this._missing):this._str&&(r=this._str.write(i===e.length?e:e.slice(0,i))),this._missing-=i,!this._missing){var o=this._buf,s=this._cb,a=this._str;this._buf=this._cb=this._str=this._ondrain=null,r=!0,a&&a.end(),s&&s(o)}e=i===e.length?u:e.slice(i)}if(this._pending&&!this._missing)return this._writeBuffer=e,void(this._writeCb=n);r?n():this._ondrain(n)}},c.prototype._buffer=function(e,t){this._missing=e,this._buf=a(e),this._cb=t},c.prototype._stream=function(e,t){var n=this;return this._missing=e,this._str=new l(this),this._ondrain=o(this._str,"drain"),this._pending++,this._str.on("end",function(){n._pending--,n._kick()}),this._cb=t,this._str},c.prototype._readBox=function(){var e=this;!function n(r,i){e._buffer(r,function(r){i=i?t.concat([i,r]):r;var o=s.readHeaders(i);"number"==typeof o?n(o-i.length,i):(e._pending++,e._headers=o,e.emit("box",o))})}(8)},c.prototype.stream=function(){if(!this._headers)throw new Error("this function can only be called once after 'box' is emitted");var e=this._headers;return this._headers=null,this._stream(e.contentLen,null)},c.prototype.decode=function(e){var t=this;if(!t._headers)throw new Error("this function can only be called once after 'box' is emitted");var n=t._headers;t._headers=null,t._buffer(n.contentLen,function(r){var i=s.decodeWithoutHeaders(n,r);e(i),t._pending--,t._kick()})},c.prototype.ignore=function(){var e=this;if(!e._headers)throw new Error("this function can only be called once after 'box' is emitted");var t=e._headers;e._headers=null,this._missing=t.contentLen,this._cb=function(){e._pending--,e._kick()}},c.prototype._kick=function(){if(!this._pending&&(this._buf||this._str||this._readBox(),this._writeBuffer)){var e=this._writeCb,t=this._writeBuffer;this._writeBuffer=null,this._writeCb=null,this._write(t,null,e)}},i(l,r.PassThrough),l.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._parent.destroy(e),e&&this.emit("error",e),this.emit("close"))}}).call(this,n(1).Buffer)},function(e,t){e.exports=function(e,t){var n=null;return e.on(t,function(e){if(n){var t=n;n=null,t(e)}}),function(e){n=e}}},function(e,t,n){(function(t){var n=function(){try{if(!t.isEncoding("latin1"))return!1;var e=t.alloc?t.alloc(4):new t(4);return e.fill("ab","ucs2"),"61006200"===e.toString("hex")}catch(e){return!1}}();function r(e,t,n,r){if(n<0||r>e.length)throw new RangeError("Out of range index");return(r=void 0===r?e.length:r>>>0)>(n>>>=0)&&e.fill(t,n,r),e}e.exports=function(e,i,o,s,a){if(n)return e.fill(i,o,s,a);if("number"==typeof i)return r(e,i,o,s);if("string"==typeof i){if("string"==typeof o?(a=o,o=0,s=e.length):"string"==typeof s&&(a=s,s=e.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("latin1"===a&&(a="binary"),"string"==typeof a&&!t.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(""===i)return r(e,0,o,s);if(function(e){return 1===e.length&&e.charCodeAt(0)<256}(i))return r(e,i.charCodeAt(0),o,s);i=new t(i,a)}return t.isBuffer(i)?function(e,t,n,r){if(n<0||r>e.length)throw new RangeError("Out of range index");if(r<=n)return e;r=void 0===r?e.length:r>>>0;for(var i=n>>>=0,o=t.length;i<=r-o;)t.copy(e,i),i+=o;return i!==r&&t.copy(e,i,0,r-i),e}(e,i,o,s):r(e,0,o,s)}}).call(this,n(1).Buffer)},function(e,t,n){(function(t){e.exports=function(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative');return t.allocUnsafe?t.allocUnsafe(e):new t(e)}}).call(this,n(1).Buffer)},function(e,t,n){var r=n(73),i=n(399),o=n(56),s=n(99),a=n(161),u=20828448e5;function c(e,t,n){for(var r=t;r<n;r++)e[r]=0}function l(e,t,n){t.writeUInt32BE(Math.floor((e.getTime()+u)/1e3),n)}function h(e,t,n){t.writeUIntBE(Math.floor((e.getTime()+u)/1e3),n,6)}function f(e,t,n){t.writeUInt16BE(Math.floor(e)%65536,n),t.writeUInt16BE(Math.floor(256*e*256)%65536,n+2)}function d(e,t,n){e||(e=[0,0,0,0,0,0,0,0,0]);for(var r=0;r<e.length;r++)f(e[r],t,n+4*r)}function p(e){for(var t=new Array(e.length/4),n=0;n<t.length;n++)t[n]=m(e,4*n);return t}function g(e,t){return new Date(1e3*e.readUIntBE(t,6)-u)}function v(e,t){return new Date(1e3*e.readUInt32BE(t)-u)}function m(e,t){return e.readUInt16BE(t)+e.readUInt16BE(t+2)/65536}t.fullBoxes={},["mvhd","tkhd","mdhd","vmhd","smhd","stsd","esds","stsz","stco","co64","stss","stts","ctts","stsc","dref","elst","hdlr","mehd","trex","mfhd","tfhd","tfdt","trun"].forEach(function(e){t.fullBoxes[e]=!0}),t.ftyp={},t.ftyp.encode=function(e,n,r){n=n?n.slice(r):o(t.ftyp.encodingLength(e));var i=e.compatibleBrands||[];n.write(e.brand,0,4,"ascii"),n.writeUInt32BE(e.brandVersion,4);for(var s=0;s<i.length;s++)n.write(i[s],8+4*s,4,"ascii");return t.ftyp.encode.bytes=8+4*i.length,n},t.ftyp.decode=function(e,t){for(var n=(e=e.slice(t)).toString("ascii",0,4),r=e.readUInt32BE(4),i=[],o=8;o<e.length;o+=4)i.push(e.toString("ascii",o,o+4));return{brand:n,brandVersion:r,compatibleBrands:i}},t.ftyp.encodingLength=function(e){return 8+4*(e.compatibleBrands||[]).length},t.mvhd={},t.mvhd.encode=function(e,n,r){return n=n?n.slice(r):o(96),l(e.ctime||new Date,n,0),l(e.mtime||new Date,n,4),n.writeUInt32BE(e.timeScale||0,8),n.writeUInt32BE(e.duration||0,12),f(e.preferredRate||0,n,16),function(e,t,n){t[20]=Math.floor(e)%256,t[21]=Math.floor(256*e)%256}(e.preferredVolume||0,n),c(n,22,32),d(e.matrix,n,32),n.writeUInt32BE(e.previewTime||0,68),n.writeUInt32BE(e.previewDuration||0,72),n.writeUInt32BE(e.posterTime||0,76),n.writeUInt32BE(e.selectionTime||0,80),n.writeUInt32BE(e.selectionDuration||0,84),n.writeUInt32BE(e.currentTime||0,88),n.writeUInt32BE(e.nextTrackId||0,92),t.mvhd.encode.bytes=96,n},t.mvhd.decode=function(e,t){return{ctime:v(e=e.slice(t),0),mtime:v(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),preferredRate:m(e,16),preferredVolume:function(e,t){return e[20]+e[21]/256}(e),matrix:p(e.slice(32,68)),previewTime:e.readUInt32BE(68),previewDuration:e.readUInt32BE(72),posterTime:e.readUInt32BE(76),selectionTime:e.readUInt32BE(80),selectionDuration:e.readUInt32BE(84),currentTime:e.readUInt32BE(88),nextTrackId:e.readUInt32BE(92)}},t.mvhd.encodingLength=function(e){return 96},t.tkhd={},t.tkhd.encode=function(e,n,r){return n=n?n.slice(r):o(80),l(e.ctime||new Date,n,0),l(e.mtime||new Date,n,4),n.writeUInt32BE(e.trackId||0,8),c(n,12,16),n.writeUInt32BE(e.duration||0,16),c(n,20,28),n.writeUInt16BE(e.layer||0,28),n.writeUInt16BE(e.alternateGroup||0,30),n.writeUInt16BE(e.volume||0,32),d(e.matrix,n,36),n.writeUInt32BE(e.trackWidth||0,72),n.writeUInt32BE(e.trackHeight||0,76),t.tkhd.encode.bytes=80,n},t.tkhd.decode=function(e,t){return{ctime:v(e=e.slice(t),0),mtime:v(e,4),trackId:e.readUInt32BE(8),duration:e.readUInt32BE(16),layer:e.readUInt16BE(28),alternateGroup:e.readUInt16BE(30),volume:e.readUInt16BE(32),matrix:p(e.slice(36,72)),trackWidth:e.readUInt32BE(72),trackHeight:e.readUInt32BE(76)}},t.tkhd.encodingLength=function(e){return 80},t.mdhd={},t.mdhd.encode=function(e,n,r){return 1===e.version?(n=n?n.slice(r):o(32),h(e.ctime||new Date,n,0),h(e.mtime||new Date,n,8),n.writeUInt32BE(e.timeScale||0,16),n.writeUIntBE(e.duration||0,20,6),n.writeUInt16BE(e.language||0,28),n.writeUInt16BE(e.quality||0,30),t.mdhd.encode.bytes=32,n):(n=n?n.slice(r):o(20),l(e.ctime||new Date,n,0),l(e.mtime||new Date,n,4),n.writeUInt32BE(e.timeScale||0,8),n.writeUInt32BE(e.duration||0,12),n.writeUInt16BE(e.language||0,16),n.writeUInt16BE(e.quality||0,18),t.mdhd.encode.bytes=20,n)},t.mdhd.decode=function(e,t,n){return e=e.slice(t),n-t!=20?{ctime:g(e,0),mtime:g(e,8),timeScale:e.readUInt32BE(16),duration:e.readUIntBE(20,6),language:e.readUInt16BE(28),quality:e.readUInt16BE(30)}:{ctime:v(e,0),mtime:v(e,4),timeScale:e.readUInt32BE(8),duration:e.readUInt32BE(12),language:e.readUInt16BE(16),quality:e.readUInt16BE(18)}},t.mdhd.encodingLength=function(e){return 1===e.version?32:20},t.vmhd={},t.vmhd.encode=function(e,n,r){(n=n?n.slice(r):o(8)).writeUInt16BE(e.graphicsMode||0,0);var i=e.opcolor||[0,0,0];return n.writeUInt16BE(i[0],2),n.writeUInt16BE(i[1],4),n.writeUInt16BE(i[2],6),t.vmhd.encode.bytes=8,n},t.vmhd.decode=function(e,t){return{graphicsMode:(e=e.slice(t)).readUInt16BE(0),opcolor:[e.readUInt16BE(2),e.readUInt16BE(4),e.readUInt16BE(6)]}},t.vmhd.encodingLength=function(e){return 8},t.smhd={},t.smhd.encode=function(e,n,r){return(n=n?n.slice(r):o(4)).writeUInt16BE(e.balance||0,0),c(n,2,4),t.smhd.encode.bytes=4,n},t.smhd.decode=function(e,t){return{balance:(e=e.slice(t)).readUInt16BE(0)}},t.smhd.encodingLength=function(e){return 4},t.stsd={},t.stsd.encode=function(e,n,i){n=n?n.slice(i):o(t.stsd.encodingLength(e));var s=e.entries||[];n.writeUInt32BE(s.length,0);for(var a=4,u=0;u<s.length;u++)r.encode(s[u],n,a),a+=r.encode.bytes;return t.stsd.encode.bytes=a,n},t.stsd.decode=function(e,t,n){for(var i=(e=e.slice(t)).readUInt32BE(0),o=new Array(i),s=4,a=0;a<i;a++){var u=r.decode(e,s,n);o[a]=u,s+=u.length}return{entries:o}},t.stsd.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var n=0;n<e.entries.length;n++)t+=r.encodingLength(e.entries[n]);return t},t.avc1=t.VisualSampleEntry={},t.VisualSampleEntry.encode=function(e,n,i){c(n=n?n.slice(i):o(t.VisualSampleEntry.encodingLength(e)),0,6),n.writeUInt16BE(e.dataReferenceIndex||0,6),c(n,8,24),n.writeUInt16BE(e.width||0,24),n.writeUInt16BE(e.height||0,26),n.writeUInt32BE(e.hResolution||4718592,28),n.writeUInt32BE(e.vResolution||4718592,32),c(n,36,40),n.writeUInt16BE(e.frameCount||1,40);var s=e.compressorName||"",a=Math.min(s.length,31);n.writeUInt8(a,42),n.write(s,43,a,"utf8"),n.writeUInt16BE(e.depth||24,74),n.writeInt16BE(-1,76);var u=78;(e.children||[]).forEach(function(e){r.encode(e,n,u),u+=r.encode.bytes}),t.VisualSampleEntry.encode.bytes=u},t.VisualSampleEntry.decode=function(e,t,n){e=e.slice(t);for(var i=n-t,o=Math.min(e.readUInt8(42),31),s={dataReferenceIndex:e.readUInt16BE(6),width:e.readUInt16BE(24),height:e.readUInt16BE(26),hResolution:e.readUInt32BE(28),vResolution:e.readUInt32BE(32),frameCount:e.readUInt16BE(40),compressorName:e.toString("utf8",43,43+o),depth:e.readUInt16BE(74),children:[]},a=78;i-a>=8;){var u=r.decode(e,a,i);s.children.push(u),s[u.type]=u,a+=u.length}return s},t.VisualSampleEntry.encodingLength=function(e){var t=78;return(e.children||[]).forEach(function(e){t+=r.encodingLength(e)}),t},t.avcC={},t.avcC.encode=function(e,n,r){n=n?n.slice(r):o(e.buffer.length),e.buffer.copy(n),t.avcC.encode.bytes=e.buffer.length},t.avcC.decode=function(e,t,n){return{mimeCodec:(e=e.slice(t,n)).toString("hex",1,4),buffer:s(e)}},t.avcC.encodingLength=function(e){return e.buffer.length},t.mp4a=t.AudioSampleEntry={},t.AudioSampleEntry.encode=function(e,n,i){c(n=n?n.slice(i):o(t.AudioSampleEntry.encodingLength(e)),0,6),n.writeUInt16BE(e.dataReferenceIndex||0,6),c(n,8,16),n.writeUInt16BE(e.channelCount||2,16),n.writeUInt16BE(e.sampleSize||16,18),c(n,20,24),n.writeUInt32BE(e.sampleRate||0,24);var s=28;(e.children||[]).forEach(function(e){r.encode(e,n,s),s+=r.encode.bytes}),t.AudioSampleEntry.encode.bytes=s},t.AudioSampleEntry.decode=function(e,t,n){for(var i=n-t,o={dataReferenceIndex:(e=e.slice(t,n)).readUInt16BE(6),channelCount:e.readUInt16BE(16),sampleSize:e.readUInt16BE(18),sampleRate:e.readUInt32BE(24),children:[]},s=28;i-s>=8;){var a=r.decode(e,s,i);o.children.push(a),o[a.type]=a,s+=a.length}return o},t.AudioSampleEntry.encodingLength=function(e){var t=28;return(e.children||[]).forEach(function(e){t+=r.encodingLength(e)}),t},t.esds={},t.esds.encode=function(e,n,r){n=n?n.slice(r):o(e.buffer.length),e.buffer.copy(n,0),t.esds.encode.bytes=e.buffer.length},t.esds.decode=function(e,t,n){e=e.slice(t,n);var r=i.Descriptor.decode(e,0,e.length),o=("ESDescriptor"===r.tagName?r:{}).DecoderConfigDescriptor||{},a=o.oti||0,u=o.DecoderSpecificInfo,c=u?(248&u.buffer.readUInt8(0))>>3:0,l=null;return a&&(l=a.toString(16),c&&(l+="."+c)),{mimeCodec:l,buffer:s(e.slice(0))}},t.esds.encodingLength=function(e){return e.buffer.length},t.stsz={},t.stsz.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.stsz.encodingLength(e))).writeUInt32BE(0,0),n.writeUInt32BE(i.length,4);for(var s=0;s<i.length;s++)n.writeUInt32BE(i[s],4*s+8);return t.stsz.encode.bytes=8+4*i.length,n},t.stsz.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=e.readUInt32BE(4),i=new Array(r),o=0;o<r;o++)i[o]=0===n?e.readUInt32BE(4*o+8):n;return{entries:i}},t.stsz.encodingLength=function(e){return 8+4*e.entries.length},t.stss=t.stco={},t.stco.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.stco.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++)n.writeUInt32BE(i[s],4*s+4);return t.stco.encode.bytes=4+4*i.length,n},t.stco.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++)r[i]=e.readUInt32BE(4*i+4);return{entries:r}},t.stco.encodingLength=function(e){return 4+4*e.entries.length},t.co64={},t.co64.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.co64.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++)a.encode(i[s],n,8*s+4);return t.co64.encode.bytes=4+8*i.length,n},t.co64.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++)r[i]=a.decode(e,8*i+4);return{entries:r}},t.co64.encodingLength=function(e){return 4+8*e.entries.length},t.stts={},t.stts.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.stts.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++){var a=8*s+4;n.writeUInt32BE(i[s].count||0,a),n.writeUInt32BE(i[s].duration||0,a+4)}return t.stts.encode.bytes=4+8*e.entries.length,n},t.stts.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++){var o=8*i+4;r[i]={count:e.readUInt32BE(o),duration:e.readUInt32BE(o+4)}}return{entries:r}},t.stts.encodingLength=function(e){return 4+8*e.entries.length},t.ctts={},t.ctts.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.ctts.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++){var a=8*s+4;n.writeUInt32BE(i[s].count||0,a),n.writeUInt32BE(i[s].compositionOffset||0,a+4)}return t.ctts.encode.bytes=4+8*i.length,n},t.ctts.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++){var o=8*i+4;r[i]={count:e.readUInt32BE(o),compositionOffset:e.readInt32BE(o+4)}}return{entries:r}},t.ctts.encodingLength=function(e){return 4+8*e.entries.length},t.stsc={},t.stsc.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.stsc.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++){var a=12*s+4;n.writeUInt32BE(i[s].firstChunk||0,a),n.writeUInt32BE(i[s].samplesPerChunk||0,a+4),n.writeUInt32BE(i[s].sampleDescriptionId||0,a+8)}return t.stsc.encode.bytes=4+12*i.length,n},t.stsc.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++){var o=12*i+4;r[i]={firstChunk:e.readUInt32BE(o),samplesPerChunk:e.readUInt32BE(o+4),sampleDescriptionId:e.readUInt32BE(o+8)}}return{entries:r}},t.stsc.encodingLength=function(e){return 4+12*e.entries.length},t.dref={},t.dref.encode=function(e,n,r){n=n?n.slice(r):o(t.dref.encodingLength(e));var i=e.entries||[];n.writeUInt32BE(i.length,0);for(var s=4,a=0;a<i.length;a++){var u=i[a];n.writeUInt32BE((u.buf?u.buf.length:0)+4+4,s),n.write(u.type,s+=4,4,"ascii"),s+=4,u.buf&&(u.buf.copy(n,s),s+=u.buf.length)}return t.dref.encode.bytes=s,n},t.dref.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=4,o=0;o<n;o++){var s=e.readUInt32BE(i),a=e.toString("ascii",i+4,i+8),u=e.slice(i+8,i+s);i+=s,r[o]={type:a,buf:u}}return{entries:r}},t.dref.encodingLength=function(e){var t=4;if(!e.entries)return t;for(var n=0;n<e.entries.length;n++){var r=e.entries[n].buf;t+=(r?r.length:0)+4+4}return t},t.elst={},t.elst.encode=function(e,n,r){var i=e.entries||[];(n=n?n.slice(r):o(t.elst.encodingLength(e))).writeUInt32BE(i.length,0);for(var s=0;s<i.length;s++){var a=12*s+4;n.writeUInt32BE(i[s].trackDuration||0,a),n.writeUInt32BE(i[s].mediaTime||0,a+4),f(i[s].mediaRate||0,n,a+8)}return t.elst.encode.bytes=4+12*i.length,n},t.elst.decode=function(e,t){for(var n=(e=e.slice(t)).readUInt32BE(0),r=new Array(n),i=0;i<n;i++){var o=12*i+4;r[i]={trackDuration:e.readUInt32BE(o),mediaTime:e.readInt32BE(o+4),mediaRate:m(e,o+8)}}return{entries:r}},t.elst.encodingLength=function(e){return 4+12*e.entries.length},t.hdlr={},t.hdlr.encode=function(e,n,r){n=n?n.slice(r):o(t.hdlr.encodingLength(e));var i=21+(e.name||"").length;return n.fill(0,0,i),n.write(e.handlerType||"",4,4,"ascii"),function(t,n,r){var i=s(e.name||"","utf8");i.copy(n,20),n[20+i.length]=0}(0,n),t.hdlr.encode.bytes=i,n},t.hdlr.decode=function(e,t,n){return{handlerType:(e=e.slice(t)).toString("ascii",4,8),name:function(e,t,n){var r;for(r=0;r<n&&0!==e[20+r];r++);return e.toString("utf8",20,20+r)}(e,0,n)}},t.hdlr.encodingLength=function(e){return 21+(e.name||"").length},t.mehd={},t.mehd.encode=function(e,n,r){return(n=n?n.slice(r):o(4)).writeUInt32BE(e.fragmentDuration||0,0),t.mehd.encode.bytes=4,n},t.mehd.decode=function(e,t){return{fragmentDuration:(e=e.slice(t)).readUInt32BE(0)}},t.mehd.encodingLength=function(e){return 4},t.trex={},t.trex.encode=function(e,n,r){return(n=n?n.slice(r):o(20)).writeUInt32BE(e.trackId||0,0),n.writeUInt32BE(e.defaultSampleDescriptionIndex||0,4),n.writeUInt32BE(e.defaultSampleDuration||0,8),n.writeUInt32BE(e.defaultSampleSize||0,12),n.writeUInt32BE(e.defaultSampleFlags||0,16),t.trex.encode.bytes=20,n},t.trex.decode=function(e,t){return{trackId:(e=e.slice(t)).readUInt32BE(0),defaultSampleDescriptionIndex:e.readUInt32BE(4),defaultSampleDuration:e.readUInt32BE(8),defaultSampleSize:e.readUInt32BE(12),defaultSampleFlags:e.readUInt32BE(16)}},t.trex.encodingLength=function(e){return 20},t.mfhd={},t.mfhd.encode=function(e,n,r){return(n=n?n.slice(r):o(4)).writeUInt32BE(e.sequenceNumber||0,0),t.mfhd.encode.bytes=4,n},t.mfhd.decode=function(e,t){return{sequenceNumber:e.readUInt32BE(0)}},t.mfhd.encodingLength=function(e){return 4},t.tfhd={},t.tfhd.encode=function(e,n,r){return(n=n?n.slice(r):o(4)).writeUInt32BE(e.trackId,0),t.tfhd.encode.bytes=4,n},t.tfhd.decode=function(e,t){},t.tfhd.encodingLength=function(e){return 4},t.tfdt={},t.tfdt.encode=function(e,n,r){return(n=n?n.slice(r):o(4)).writeUInt32BE(e.baseMediaDecodeTime||0,0),t.tfdt.encode.bytes=4,n},t.tfdt.decode=function(e,t){},t.tfdt.encodingLength=function(e){return 4},t.trun={},t.trun.encode=function(e,n,r){(n=n?n.slice(r):o(8+16*e.entries.length)).writeUInt32BE(e.entries.length,0),n.writeInt32BE(e.dataOffset,4);for(var i=8,s=0;s<e.entries.length;s++){var a=e.entries[s];n.writeUInt32BE(a.sampleDuration,i),n.writeUInt32BE(a.sampleSize,i+=4),n.writeUInt32BE(a.sampleFlags,i+=4),i+=4,0===(e.version||0)?n.writeUInt32BE(a.sampleCompositionTimeOffset,i):n.writeInt32BE(a.sampleCompositionTimeOffset,i),i+=4}t.trun.encode.bytes=i},t.trun.decode=function(e,t){},t.trun.encodingLength=function(e){return 8+16*e.entries.length},t.mdat={},t.mdat.encode=function(e,n,r){e.buffer?(e.buffer.copy(n,r),t.mdat.encode.bytes=e.buffer.length):t.mdat.encode.bytes=t.mdat.encodingLength(e)},t.mdat.decode=function(e,t,n){return{buffer:s(e.slice(t,n))}},t.mdat.encodingLength=function(e){return e.buffer?e.buffer.length:e.contentLength}},function(e,t,n){var r=n(99),i={3:"ESDescriptor",4:"DecoderConfigDescriptor",5:"DecoderSpecificInfo",6:"SLConfigDescriptor"};t.Descriptor={},t.Descriptor.decode=function(e,n,o){var s,a,u=e.readUInt8(n),c=n+1,l=0;do{l=l<<7|127&(s=e.readUInt8(c++))}while(128&s);var h=i[u];return(a=t[h]?t[h].decode(e,c,o):{buffer:r(e.slice(c,c+l))}).tag=u,a.tagName=h,a.length=c-n+l,a.contentsLen=l,a},t.DescriptorArray={},t.DescriptorArray.decode=function(e,n,r){for(var o=n,s={};o+2<=r;){var a=t.Descriptor.decode(e,o,r);o+=a.length,s[i[a.tag]||"Descriptor"+a.tag]=a}return s},t.ESDescriptor={},t.ESDescriptor.decode=function(e,n,r){var i=e.readUInt8(n+2),o=n+3;return 128&i&&(o+=2),64&i&&(o+=e.readUInt8(o)+1),32&i&&(o+=2),t.DescriptorArray.decode(e,o,r)},t.DecoderConfigDescriptor={},t.DecoderConfigDescriptor.decode=function(e,n,r){var i=e.readUInt8(n),o=t.DescriptorArray.decode(e,n+13,r);return o.oti=i,o}},function(e,t,n){(function(t){var r=n(11),i=n(7),o=n(73),s=n(56);function a(){}function u(){if(!(this instanceof u))return new u;r.Readable.call(this),this.destroyed=!1,this._reading=!1,this._stream=null,this._drain=null,this._want=!1,this._onreadable=function(){e._want&&(e._want=!1,e._read())},this._onend=function(){e._stream=null};var e=this}function c(e){this._parent=e,this.destroyed=!1,r.PassThrough.call(this)}e.exports=u,i(u,r.Readable),u.prototype.mediaData=u.prototype.mdat=function(e,t){var n=new c(this);return this.box({type:"mdat",contentLength:e,encodeBufferLen:8,stream:n},t),n},u.prototype.box=function(e,n){if(n||(n=a),this.destroyed)return n(new Error("Encoder is destroyed"));var r;if(e.encodeBufferLen&&(r=s(e.encodeBufferLen)),e.stream)e.buffer=null,r=o.encode(e,r),this.push(r),this._stream=e.stream,this._stream.on("readable",this._onreadable),this._stream.on("end",this._onend),this._stream.on("end",n),this._forward();else{if(r=o.encode(e,r),this.push(r))return t.nextTick(n);this._drain=n}},u.prototype.destroy=function(e){if(!this.destroyed){if(this.destroyed=!0,this._stream&&this._stream.destroy&&this._stream.destroy(),this._stream=null,this._drain){var t=this._drain;this._drain=null,t(e)}e&&this.emit("error",e),this.emit("close")}},u.prototype.finalize=function(){this.push(null)},u.prototype._forward=function(){if(this._stream)for(;!this.destroyed;){var e=this._stream.read();if(!e)return void(this._want=!!this._stream);if(!this.push(e))return}},u.prototype._read=function(){if(!this._reading&&!this.destroyed){if(this._reading=!0,this._stream&&this._forward(),this._drain){var e=this._drain;this._drain=null,e()}this._reading=!1}},i(c,r.PassThrough),c.prototype.destroy=function(e){this.destroyed||(this.destroyed=!0,this._parent.destroy(e),e&&this.emit("error",e),this.emit("close"))}}).call(this,n(4))},function(e,t,n){const{Writable:r,PassThrough:i}=n(11);e.exports=class extends r{constructor(e,t={}){super(t),this.destroyed=!1,this._queue=[],this._position=e||0,this._cb=null,this._buffer=null,this._out=null}_write(e,t,n){let r=!0;for(;;){if(this.destroyed)return;if(0===this._queue.length)return this._buffer=e,void(this._cb=n);this._buffer=null;var i=this._queue[0];const t=Math.max(i.start-this._position,0),o=i.end-this._position;if(t>=e.length)return this._position+=e.length,n(null);let s;if(o>e.length){this._position+=e.length,s=0===t?e:e.slice(t),r=i.stream.write(s)&&r;break}this._position+=o,s=0===t&&o===e.length?e:e.slice(t,o),r=i.stream.write(s)&&r,i.last&&i.stream.end(),e=e.slice(o),this._queue.shift()}r?n(null):i.stream.once("drain",n.bind(null,null))}slice(e){if(this.destroyed)return null;Array.isArray(e)||(e=[e]);const t=new i;return e.forEach((n,r)=>{this._queue.push({start:n.start,end:n.end,stream:t,last:r===e.length-1})}),this._buffer&&this._write(this._buffer,null,this._cb),t}destroy(e){this.destroyed||(this.destroyed=!0,e&&this.emit("error",e))}}},function(e,t,n){(function(t){var r=n(34);e.exports=function(e,n,i){i=r(i);var o=t.alloc(n),s=0;e.on("data",function(e){e.copy(o,s),s+=e.length}).on("end",function(){i(null,o)}).on("error",i)}}).call(this,n(1).Buffer)},function(e,t,n){const r=n(16)("webtorrent:file-stream"),i=n(11);e.exports=class extends i.Readable{constructor(e,t){super(t),this.destroyed=!1,this._torrent=e._torrent;const n=t&&t.start||0,r=t&&t.end&&t.end<e.length?t.end:e.length-1,i=e._torrent.pieceLength;this._startPiece=(n+e.offset)/i|0,this._endPiece=(r+e.offset)/i|0,this._piece=this._startPiece,this._offset=n+e.offset-this._startPiece*i,this._missing=r-n+1,this._reading=!1,this._notifying=!1,this._criticalLength=Math.min(1048576/i|0,2)}_read(){this._reading||(this._reading=!0,this._notify())}_notify(){if(!this._reading||0===this._missing)return;if(!this._torrent.bitfield.get(this._piece))return this._torrent.critical(this._piece,this._piece+this._criticalLength);if(this._notifying)return;if(this._notifying=!0,this._torrent.destroyed)return this._destroy(new Error("Torrent removed"));const e=this._piece;this._torrent.store.get(e,(t,n)=>{if(this._notifying=!1,!this.destroyed){if(t)return this._destroy(t);r("read %s (length %s) (err %s)",e,n.length,t&&t.message),this._offset&&(n=n.slice(this._offset),this._offset=0),this._missing<n.length&&(n=n.slice(0,this._missing)),this._missing-=n.length,r("pushing buffer of length %s",n.length),this._reading=!1,this.push(n),0===this._missing&&this.push(null)}}),this._piece+=1}destroy(e){this._destroy(null,e)}_destroy(e,t){this.destroyed||(this.destroyed=!0,this._torrent.destroyed||this._torrent.deselect(this._startPiece,this._endPiece,!0),e&&this.emit("error",e),this.emit("close"),t&&t())}}},function(e,t,n){const r=n(162),i=n(16)("webtorrent:peer"),o=n(163),s=n(405),a=5e3,u=25e3,c=25e3;t.createWebRTCPeer=((e,t)=>{const n=new l(e.id,"webrtc");return n.conn=e,n.swarm=t,n.conn.connected?n.onConnect():(n.conn.once("connect",()=>{n.onConnect()}),n.conn.once("error",e=>{n.destroy(e)}),n.startConnectTimeout()),n}),t.createTCPIncomingPeer=(e=>{const t=`${e.remoteAddress}:${e.remotePort}`,n=new l(t,"tcpIncoming");return n.conn=e,n.addr=t,n.onConnect(),n}),t.createTCPOutgoingPeer=((e,t)=>{const n=new l(e,"tcpOutgoing");return n.addr=e,n.swarm=t,n}),t.createWebSeedPeer=((e,t)=>{const n=new l(e,"webSeed");return n.swarm=t,n.conn=new s(e,t),n.onConnect(),n});class l{constructor(e,t){this.id=e,this.type=t,i("new %s Peer %s",t,e),this.addr=null,this.conn=null,this.swarm=null,this.wire=null,this.connected=!1,this.destroyed=!1,this.timeout=null,this.retries=0,this.sentHandshake=!1}onConnect(){if(this.destroyed)return;this.connected=!0,i("Peer %s connected",this.id),clearTimeout(this.connectTimeout);const e=this.conn;e.once("end",()=>{this.destroy()}),e.once("close",()=>{this.destroy()}),e.once("finish",()=>{this.destroy()}),e.once("error",e=>{this.destroy(e)});const t=this.wire=new o;t.type=this.type,t.once("end",()=>{this.destroy()}),t.once("close",()=>{this.destroy()}),t.once("finish",()=>{this.destroy()}),t.once("error",e=>{this.destroy(e)}),t.once("handshake",(e,t)=>{this.onHandshake(e,t)}),this.startHandshakeTimeout(),e.pipe(t).pipe(e),this.swarm&&!this.sentHandshake&&this.handshake()}onHandshake(e,t){if(!this.swarm)return;if(this.destroyed)return;if(this.swarm.destroyed)return this.destroy(new Error("swarm already destroyed"));if(e!==this.swarm.infoHash)return this.destroy(new Error("unexpected handshake info hash for this swarm"));if(t===this.swarm.peerId)return this.destroy(new Error("refusing to connect to ourselves"));i("Peer %s got handshake %s",this.id,e),clearTimeout(this.handshakeTimeout),this.retries=0;let n=this.addr;!n&&this.conn.remoteAddress&&this.conn.remotePort&&(n=`${this.conn.remoteAddress}:${this.conn.remotePort}`),this.swarm._onWire(this.wire,n),this.swarm&&!this.swarm.destroyed&&(this.sentHandshake||this.handshake())}handshake(){this.wire.handshake(this.swarm.infoHash,this.swarm.client.peerId,{dht:!this.swarm.private&&!!this.swarm.client.dht}),this.sentHandshake=!0}startConnectTimeout(){clearTimeout(this.connectTimeout),this.connectTimeout=setTimeout(()=>{this.destroy(new Error("connect timeout"))},"webrtc"===this.type?u:a),this.connectTimeout.unref&&this.connectTimeout.unref()}startHandshakeTimeout(){clearTimeout(this.handshakeTimeout),this.handshakeTimeout=setTimeout(()=>{this.destroy(new Error("handshake timeout"))},c),this.handshakeTimeout.unref&&this.handshakeTimeout.unref()}destroy(e){if(this.destroyed)return;this.destroyed=!0,this.connected=!1,i("destroy %s (error: %s)",this.id,e&&(e.message||e)),clearTimeout(this.connectTimeout),clearTimeout(this.handshakeTimeout);const t=this.swarm,n=this.conn,o=this.wire;this.swarm=null,this.conn=null,this.wire=null,t&&o&&r(t.wires,t.wires.indexOf(o)),n&&(n.on("error",()=>{}),n.destroy()),o&&o.destroy(),t&&t.removePeer(this.id)}}},function(e,t,n){const r=n(72),i=n(25).Buffer,o=n(16)("webtorrent:webconn"),s=n(95),a=n(54),u=n(163),c=n(100).version;e.exports=class extends u{constructor(e,t){super(),this.url=e,this.webPeerId=a.sync(e),this._torrent=t,this._init()}_init(){this.setKeepAlive(!0),this.once("handshake",(e,t)=>{if(this.destroyed)return;this.handshake(e,this.webPeerId);const n=this._torrent.pieces.length,i=new r(n);for(let e=0;e<=n;e++)i.set(e,!0);this.bitfield(i)}),this.once("interested",()=>{o("interested"),this.unchoke()}),this.on("uninterested",()=>{o("uninterested")}),this.on("choke",()=>{o("choke")}),this.on("unchoke",()=>{o("unchoke")}),this.on("bitfield",()=>{o("bitfield")}),this.on("request",(e,t,n,r)=>{o("request pieceIndex=%d offset=%d length=%d",e,t,n),this.httpRequest(e,t,n,r)})}httpRequest(e,t,n,r){const a=e*this._torrent.pieceLength+t,u=a+n-1,l=this._torrent.files;let h;if(l.length<=1)h=[{url:this.url,start:a,end:u}];else{const e=l.filter(e=>e.offset<=u&&e.offset+e.length>a);if(e.length<1)return r(new Error("Could not find file corresponnding to web seed range request"));h=e.map(e=>{const t=e.offset+e.length-1;return{url:this.url+("/"===this.url[this.url.length-1]?"":"/")+e.path,fileOffsetInRange:Math.max(e.offset-a,0),start:Math.max(a-e.offset,0),end:Math.min(t,u-e.offset)}})}let f,d=0,p=!1;h.length>1&&(f=i.alloc(n)),h.forEach(i=>{const a=i.url,u=i.start,l=i.end;o("Requesting url=%s pieceIndex=%d offset=%d length=%d start=%d end=%d",a,e,t,n,u,l);const g={url:a,method:"GET",headers:{"user-agent":`WebTorrent/${c} (https://webtorrent.io)`,range:`bytes=${u}-${l}`}};function v(e,t){if(e.statusCode<200||e.statusCode>=300)return p=!0,r(new Error(`Unexpected HTTP status code ${e.statusCode}`));o("Got data of length %d",t.length),1===h.length?r(null,t):(t.copy(f,i.fileOffsetInRange),++d===h.length&&r(null,f))}s.concat(g,(e,t,n)=>{if(!p)return e?"undefined"==typeof window||a.startsWith(`${window.location.origin}/`)?(p=!0,r(e)):s.head(a,(t,n)=>{if(!p){if(t)return p=!0,r(t);if(n.statusCode<200||n.statusCode>=300)return p=!0,r(new Error(`Unexpected HTTP status code ${n.statusCode}`));if(n.url===a)return p=!0,r(e);g.url=n.url,s.concat(g,(e,t,n)=>{if(!p)return e?(p=!0,r(e)):void v(t,n)})}}):void v(t,n)})})}destroy(){super.destroy(),this._torrent=null}}},function(e,t){e.exports=class{constructor(e){this._torrent=e,this._numPieces=e.pieces.length,this._pieces=new Array(this._numPieces),this._onWire=(e=>{this.recalculate(),this._initWire(e)}),this._onWireHave=(e=>{this._pieces[e]+=1}),this._onWireBitfield=(()=>{this.recalculate()}),this._torrent.wires.forEach(e=>{this._initWire(e)}),this._torrent.on("wire",this._onWire),this.recalculate()}getRarestPiece(e){let t=[],n=1/0;for(let r=0;r<this._numPieces;++r){if(e&&!e(r))continue;const i=this._pieces[r];i===n?t.push(r):i<n&&(t=[r],n=i)}return t.length?t[Math.random()*t.length|0]:-1}destroy(){this._torrent.removeListener("wire",this._onWire),this._torrent.wires.forEach(e=>{this._cleanupWireEvents(e)}),this._torrent=null,this._pieces=null,this._onWire=null,this._onWireHave=null,this._onWireBitfield=null}_initWire(e){e._onClose=(()=>{this._cleanupWireEvents(e);for(let t=0;t<this._numPieces;++t)this._pieces[t]-=e.peerPieces.get(t)}),e.on("have",this._onWireHave),e.on("bitfield",this._onWireBitfield),e.once("close",e._onClose)}recalculate(){this._pieces.fill(0);for(const e of this._torrent.wires)for(let t=0;t<this._numPieces;++t)this._pieces[t]+=e.peerPieces.get(t)}_cleanupWireEvents(e){e.removeListener("have",this._onWireHave),e.removeListener("bitfield",this._onWireBitfield),e._onClose&&e.removeListener("close",e._onClose),e._onClose=null}}},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98),i=n(33),o=n(160),s=[".m4a",".m4v",".mp4"];t.renderVideo=function(e,t,n,a){return function(e){if(null==e)throw new Error("file cannot be null or undefined");if("string"!=typeof e.name)throw new Error("missing or invalid file.name property");if("function"!=typeof e.createReadStream)throw new Error("missing or invalid file.createReadStream property")}(e),function(e,t,n,a){var u,c=i.extname(e.name).toLowerCase(),l=void 0,h=0;try{s.indexOf(c)>=0?(f(),l.addEventListener("error",function e(t){return l.removeEventListener("error",e),a(t)}),l.addEventListener("loadstart",d),u=o(e,l)):u=function t(n){void 0===n&&(n=!1);var o=function(t,n){void 0===n&&(n=!1);var r=i.extname(e.name).toLowerCase();return".mp4"===r?'video/mp4; codecs="avc1.640029, mp4a.40.5"':".webm"===r?!0===n?'video/webm; codecs="vp9, opus"':'video/webm; codecs="vp8, vorbis"':void 0}(0,n);f(),l.addEventListener("error",function e(n){return l.removeEventListener("error",e),-1!==o.indexOf("vp8")?(void 0===(r=!0)&&(r=!1),!0===r?console.log("Falling back to media source with VP9 enabled."):console.log("Falling back to media source.."),void t(r)):a(n);var r}),l.addEventListener("loadstart",d);var s=new r(l),u=s.createWriteStream(o);return e.createReadStream().pipe(u),h&&(l.currentTime=h),s}()}catch(e){return a(e)}function f(){void 0===l&&(l=t).addEventListener("progress",function(){h=t.currentTime})}function d(){l.removeEventListener("loadstart",d),n.autoplay&&l.play(),a(null,u)}}(e,t,n,a)}},function(e,t,n){"use strict";(function(e,r){var i,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(18),c=n(410),l=function(e){function t(t){var n=e.call(this,t)||this;return n.version(1).stores({chunks:"id"}),n}return o(t,e),t}(c.default),h=function(e){function t(){var t=e.call(this,"webtorrent-expiration")||this;return t.version(1).stores({databases:"name,expiration"}),t}return o(t,e),t}(c.default),f=function(t){function n(e,n){var r=t.call(this)||this;if(r.pendingPut=[],r.memoryChunks={},r.databaseName="webtorrent-chunks-",n||(n={}),r.databaseName+=n.torrent&&n.torrent.infoHash?n.torrent.infoHash:"-default",r.setMaxListeners(100),r.chunkLength=Number(e),!r.chunkLength)throw new Error("First argument must be a chunk length");return r.length=Number(n.length)||1/0,r.length!==1/0&&(r.lastChunkLength=r.length%r.chunkLength||r.chunkLength,r.lastChunkIndex=Math.ceil(r.length/r.chunkLength)-1),r.db=new l(r.databaseName),r.expirationDB=new h,r.runCleaner(),r}return o(n,t),n.prototype.put=function(e,t,r){var i=this,o=e===this.lastChunkIndex;return o&&t.length!==this.lastChunkLength?this.nextTick(r,new Error("Last chunk length must be "+this.lastChunkLength)):o||t.length===this.chunkLength?(this.memoryChunks[e]=!0,this.pendingPut.push({id:e,buf:t,cb:r}),void(this.putBulkTimeout||(this.putBulkTimeout=setTimeout(function(){return s(i,void 0,void 0,function(){var e,t,n=this;return a(this,function(r){switch(r.label){case 0:e=this.pendingPut,this.pendingPut=[],this.putBulkTimeout=void 0,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,this.db.transaction("rw",this.db.chunks,function(){return n.db.chunks.bulkPut(e.map(function(e){return{id:e.id,buf:e.buf}}))})];case 2:return r.sent(),[3,5];case 3:return t=r.sent(),console.log("Cannot bulk insert chunks. Store them in memory.",{err:t}),e.forEach(function(e){return n.memoryChunks[e.id]=e.buf}),[3,5];case 4:return e.forEach(function(e){return e.cb()}),[7];case 5:return[2]}})})},n.BUFFERING_PUT_MS)))):this.nextTick(r,new Error("Chunk length must be "+this.chunkLength))},n.prototype.get=function(t,n,i){var o=this;if("function"==typeof n)return this.get(t,null,n);var u=this.memoryChunks[t];if(void 0===u){var c=new Error("Chunk not found");return c.notFound=!0,e.nextTick(function(){return i(c)})}if(!0!==u)return i(null,u);this.db.transaction("r",this.db.chunks,function(){return s(o,void 0,void 0,function(){var e,o,s;return a(this,function(a){switch(a.label){case 0:return[4,this.db.chunks.get({id:t})];case 1:return void 0===(e=a.sent())?[2,i(null,new r(0))]:(o=e.buf,n?[2,i(null,o.slice(s=n.offset||0,(n.length||o.length-s)+s))]:[2,this.nextTick(i,null,o)])}})})}).catch(function(e){return console.error(e),i(e)})},n.prototype.close=function(e){return this.destroy(e)},n.prototype.destroy=function(e){return s(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,6,,7]),this.pendingPut&&(clearTimeout(this.putBulkTimeout),this.pendingPut=null),this.cleanerInterval&&(clearInterval(this.cleanerInterval),this.cleanerInterval=null),this.db?[4,this.db.close()]:[3,3];case 1:return n.sent(),[4,this.dropDatabase(this.databaseName)];case 2:n.sent(),n.label=3;case 3:return this.expirationDB?[4,this.expirationDB.close()]:[3,5];case 4:n.sent(),this.expirationDB=null,n.label=5;case 5:return[2,e()];case 6:return t=n.sent(),console.error("Cannot destroy peertube chunk store.",t),[2,e(t)];case 7:return[2]}})})},n.prototype.runCleaner=function(){var e=this;this.checkExpiration(),this.cleanerInterval=setInterval(function(){return s(e,void 0,void 0,function(){return a(this,function(e){return this.checkExpiration(),[2]})})},n.CLEANER_INTERVAL_MS)},n.prototype.checkExpiration=function(){return s(this,void 0,void 0,function(){var e,t,r,i,o=this;return a(this,function(u){switch(u.label){case 0:e=[],u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.expirationDB.transaction("rw",this.expirationDB.databases,function(){return s(o,void 0,void 0,function(){var t;return a(this,function(r){switch(r.label){case 0:return[4,this.expirationDB.databases.put({name:this.databaseName,expiration:(new Date).getTime()+n.CLEANER_EXPIRATION_MS})];case 1:return r.sent(),t=(new Date).getTime(),[4,this.expirationDB.databases.where("expiration").below(t).toArray()];case 2:return e=r.sent(),[2]}})})})];case 2:return u.sent(),[3,4];case 3:return t=u.sent(),console.error("Cannot update expiration of fetch expired databases.",t),[3,4];case 4:r=0,i=e,u.label=5;case 5:return r<i.length?[4,this.dropDatabase(i[r].name)]:[3,8];case 6:u.sent(),u.label=7;case 7:return r++,[3,5];case 8:return[2]}})})},n.prototype.dropDatabase=function(e){return s(this,void 0,void 0,function(){var t,n,r=this;return a(this,function(i){switch(i.label){case 0:t=new l(e),console.log("Destroying IndexDB database %s.",e),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,t.delete()];case 2:return i.sent(),[4,this.expirationDB.transaction("rw",this.expirationDB.databases,function(){return r.expirationDB.databases.where({name:e}).delete()})];case 3:return i.sent(),[3,5];case 4:return n=i.sent(),console.error("Cannot delete %s.",e,n),[3,5];case 5:return[2]}})})},n.prototype.nextTick=function(t,n,r){e.nextTick(function(){return t(n,r)},void 0)},n.BUFFERING_PUT_MS=1e3,n.CLEANER_INTERVAL_MS=6e4,n.CLEANER_EXPIRATION_MS=3e5,n}(u.EventEmitter);t.PeertubeChunkStore=f}).call(this,n(4),n(1).Buffer)},function(e,t,n){"use strict";n.r(t),function(e){var n=Object.keys,r=Array.isArray,i="undefined"!=typeof self?self:"undefined"!=typeof window?window:e;function o(e,t){return"object"!=typeof t?e:(n(t).forEach(function(n){e[n]=t[n]}),e)}var s=Object.getPrototypeOf,a={}.hasOwnProperty;function u(e,t){return a.call(e,t)}function c(e,t){"function"==typeof t&&(t=t(s(e))),n(t).forEach(function(n){h(e,n,t[n])})}var l=Object.defineProperty;function h(e,t,n,r){l(e,t,o(n&&u(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function f(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:c.bind(null,e.prototype)}}}}var d=Object.getOwnPropertyDescriptor,p=[].slice;function g(e,t,n){return p.call(e,t,n)}function v(e,t){return t(e)}function m(e){if(!e)throw new Error("Assertion Failed")}function y(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce(function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e},{})}function b(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function w(e,t){if(u(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=w(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return void 0===a?void 0:w(a,t.substr(s+1))}}function E(e,t,n){if(e&&void 0!==t&&!("isFrozen"in Object&&Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){m("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)E(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var s=t.substr(0,o),a=t.substr(o+1);if(""===a)void 0===n?delete e[s]:e[s]=n;else{var u=e[s];u||(u=e[s]={}),E(u,a,n)}}else void 0===n?delete e[t]:e[t]=n}}function k(e){var t={};for(var n in e)u(e,n)&&(t[n]=e[n]);return t}var T=[].concat;function S(e){return T.apply([],e)}var C="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(S([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return i[e]}).map(function(e){return i[e]});function x(e){if(!e||"object"!=typeof e)return e;var t;if(r(e)){t=[];for(var n=0,i=e.length;n<i;++n)t.push(x(e[n]))}else if(C.indexOf(e.constructor)>=0)t=e;else for(var o in t=e.constructor?Object.create(e.constructor.prototype):{},e)u(e,o)&&(t[o]=x(e[o]));return t}function A(e,t,r,i){return r=r||{},i=i||"",n(e).forEach(function(n){if(u(t,n)){var o=e[n],s=t[n];"object"==typeof o&&"object"==typeof s&&o&&s&&""+o.constructor==""+s.constructor?A(o,s,r,i+n+"."):o!==s&&(r[i+n]=t[n])}else r[i+n]=void 0}),n(t).forEach(function(n){u(e,n)||(r[i+n]=t[n])}),r}var I="undefined"!=typeof Symbol&&Symbol.iterator,O=I?function(e){var t;return null!=e&&(t=e[I])&&t.apply(e)}:function(){return null},P={};function R(e){var t,n,i,o;if(1===arguments.length){if(r(e))return e.slice();if(this===P&&"string"==typeof e)return[e];if(o=O(e)){for(n=[];!(i=o.next()).done;)n.push(i.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var j="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function M(e,t){j=e,L=t}var L=function(){return!0},B=!new Error("").stack;function N(){if(B)try{throw new Error}catch(e){return e}return new Error}function U(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(L).map(function(e){return"\n"+e}).join("")):""}var D=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],F=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(D),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function V(e,t){this._e=N(),this.name=e,this.message=t}function W(e,t,n,r){this._e=N(),this.failures=t,this.failedKeys=r,this.successCount=n}function q(e,t){this._e=N(),this.name="BulkError",this.failures=t,this.message=function(e,t){return e+". Errors: "+t.map(function(e){return e.toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}(e,t)}f(V).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+U(this._e,2))}},toString:function(){return this.name+": "+this.message}}),f(W).from(V),f(q).from(V);var z=F.reduce(function(e,t){return e[t]=t+"Error",e},{}),K=V,G=F.reduce(function(e,t){var n=t+"Error";function r(e,r){this._e=N(),this.name=n,e?"string"==typeof e?(this.message=e,this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=H[t]||n,this.inner=null)}return f(r).from(K),e[t]=r,e},{});G.Syntax=SyntaxError,G.Type=TypeError,G.Range=RangeError;var $=D.reduce(function(e,t){return e[t+"Error"]=G[t],e},{}),Y=F.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=G[t]),e},{});function X(){}function J(e){return e}function Q(e,t){return null==e||e===J?t:function(n){return t(e(n))}}function Z(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ee(e,t){return e===X?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Z(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Z(i,this.onerror):i),void 0!==o?o:n}}function te(e,t){return e===X?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Z(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Z(r,this.onerror):r)}}function ne(e,t){return e===X?t:function(n){var r=e.apply(this,arguments);o(n,r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Z(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Z(s,this.onerror):s),void 0===r?void 0===a?void 0:a:o(r,a)}}function re(e,t){return e===X?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ie(e,t){return e===X?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}Y.ModifyError=W,Y.DexieError=V,Y.BulkError=q;var oe={},se=100,ae=7,ue=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=i.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),ce=ue[0],le=ue[1],he=ue[2],fe=le&&le.then,de=ce&&ce.constructor,pe=ue[3],ge=!!he,ve=!1,me=he?function(){he.then(Ue)}:i.setImmediate?setImmediate.bind(null,Ue):i.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){Ue(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Ue,0)},ye=function(e,t){xe.push([e,t]),be&&(me(),be=!1)},_e=!0,be=!0,we=[],Ee=[],ke=null,Te=J,Se={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:at,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{at(e[0],e[1])}catch(e){}})}},Ce=Se,xe=[],Ae=0,Ie=[];function Oe(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=X,this._lib=!1;var t=this._PSD=Ce;if(j&&(this._stackHolder=N(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==oe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&je(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n(function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&De();n&&"function"==typeof n.then?e(t,function(e,t){n instanceof Oe?n._then(e,t):n.then(e,t)}):(t._state=!0,t._value=n,Me(t)),r&&Fe()}},je.bind(null,t))}catch(e){je(t,e)}}(this,e)}var Pe={get:function(){var e=Ce,t=$e;function n(n,r){var i=this,o=!e.global&&(e!==Ce||t!==$e);o&&Qe();var s=new Oe(function(t,s){Le(i,new Re(it(n,e,o),it(r,e,o),t,s,e))});return j&&Ne(s,this),s}return n.prototype=oe,n},set:function(e){h(this,"then",e&&e.prototype===oe?Pe:{get:function(){return e},set:Pe.set})}};function Re(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function je(e,t){if(Ee.push(t),null===e._state){var n=e._lib&&De();t=Te(t),e._state=!1,e._value=t,j&&null!==t&&"object"==typeof t&&!t._promise&&b(function(){var n=function e(t,n){var r;return d(t,n)||(r=s(t))&&e(r,n)}(t,"stack");t._promise=e,h(t,"stack",{get:function(){return ve?n&&(n.get?n.get.apply(t):n.value):e.stack}})}),function(e){we.some(function(t){return t._value===e._value})||we.push(e)}(e),Me(e),n&&Fe()}}function Me(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Le(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Ae&&(++Ae,ye(function(){0==--Ae&&He()},[]))}function Le(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ae,ye(Be,[n,e,t])}else e._listeners.push(t)}function Be(e,t,n){try{ke=t;var r,i=t._value;t._state?r=e(i):(Ee.length&&(Ee=[]),r=e(i),-1===Ee.indexOf(i)&&function(e){for(var t=we.length;t;)if(we[--t]._value===e._value)return void we.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{ke=null,0==--Ae&&He(),--n.psd.ref||n.psd.finalize()}}function Ne(e,t){var n=t?t._numPrev+1:0;n<se&&(e._prev=t,e._numPrev=n)}function Ue(){De()&&Fe()}function De(){var e=_e;return _e=!1,be=!1,e}function Fe(){var e,t,n;do{for(;xe.length>0;)for(e=xe,xe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(xe.length>0);_e=!0,be=!0}function He(){var e=we;we=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Ie.slice(0),n=t.length;n;)t[--n]()}function Ve(e){return new Oe(oe,!1,e)}function We(e,t){var n=Ce;return function(){var r=De(),i=Ce;try{return tt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{tt(i,!1),r&&Fe()}}}c(Oe.prototype,{then:Pe,_then:function(e,t){Le(this,new Re(null,null,e,t,Ce))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return this.then(null,"function"==typeof t?function(e){return e instanceof t?n(e):Ve(e)}:function(e){return e&&e.name===t?n(e):Ve(e)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),Ve(t)})},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var e=function e(t,n,r){if(n.length===r)return n;var i="";if(!1===t._state){var o,s,a=t._value;null!=a?(o=a.name||"Error",s=a.message||a,i=U(a,0)):(o=a,s=""),n.push(o+(s?": "+s:"")+i)}return j&&((i=U(t._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),t._prev&&e(t._prev,n,r)),n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{ve=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Oe(function(r,i){var o=setTimeout(function(){return i(new G.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Oe.prototype,Symbol.toStringTag,"Promise"),Se.env=nt(),c(Oe,{all:function(){var e=R.apply(null,arguments).map(Ze);return new Oe(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(function(i,o){return Oe.resolve(i).then(function(n){e[o]=n,--r||t(e)},n)})})},resolve:function(e){if(e instanceof Oe)return e;if(e&&"function"==typeof e.then)return new Oe(function(t,n){e.then(t,n)});var t=new Oe(oe,!0,e);return Ne(t,ke),t},reject:Ve,race:function(){var e=R.apply(null,arguments).map(Ze);return new Oe(function(t,n){e.map(function(e){return Oe.resolve(e).then(t,n)})})},PSD:{get:function(){return Ce},set:function(e){return Ce=e}},newPSD:Xe,usePSD:rt,scheduler:{get:function(){return ye},set:function(e){ye=e}},rejectionMapper:{get:function(){return Te},set:function(e){Te=e}},follow:function(e,t){return new Oe(function(n,r){return Xe(function(t,n){var r=Ce;r.unhandleds=[],r.onunhandled=n,r.finalize=Z(function(){var e=this;Ie.push(function r(){0===e.unhandleds.length?t():n(e.unhandleds[0]),Ie.splice(Ie.indexOf(r),1)}),++Ae,ye(function(){0==--Ae&&He()},[])},r.finalize),e()},t,n,r)})}});var qe={awaits:0,echoes:0,id:0},ze=0,Ke=[],Ge=0,$e=0,Ye=0;function Xe(e,t,n,r){var i=Ce,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++Ye;var a=Se.env;s.env=ge?{Promise:Oe,PromiseProp:{value:Oe,configurable:!0,writable:!0},all:Oe.all,race:Oe.race,resolve:Oe.resolve,reject:Oe.reject,nthen:ot(a.nthen,s),gthen:ot(a.gthen,s)}:{},t&&o(s,t),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=rt(s,e,n,r);return 0===s.ref&&s.finalize(),u}function Je(){return qe.id||(qe.id=++ze),++qe.awaits,qe.echoes+=ae,qe.id}function Qe(e){!qe.awaits||e&&e!==qe.id||(0==--qe.awaits&&(qe.id=0),qe.echoes=qe.awaits*ae)}function Ze(e){return qe.echoes&&e&&e.constructor===de?(Je(),e.then(function(e){return Qe(),e},function(e){return Qe(),ut(e)})):e}function et(){var e=Ke[Ke.length-1];Ke.pop(),tt(e,!1)}function tt(e,t){var n,r=Ce;if((t?!qe.echoes||Ge++&&e===Ce:!Ge||--Ge&&e===Ce)||(n=t?function(e){++$e,qe.echoes&&0!=--qe.echoes||(qe.echoes=qe.id=0),Ke.push(Ce),tt(e,!0)}.bind(null,e):et,fe.call(ce,n)),e!==Ce&&(Ce=e,r===Se&&(Se.env=nt()),ge)){var o=Se.env.Promise,s=e.env;le.then=s.nthen,o.prototype.then=s.gthen,(r.global||e.global)&&(Object.defineProperty(i,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject)}}function nt(){var e=i.Promise;return ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,resolve:e.resolve,reject:e.reject,nthen:le.then,gthen:e.prototype.then}:{}}function rt(e,t,n,r,i){var o=Ce;try{return tt(e,!0),t(n,r,i)}finally{tt(o,!1)}}function it(e,t,n){return"function"!=typeof e?e:function(){var r=Ce;n&&Je(),tt(t,!0);try{return e.apply(this,arguments)}finally{tt(r,!1)}}}function ot(e,t){return function(n,r){return e.call(this,it(n,t,!1),it(r,t,!1))}}var st="unhandledrejection";function at(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,s={promise:t,reason:e};if(i.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(st,!0,!0),o(r,s)):i.CustomEvent&&o(r=new CustomEvent(st,{detail:s}),s),r&&i.dispatchEvent&&(dispatchEvent(r),!i.PromiseRejectionEvent&&i.onunhandledrejection))try{i.onunhandledrejection(r)}catch(e){}r.defaultPrevented||console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var ut=Oe.reject;function ct(e){var t={},i=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};i.addEventType=a;for(var o=1,s=arguments.length;o<s;++o)a(arguments[o]);return i;function a(e,o,s){if("object"!=typeof e){var u;o||(o=re),s||(s=X);var c={subscribers:[],fire:s,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=o(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter(function(t){return t!==e}),c.fire=c.subscribers.reduce(o,s)}};return t[e]=i[e]=c,c}n(u=e).forEach(function(e){var t=u[e];if(r(t))a(e,u[e][0],u[e][1]);else{if("asap"!==t)throw new G.InvalidArgument("Invalid event config");var n=a(e,J,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){y(function(){e.apply(null,t)})})})}})}}var lt,ht=String.fromCharCode(65535),ft=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return ht}}(),dt=-1/0,pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gt="String expected.",vt=[],mt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),yt=mt,_t=mt,bt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function wt(e,t){var s,a,l,f,d=wt.dependencies,p=o({addons:wt.addons,autoOpen:!0,indexedDB:d.indexedDB,IDBKeyRange:d.IDBKeyRange},t),y=p.addons,T=p.autoOpen,C=p.indexedDB,I=p.IDBKeyRange,O=this._dbSchema={},M=[],L=[],B={},D=null,F=null,H=!1,V=null,z=!1,K="readwrite",$=this,Y=new Oe(function(e){s=e}),Z=new Oe(function(e,t){a=t}),re=!0,oe=!!Rt(C);function se(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ae(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){ue(i,e)}),i}function ue(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ce(e,t,n){this.name=e,this.schema=t,this._tx=n,this.hook=B[e]?B[e].hook:ct(null,{creating:[ee,X],reading:[Q,J],updating:[ne,X],deleting:[te,X]})}function le(e,t,n){return(n?Ct:Tt)(function(n){e.push(n),t&&t()})}function he(e,t,n,r,i){return new Oe(function(o,s){var a=n.length,u=a-1;if(0===a)return o();if(r){var c,l=Ct(s),h=kt(null);b(function(){for(var r=0;r<a;++r){var s=n[r];i.call(c={onsuccess:null,onerror:null},s[0],s[1],t);var f=e.delete(s[0]);f._hookCtx=c,f.onerror=l,f.onsuccess=r===u?kt(o):h}},function(e){throw c.onerror&&c.onerror(e),e})}else for(var f=0;f<a;++f){var d=e.delete(n[f]);d.onerror=Tt(s),f===u&&(d.onsuccess=We(function(){return o()}))}})}function fe(e,t,n,r){var i=this;this.db=$,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=ct(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Oe(function(e,t){i._resolve=e,i._reject=t}),this._completion.then(function(){i.active=!1,i.on.complete.fire()},function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),ut(e)})}function ge(e,t,n){this._ctx={table:e,index:":id"===t?null:t,or:n}}function ve(e,t){var n=null,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function me(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function ye(e,t){return e._cfg.version-t._cfg.version}function _e(e,t,n){t.forEach(function(t){var r=n[t];e.forEach(function(e){t in e||(e===fe.prototype||e instanceof fe?h(e,t,{get:function(){return this.table(t)}}):e[t]=new ce(t,r))})})}function be(e,t,n,r,i,o){var s=We(o?function(e,t,r){return n(o(e),t,r)}:n,i);e.onerror||(e.onerror=Tt(i)),e.onsuccess=function(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}(t?function(){var n=e.result;if(n){var o=function(){n.continue()};t(n,function(e){o=e},r,i)&&s(n.value,n,function(e){o=e}),o()}else r()}:function(){var t=e.result;if(t){var n=function(){t.continue()};s(t.value,t,function(e){n=e}),n()}else r()},i)}function we(e,t){return C.cmp(e,t)}function Ee(e,t){return we(e,t)>0?e:t}function ke(e,t){return C.cmp(e,t)}function Te(e,t){return C.cmp(t,e)}function Se(e,t){return e<t?-1:e===t?0:1}function xe(e,t){return e>t?-1:e===t?0:1}function Ae(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Ie(e,t){for(var n=t.db.objectStoreNames,r=0;r<n.length;++r){var o=n[r],s=t.objectStore(o);l="getAll"in s;for(var a=0;a<s.indexNames.length;++a){var u=s.indexNames[a],c=s.index(u).keyPath,h="string"==typeof c?c:"["+g(c).join("+")+"]";if(e[o]){var f=e[o].idxByName[h];f&&(f.name=u)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function Pe(e){$.on("blocked").fire(e),vt.filter(function(e){return e.name===$.name&&e!==$&&!e._vcFired}).map(function(t){return t.on("versionchange").fire(e)})}this.version=function(e){if(D||H)throw new G.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=M.filter(function(t){return t._cfg.version===e})[0];return t||(t=new se(e),M.push(t),M.sort(ye),re=!1,t)},o(se.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var t={};M.forEach(function(e){o(t,e._cfg.storesSource)});var r=this._cfg.dbschema={};return this._parseStoresSpec(t,r),O=$._dbSchema=r,[B,$,fe.prototype].forEach(function(e){for(var t in e)e[t]instanceof ce&&delete e[t]}),_e([B,$,fe.prototype,this._cfg.tables],n(r),r),L=n(r),this},upgrade:function(e){return this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){n(e).forEach(function(n){if(null!==e[n]){var i={},o=(a=[],e[n].split(",").forEach(function(e){var t=(e=e.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(t)?t.match(/^\[(.*)\]$/)[1].split("+"):t;a.push(new It(t,n||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),r(n),/\./.test(e)))}),a),s=o.shift();if(s.multi)throw new G.Schema("Primary key cannot be multi-valued");s.keyPath&&E(i,s.keyPath,s.auto?0:s.keyPath),o.forEach(function(e){if(e.auto)throw new G.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new G.Schema("Index must have a name and cannot be an empty string");E(i,e.keyPath,e.compound?e.keyPath.map(function(){return""}):"")}),t[n]=new Ot(n,s,o,i)}var a})}}),this._allTables=B,this._createTransaction=function(e,t,n,r){return new fe(e,t,n,r)},this._whenReady=function(e){return z||Ce.letThrough?e():new Oe(function(e,t){if(!H){if(!T)return void t(new G.DatabaseClosed);$.open().catch(X)}Y.then(e,t)}).then(e)},this.verno=0,this.open=function(){if(H||D)return Y.then(function(){return F?ut(F):$});j&&(Z._stackHolder=N()),H=!0,F=null,z=!1;var t=s,r=null;return Oe.race([Z,new Oe(function(t,i){if(!C)throw new G.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var o=re?C.open(e):C.open(e,Math.round(10*$.verno));if(!o)throw new G.MissingAPI("IndexedDB API not available");o.onerror=Tt(i),o.onblocked=We(Pe),o.onupgradeneeded=We(function(t){if(r=o.transaction,re&&!$._allowEmptyDB){o.onerror=xt,r.abort(),o.result.close();var s=C.deleteDatabase(e);s.onsuccess=s.onerror=We(function(){i(new G.NoSuchDatabase("Database "+e+" doesnt exist"))})}else r.onerror=Tt(i),function(e,t,r){var i=$._createTransaction(K,L,O);i.create(t),i._completion.catch(r);var o=i._reject.bind(i);Xe(function(){Ce.trans=i,0===e?(n(O).forEach(function(e){ae(t,e,O[e].primKey,O[e].indexes)}),Oe.follow(function(){return $.on.populate.fire(i)}).catch(o)):function(e,t,r){var i=[],o=M.filter(function(t){return t._cfg.version===e})[0];if(!o)throw new G.Upgrade("Dexie specification of currently installed DB version is missing");O=$._dbSchema=o._cfg.dbschema;var s=!1;return M.filter(function(t){return t._cfg.version>e}).forEach(function(e){i.push(function(){var n=O,i=e._cfg.dbschema;Ie(n,r),Ie(i,r),O=$._dbSchema=i;var o=function(e,t){var n={del:[],add:[],change:[]};for(var r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],o=t[r];if(i){var s={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)s.recreate=!0,n.change.push(s);else{var a=i.idxByName,u=o.idxByName;for(var c in a)u[c]||s.del.push(c);for(c in u){var l=a[c],h=u[c];l?l.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}}else n.add.push([r,o])}return n}(n,i);if(o.add.forEach(function(e){ae(r,e[0],e[1].primKey,e[1].indexes)}),o.change.forEach(function(e){if(e.recreate)throw new G.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach(function(e){ue(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),ue(t,e)}),e.del.forEach(function(e){t.deleteIndex(e)})}),e._cfg.contentUpgrade)return s=!0,Oe.follow(function(){e._cfg.contentUpgrade(t)})}),i.push(function(t){s&&yt||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(e._cfg.dbschema,t)})}),function e(){return i.length?Oe.resolve(i.shift()(t.idbtrans)).then(e):Oe.resolve()}().then(function(){!function(e,t){n(e).forEach(function(n){t.db.objectStoreNames.contains(n)||ae(t,n,e[n].primKey,e[n].indexes)})}(O,r)})}(e,i,t).catch(o)})}((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,r,i)},i),o.onsuccess=We(function(){if(r=null,D=o.result,vt.push($),re)!function(){if($.verno=D.version/10,$._dbSchema=O={},0!==(L=g(D.objectStoreNames,0)).length){var e=D.transaction(Pt(L),"readonly");L.forEach(function(t){for(var n=e.objectStore(t),r=n.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf("."),o=new It(r,r||"",!1,!1,!!n.autoIncrement,r&&"string"!=typeof r,i),s=[],a=0;a<n.indexNames.length;++a){var u=n.index(n.indexNames[a]);i=(r=u.keyPath)&&"string"==typeof r&&-1!==r.indexOf(".");var c=new It(u.name,r,!!u.unique,!!u.multiEntry,!1,r&&"string"!=typeof r,i);s.push(c)}O[t]=new Ot(t,o,s,{})}),_e([B],n(O),O)}}();else if(D.objectStoreNames.length>0)try{Ie(O,D.transaction(Pt(D.objectStoreNames),"readonly"))}catch(e){}D.onversionchange=We(function(e){$._vcFired=!0,$.on("versionchange").fire(e)}),oe||"__dbnames"===e||lt.dbnames.put({name:e}).catch(X),t()},i)})]).then(function(){return V=[],Oe.resolve(wt.vip($.on.ready.fire)).then(function e(){if(V.length>0){var t=V.reduce(ie,X);return V=[],Oe.resolve(wt.vip(t)).then(e)}})}).finally(function(){V=null}).then(function(){return H=!1,$}).catch(function(e){try{r&&r.abort()}catch(e){}return H=!1,$.close(),ut(F=e)}).finally(function(){z=!0,t()})},this.close=function(){var e=vt.indexOf($);if(e>=0&&vt.splice(e,1),D){try{D.close()}catch(e){}D=null}T=!1,F=new G.DatabaseClosed,H&&a(F),Y=new Oe(function(e){s=e}),Z=new Oe(function(e,t){a=t})},this.delete=function(){var t=arguments.length>0;return new Oe(function(n,r){if(t)throw new G.InvalidArgument("Arguments not allowed in db.delete()");function i(){$.close();var t=C.deleteDatabase(e);t.onsuccess=We(function(){oe||lt.dbnames.delete(e).catch(X),n()}),t.onerror=Tt(r),t.onblocked=Pe}H?Y.then(i):i()})},this.backendDB=function(){return D},this.isOpen=function(){return null!==D},this.hasBeenClosed=function(){return F&&F instanceof G.DatabaseClosed},this.hasFailed=function(){return null!==F},this.dynamicallyOpened=function(){return re},this.name=e,c(this,{tables:{get:function(){return n(B).map(function(e){return B[e]})}}}),this.on=ct(this,"populate","blocked","versionchange",{ready:[ie,X]}),this.on.ready.subscribe=v(this.on.ready.subscribe,function(e){return function(t,n){wt.vip(function(){z?(F||Oe.resolve().then(t),n&&e(t)):V?(V.push(t),n&&e(t)):(e(t),n||e(function e(){$.on.ready.unsubscribe(t),$.on.ready.unsubscribe(e)}))})}}),this.transaction=function(){var e=function(e,t,n){var r=arguments.length;if(r<2)throw new G.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,S(i),n]}.apply(this,arguments);return this._transaction.apply(this,e)},this._transaction=function(e,t,n){var r=Ce.trans;r&&r.db===$&&-1===e.indexOf("!")||(r=null);var i=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var o=t.map(function(e){var t=e instanceof ce?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t});if("r"==e||"readonly"==e)e="readonly";else{if("rw"!=e&&e!=K)throw new G.InvalidArgument("Invalid transaction mode: "+e);e=K}if(r){if("readonly"===r.mode&&e===K){if(!i)throw new G.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach(function(e){if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new G.SubTransaction("Table "+e+" not included in parent transaction.");r=null}}),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,function(t,n){n(e)}):ut(e)}return r?r._promise(e,s,"lock"):Ce.trans?rt(Ce.transless,function(){return $._whenReady(s)}):$._whenReady(s);function s(){return Oe.resolve().then(function(){var t,i=Ce.transless||Ce,s=$._createTransaction(e,o,O,r),a={trans:s,transless:i};r?s.idbtrans=r.idbtrans:s.create(),n.constructor===pe&&Je();var u=Oe.follow(function(){if(t=n.call(s,s))if(t.constructor===de){var e=Qe.bind(null,null);t.then(e,e)}else"function"==typeof t.next&&"function"==typeof t.throw&&(t=At(t))},a);return(t&&"function"==typeof t.then?Oe.resolve(t).then(function(e){return s.active?e:ut(new G.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return t})).then(function(e){return r&&s._resolve(),s._completion.then(function(){return e})}).catch(function(e){return s._reject(e),ut(e)})})}},this.table=function(e){if(!u(B,e))throw new G.InvalidTable("Table "+e+" does not exist");return B[e]},c(ce.prototype,{_trans:function(e,t,n){var r=this._tx||Ce.trans;return r&&r.db===$?r===Ce.trans?r._promise(e,t,n):Xe(function(){return r._promise(e,t,n)},{trans:r,transless:Ce.transless||Ce}):function e(t,n,r){if(z||Ce.letThrough){var i=$._createTransaction(t,n,O);try{i.create()}catch(e){return ut(e)}return i._promise(t,function(e,t){return Xe(function(){return Ce.trans=i,r(e,t,i)})}).then(function(e){return i._completion.then(function(){return e})})}if(!H){if(!T)return ut(new G.DatabaseClosed);$.open().catch(X)}return Y.then(function(){return e(t,n,r)})}(e,[this.name],t)},_idbstore:function(e,t,n){var r=this.name;return this._trans(e,function(e,n,i){if(-1===i.storeNames.indexOf(r))throw new G.NotFound("Table"+r+" not part of transaction");return t(e,n,i.idbtrans.objectStore(r),i)},n)},get:function(e,t){if(e&&e.constructor===Object)return this.where(e).first(t);var n=this;return this._idbstore("readonly",function(t,r,i){var o=i.get(e);o.onerror=Tt(r),o.onsuccess=We(function(){t(n.hook.reading.fire(o.result))},r)}).then(t)},where:function(e){if("string"==typeof e)return new ge(this,e);if(r(e))return new ge(this,"["+e.join("+")+"]");var t=n(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter(function(e){return e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})&&e.keyPath.every(function(e){return t.indexOf(e)>=0})})[0];if(i&&ft!==ht)return this.where(i.name).equals(i.keyPath.map(function(t){return e[t]}));i||console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var o=this.schema.idxByName,s=t.reduce(function(t,n){return[t[0]||o[n],t[0]||!o[n]?Ae(t[1],function(t){return""+w(t,n)==""+e[n]}):t[1]]},[null,null]),a=s[0];return a?this.where(a.name).equals(e[a.keyPath]).filter(s[1]):i?this.filter(s[1]):this.where(t).equals("")},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new ve(new ge(this,r(e)?"["+e.join("+")+"]":e))},toCollection:function(){return new ve(new ge(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&Et(n,t),this.schema.instanceTemplate=n;var r=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(u(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e},defineClass:function(e){return this.mapToClass(wt.defineClass(e),e)},bulkDelete:function(e){return this.hook.deleting.fire===X?this._idbstore(K,function(t,n,r,i){t(he(r,i,e,!1,X))}):this.where(":id").anyOf(e).delete().then(function(){})},bulkPut:function(e,t){var n=this;return this._idbstore(K,function(r,i,o){if(!o.keyPath&&!n.schema.primKey.auto&&!t)throw new G.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&t)throw new G.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return r();var s,a,u=function(e){0===c.length?r(e):i(new q(n.name+".bulkPut(): "+c.length+" of "+l+" operations failed",c))},c=[],l=e.length,h=n;if(n.hook.creating.fire===X&&n.hook.updating.fire===X){a=le(c);for(var f=0,d=e.length;f<d;++f)(s=t?o.put(e[f],t[f]):o.put(e[f])).onerror=a;s.onerror=le(c,u),s.onsuccess=St(u)}else{var p=t||o.keyPath&&e.map(function(e){return w(e,o.keyPath)}),g=p&&_(p,function(t,n){return null!=t&&[t,e[n]]});(p?h.where(":id").anyOf(p.filter(function(e){return null!=e})).modify(function(){this.value=g[this.primKey],g[this.primKey]=null}).catch(W,function(e){c=e.failures}).then(function(){for(var n=[],r=t&&[],i=p.length-1;i>=0;--i){var o=p[i];(null==o||g[o])&&(n.push(e[i]),t&&r.push(o),null!=o&&(g[o]=null))}return n.reverse(),t&&r.reverse(),h.bulkAdd(n,r)}).then(function(e){var t=p[p.length-1];return null!=t?t:e}):h.bulkAdd(e)).then(u).catch(q,function(e){c=c.concat(e.failures),u()}).catch(i)}},"locked")},bulkAdd:function(e,t){var n=this,r=this.hook.creating.fire;return this._idbstore(K,function(i,o,s,a){if(!s.keyPath&&!n.schema.primKey.auto&&!t)throw new G.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(s.keyPath&&t)throw new G.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();function u(e){0===f.length?i(e):o(new q(n.name+".bulkAdd(): "+f.length+" of "+d+" operations failed",f))}var c,l,h,f=[],d=e.length;if(r!==X){var p,g=s.keyPath;l=le(f,null,!0),h=kt(null),b(function(){for(var n=0,i=e.length;n<i;++n){p={onerror:null,onsuccess:null};var o=t&&t[n],u=e[n],f=t?o:g?w(u,g):void 0,d=r.call(p,f,u,a);null==f&&null!=d&&(g?E(u=x(u),g,d):o=d),(c=null!=o?s.add(u,o):s.add(u))._hookCtx=p,n<i-1&&(c.onerror=l,p.onsuccess&&(c.onsuccess=h))}},function(e){throw p.onerror&&p.onerror(e),e}),c.onerror=le(f,u,!0),c.onsuccess=kt(u)}else{l=le(f);for(var v=0,m=e.length;v<m;++v)(c=t?s.add(e[v],t[v]):s.add(e[v])).onerror=l;c.onerror=le(f,u),c.onsuccess=St(u)}})},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore(K,function(r,i,o,s){var a={onsuccess:null,onerror:null};if(n!==X){var u=null!=t?t:o.keyPath?w(e,o.keyPath):void 0,c=n.call(a,u,e,s);null==u&&null!=c&&(o.keyPath?E(e,o.keyPath,c):t=c)}try{var l=null!=t?o.add(e,t):o.add(e);l._hookCtx=a,l.onerror=Ct(i),l.onsuccess=kt(function(t){var n=o.keyPath;n&&E(e,n,t),r(t)})}catch(e){throw a.onerror&&a.onerror(e),e}})},put:function(e,t){var n=this;if(this.hook.creating.fire!==X||this.hook.updating.fire!==X){var r=this.schema.primKey.keyPath,i=void 0!==t?t:r&&w(e,r);return null==i?this.add(e):(e=x(e),this._trans(K,function(){return n.where(":id").equals(i).modify(function(){this.value=e}).then(function(r){return 0===r?n.add(e,t):i})},"locked"))}return this._idbstore(K,function(n,r,i){var o=void 0!==t?i.put(e,t):i.put(e);o.onerror=Tt(r),o.onsuccess=We(function(t){var r=i.keyPath;r&&E(e,r,t.target.result),n(o.result)})})},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(K,function(t,n,r){var i=r.delete(e);i.onerror=Tt(n),i.onsuccess=We(function(){t(i.result)})})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(K,function(e,t,n){var r=n.clear();r.onerror=Tt(t),r.onsuccess=We(function(){e(r.result)})})},update:function(e,t){if("object"!=typeof t||r(t))throw new G.InvalidArgument("Modifications must be an object.");if("object"!=typeof e||r(e))return this.where(":id").equals(e).modify(t);n(t).forEach(function(n){E(e,n,t[n])});var i=w(e,this.schema.primKey.keyPath);return void 0===i?ut(new G.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(i).modify(t)}}),c(fe.prototype,{_lock:function(){return m(!Ce.global),++this._reculock,1!==this._reculock||Ce.global||(Ce.lockOwnerFor=this),this},_unlock:function(){if(m(!Ce.global),0==--this._reculock)for(Ce.global||(Ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{rt(e[1],e[0])}catch(e){}}return this},_locked:function(){return this._reculock&&Ce.lockOwnerFor!==this},create:function(e){var t=this;if(!this.mode)return this;if(m(!this.idbtrans),!e&&!D)switch(F&&F.name){case"DatabaseClosedError":throw new G.DatabaseClosed(F);case"MissingAPIError":throw new G.MissingAPI(F.message,F);default:throw new G.OpenFailed(F)}if(!this.active)throw new G.TransactionInactive;return m(null===this._completion._state),(e=this.idbtrans=e||D.transaction(Pt(this.storeNames),this.mode)).onerror=We(function(n){xt(n),t._reject(e.error)}),e.onabort=We(function(n){xt(n),t.active&&t._reject(new G.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=We(function(){t.active=!1,t._resolve()}),this},_promise:function(e,t,n){var r=this;if(e===K&&this.mode!==K)return ut(new G.ReadOnly("Transaction is readonly"));if(!this.active)return ut(new G.TransactionInactive);if(this._locked())return new Oe(function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Ce])});if(n)return Xe(function(){var e=new Oe(function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var i=new Oe(function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)});return i._lib=!0,i},_root:function(){return this.parent?this.parent._root():this},waitFor:function(e){var t=this._root();if(e=Oe.resolve(e),t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return e});else{t._waitingFor=e,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)}()}var r=t._waitingFor;return new Oe(function(n,i){e.then(function(e){return t._waitingQueue.push(We(n.bind(null,e)))},function(e){return t._waitingQueue.push(We(i.bind(null,e)))}).finally(function(){t._waitingFor===r&&(t._waitingFor=null)})})},abort:function(){this.active&&this._reject(new G.Abort),this.active=!1},tables:{get:(f=function(){return B},function(){return console.warn("Transaction.tables is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+U(N(),1)),f.apply(this,arguments)})},table:function(e){return new ce(e,$.table(e).schema,this)}}),c(ge.prototype,function(){function e(e,t,n){var r=e instanceof ge?new ve(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function t(e){return new ve(e,function(){return I.only("")}).limit(0)}function n(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,u=0;u<s;++u){var c=t[u];if(c!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[u],c)<0&&(a=u)}return s<r.length&&"next"===o?e+n.substr(e.length):s<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function r(t,r,i,o){var s,a,u,c,l,h,f,d=i.length;if(!i.every(function(e){return"string"==typeof e}))return e(t,gt);function p(e){s=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),a=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),u="next"===e?Se:xe;var t=i.map(function(e){return{lower:a(e),upper:s(e)}}).sort(function(e,t){return u(e.lower,t.lower)});c=t.map(function(e){return e.upper}),l=t.map(function(e){return e.lower}),h=e,f="next"===e?"":o}p("next");var g=new ve(t,function(){return I.bound(c[0],l[d-1]+o)});g._ondirectionchange=function(e){p(e)};var v=0;return g._addAlgorithm(function(e,t,i){var o=e.key;if("string"!=typeof o)return!1;var s=a(o);if(r(s,l,v))return!0;for(var p=null,g=v;g<d;++g){var m=n(o,s,c[g],l[g],u,h);null===m&&null===p?v=g+1:(null===p||u(p,m)>0)&&(p=m)}return t(null!==p?function(){e.continue(p+f)}:i),!1}),g}return{between:function(n,r,i,o){i=!1!==i,o=!0===o;try{return we(n,r)>0||0===we(n,r)&&(i||o)&&(!i||!o)?t(this):new ve(this,function(){return I.bound(n,r,!i,!o)})}catch(t){return e(this,pt)}},equals:function(e){return new ve(this,function(){return I.only(e)})},above:function(e){return new ve(this,function(){return I.lowerBound(e,!0)})},aboveOrEqual:function(e){return new ve(this,function(){return I.lowerBound(e)})},below:function(e){return new ve(this,function(){return I.upperBound(e,!0)})},belowOrEqual:function(e){return new ve(this,function(){return I.upperBound(e)})},startsWith:function(t){return"string"!=typeof t?e(this,gt):this.between(t,t+ht,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):r(this,function(e,t){return 0===e.indexOf(t[0])},[e],ht)},equalsIgnoreCase:function(e){return r(this,function(e,t){return e===t[0]},[e],"")},anyOfIgnoreCase:function(){var e=R.apply(P,arguments);return 0===e.length?t(this):r(this,function(e,t){return-1!==t.indexOf(e)},e,"")},startsWithAnyOfIgnoreCase:function(){var e=R.apply(P,arguments);return 0===e.length?t(this):r(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,ht)},anyOf:function(){var n=R.apply(P,arguments),r=ke;try{n.sort(r)}catch(t){return e(this,pt)}if(0===n.length)return t(this);var i=new ve(this,function(){return I.bound(n[0],n[n.length-1])});i._ondirectionchange=function(e){n.sort(r="next"===e?ke:Te)};var o=0;return i._addAlgorithm(function(e,t,i){for(var s=e.key;r(s,n[o])>0;)if(++o===n.length)return t(i),!1;return 0===r(s,n[o])||(t(function(){e.continue(n[o])}),!1)}),i},notEqual:function(e){return this.inAnyRange([[dt,e],[e,ft]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=R.apply(P,arguments);if(0===t.length)return new ve(this);try{t.sort(ke)}catch(t){return e(this,pt)}var n=t.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[dt,t]]},null);return n.push([t[t.length-1],ft]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,r){if(0===n.length)return t(this);if(!n.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&ke(e[0],e[1])<=0}))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",G.InvalidArgument);var i,o=!r||!1!==r.includeLowers,s=r&&!0===r.includeUppers,a=ke;function u(e,t){return a(e[0],t[0])}try{(i=n.reduce(function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(we(t[0],i[1])<0&&we(t[1],i[0])>0){i[0]=we(o=i[0],s=t[0])<0?o:s,i[1]=Ee(i[1],t[1]);break}}var o,s;return n===r&&e.push(t),e},[])).sort(u)}catch(t){return e(this,pt)}var c=0,l=s?function(e){return ke(e,i[c][1])>0}:function(e){return ke(e,i[c][1])>=0},h=o?function(e){return Te(e,i[c][0])>0}:function(e){return Te(e,i[c][0])>=0},f=l,d=new ve(this,function(){return I.bound(i[0][0],i[i.length-1][1],!o,!s)});return d._ondirectionchange=function(e){"next"===e?(f=l,a=ke):(f=h,a=Te),i.sort(u)},d._addAlgorithm(function(e,t,n){for(var r=e.key;f(r);)if(++c===i.length)return t(n),!1;return!!function(e){return!l(e)&&!h(e)}(r)||0!==we(r,i[c][1])&&0!==we(r,i[c][0])&&(t(function(){e.continue(a===ke?i[c][0]:i[c][1])}),!1)}),d},startsWithAnyOf:function(){var n=R.apply(P,arguments);return n.every(function(e){return"string"==typeof e})?0===n.length?t(this):this.inAnyRange(n.map(function(e){return[e,e+ht]})):e(this,"startsWithAnyOf() only works with strings")}}}),c(ve.prototype,function(){function e(e,t){e.filter=Ae(e.filter,t)}function t(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ae(r(),t())}:t,e.justLimit=n&&!r}function r(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new G.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function i(e,t){var n=r(e,t);return e.keysOnly&&"openKeyCursor"in n?n.openKeyCursor(e.range||null,e.dir+e.unique):n.openCursor(e.range||null,e.dir+e.unique)}function s(e,t,n,r,o){var s=e.replayFilter?Ae(e.filter,e.replayFilter()):e.filter;e.or?function(){var a={},c=0;function l(){2==++c&&n()}function h(e,n,i){if(!s||s(n,i,l,r)){var o=n.primaryKey,c=""+o;"[object ArrayBuffer]"===c&&(c=""+new Uint8Array(o)),u(a,c)||(a[c]=!0,t(e,n,i))}}e.or._iterate(h,l,r,o),be(i(e,o),e.algorithm,h,l,r,!e.keysOnly&&e.valueMapper)}():be(i(e,o),Ae(e.algorithm,s),t,n,r,!e.keysOnly&&e.valueMapper)}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ut.bind(null,n.error)):n.table._idbstore("readonly",e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,ut.bind(null,t.error)):t.table._idbstore(K,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Ae(t.algorithm,e)},_iterate:function(e,t,n,r){return s(this._ctx,e,t,n,r)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&o(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;return this._read(function(n,r,i){s(t,e,n,r,i)})},count:function(e){var t=this._ctx;if(me(t,!0))return this._read(function(e,n,i){var o=r(t,i),s=t.range?o.count(t.range):o.count();s.onerror=Tt(n),s.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}},e);var n=0;return this._read(function(e,r,i){s(t,function(){return++n,!1},function(){e(n)},r,i)},e)},sortBy:function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-s:n>r?s:0}return this.toArray(function(e){return e.sort(a)}).then(t)},toArray:function(e){var t=this._ctx;return this._read(function(e,n,i){if(l&&"next"===t.dir&&me(t,!0)&&t.limit>0){var o=t.table.hook.reading.fire,a=r(t,i),u=t.limit<1/0?a.getAll(t.range,t.limit):a.getAll(t.range);u.onerror=Tt(n),u.onsuccess=St(o===J?e:function(t){try{e(t.map(o))}catch(e){n(e)}})}else{var c=[];s(t,function(e){c.push(e)},function(){e(c)},n,i)}},e)},offset:function(e){var n=this._ctx;return e<=0?this:(n.offset+=e,me(n)?t(n,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):t(n,function(){var t=e;return function(){return--t<0}}),this)},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this},until:function(t,n){return e(this._ctx,function(e,r,i){return!t(e.value)||(r(i),n)}),this},first:function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){var n;return e(this._ctx,function(e){return t(e.value)}),(n=this._ctx).isMatch=Ae(n.isMatch,t),this},and:function(e){return this.filter(e)},or:function(e){return new ge(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},primaryKeys:function(e){var t=this._ctx;if(l&&"next"===t.dir&&me(t,!0)&&t.limit>0)return this._read(function(e,n,i){var o=r(t,i),s=t.limit<1/0?o.getAllKeys(t.range,t.limit):o.getAllKeys(t.range);s.onerror=Tt(n),s.onsuccess=St(e)}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return e(this._ctx,function(e){var t=e.primaryKey.toString(),n=u(r,t);return r[t]=!0,!n}),this},modify:function(e){var t=this,r=this._ctx.table.hook,i=r.updating.fire,s=r.deleting.fire;return this._write(function(r,a,c,l){var h;if("function"==typeof e)h=i===X&&s===X?e:function(t){var r=x(t);if(!1===e.call(this,t,this))return!1;if(u(this,"value")){var o=A(r,this.value),a=i.call(this,o,this.primKey,r,l);a&&(t=this.value,n(a).forEach(function(e){E(t,e,a[e])}))}else s.call(this,this.primKey,t,l)};else if(i===X){var f=n(e),d=f.length;h=function(t){for(var n=!1,r=0;r<d;++r){var i=f[r],o=e[i];w(t,i)!==o&&(E(t,i,o),n=!0)}return n}}else{var p=e;e=k(p),h=function(t){var r=!1,s=i.call(this,e,this.primKey,x(t),l);return s&&o(e,s),n(e).forEach(function(n){var i=e[n];w(t,n)!==i&&(E(t,n,i),r=!0)}),s&&(e=k(p)),r}}var g=0,v=0,m=!1,y=[],_=[],T=null;function S(e){return e&&(y.push(e),_.push(T)),a(new W("Error modifying one or more objects",y,v,_))}function C(){m&&v+y.length===g&&(y.length>0?S():r(v))}t.clone().raw()._iterate(function(e,t){T=t.primaryKey;var n={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function r(e){return y.push(e),_.push(n.primKey),C(),!0}if(!1!==h.call(n,e,n)){var i=!u(n,"value");++g,b(function(){var e=i?t.delete():t.update(n.value);e._hookCtx=n,e.onerror=Ct(r),e.onsuccess=kt(function(){++v,C()})},r)}else n.onsuccess&&n.onsuccess(n.value)},function(){m=!0,C()},S,c)})},delete:function(){var e=this,t=this._ctx,n=t.range,r=t.table.hook.deleting.fire,i=r!==X;if(!i&&me(t)&&(t.isPrimKey&&!_t||!n))return this._write(function(e,t,r){var i=Tt(t),o=n?r.count(n):r.count();o.onerror=i,o.onsuccess=function(){var s=o.result;b(function(){var t=n?r.delete(n):r.clear();t.onerror=i,t.onsuccess=function(){return e(s)}},function(e){return t(e)})}});var o=i?2e3:1e4;return this._write(function(n,s,a,u){var c=0,l=e.clone({keysOnly:!t.isMatch&&!i}).distinct().limit(o).raw(),h=[],f=function(){return l.each(i?function(e,t){h.push([t.primaryKey,t.value])}:function(e,t){h.push(t.primaryKey)}).then(function(){return h.sort(i?function(e,t){return ke(e[0],t[0])}:ke),he(a,u,h,i,r)}).then(function(){var e=h.length;return c+=e,h=[],e<o?c:f()})};n(f())})}}}),o(this,{Collection:ve,Table:ce,Transaction:fe,Version:se,WhereClause:ge}),$.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+$.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+$.name+"'. Closing db now to resume the delete request."),$.close()}),$.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+$.name+"') was blocked"):console.warn("Upgrade '"+$.name+"' blocked by other connection holding version "+e.oldVersion/10)}),y.forEach(function(e){e($)})}function Et(e,t){return n(t).forEach(function(n){var i=function e(t){if("function"==typeof t)return new t;if(r(t))return[e(t[0])];if(t&&"object"==typeof t){var n={};return Et(n,t),n}return t}(t[n]);e[n]=i}),e}function kt(e){return We(function(t){var n=t.target,r=n._hookCtx,i=r.value||n.result,o=r&&r.onsuccess;o&&o(i),e&&e(i)},e)}function Tt(e){return We(function(t){return xt(t),e(t.target.error),!1})}function St(e){return We(function(t){e(t.target.result)})}function Ct(e){return We(function(t){var n=t.target,r=n.error,i=n._hookCtx,o=i&&i.onerror;return o&&o(r),xt(t),e(r),!1})}function xt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function At(e){var t=function(t){return e.next(t)},n=o(t),i=o(function(t){return e.throw(t)});function o(e){return function(t){var o=e(t),s=o.value;return o.done?s:s&&"function"==typeof s.then?s.then(n,i):r(s)?Oe.all(s).then(n,i):n(s)}}return o(t)()}function It(e,t,n,r,i,o,s){this.name=e,this.keyPath=t,this.unique=n,this.multi=r,this.auto=i,this.compound=o,this.dotted=s;var a="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(r?"*":"")+(i?"++":"")+a}function Ot(e,t,n,r){this.name=e,this.primKey=t||new It,this.indexes=n||[new It],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=_(n,function(e){return[e.name,e]})}function Pt(e){return 1===e.length?e[0]:e}function Rt(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}M(j,bt),c(wt,Y),c(wt,{delete:function(e){var t=new wt(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new wt(e).open().then(function(e){return e.close(),!0}).catch(wt.NoSuchDatabaseError,function(){return!1})},getDatabaseNames:function(e){var t=Rt(wt.dependencies.indexedDB);return t?new Oe(function(e,n){var r=t();r.onsuccess=function(t){e(g(t.target.result,0))},r.onerror=Tt(n)}).then(e):lt.dbnames.toCollection().primaryKeys(e)},defineClass:function(){return function(e){e&&o(this,e)}},applyStructure:Et,ignoreTransaction:function(e){return Ce.trans?rt(Ce.transless,e):e()},vip:function(e){return Xe(function(){return Ce.letThrough=!0,e()})},async:function(e){return function(){try{var t=At(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Oe.resolve(t)}catch(e){return ut(e)}}},spawn:function(e,t,n){try{var r=At(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Oe.resolve(r)}catch(e){return ut(e)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(e,t){var n=Oe.resolve("function"==typeof e?wt.ignoreTransaction(e):e).timeout(t||6e4);return Ce.trans?Ce.trans.waitFor(n):n},Promise:Oe,debug:{get:function(){return j},set:function(e){M(e,"dexie"===e?function(){return!0}:bt)}},derive:f,extend:o,props:c,override:v,Events:ct,getByKeyPath:w,setByKeyPath:E,delByKeyPath:function(e,t){"string"==typeof t?E(e,t,void 0):"length"in t&&[].map.call(t,function(t){E(e,t,void 0)})},shallowClone:k,deepClone:x,getObjectDiff:A,asap:y,maxKey:ft,minKey:dt,addons:[],connections:vt,MultiModifyError:G.Modify,errnames:z,IndexSpec:It,TableSchema:Ot,dependencies:function(){try{return{indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"{version}",version:"{version}".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)}),default:wt,Dexie:wt}),Oe.rejectionMapper=function(e,t){if(!e||e instanceof V||e instanceof TypeError||e instanceof SyntaxError||!e.name||!$[e.name])return e;var n=new $[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},(lt=new wt("__dbnames")).version(1).stores({dbnames:"name"}),function(){try{void 0!==typeof localStorage&&void 0!==i.document&&(JSON.parse(localStorage.getItem("Dexie.DatabaseNames")||"[]").forEach(function(e){return lt.dbnames.put({name:e}).catch(X)}),localStorage.removeItem("Dexie.DatabaseNames"))}catch(e){}}(),t.default=wt}.call(this,n(10))},function(e,t,n){(function(t){const r=n(412);e.exports=class{constructor(e,t){if(this.store=e,this.chunkLength=e.chunkLength,!this.store||!this.store.get||!this.store.put)throw new Error("First argument must be abstract-chunk-store compliant");this.cache=new r(t)}put(e,t,n){this.store.put(e,t,n)}get(e,n,r){if("function"==typeof n)return this.get(e,null,n);const i=n&&n.offset||0,o=n&&n.length&&i+n.length,s=this.cache.get(e);if(s)return function(e,n,r){t.nextTick(()=>{e&&e(null,r)})}(r,0,n?s.slice(i,o):s);this.store.get(e,(t,s)=>{if(t)return r(t);null!=this.cache&&this.cache.set(e,s),r(null,n?s.slice(i,o):s)})}close(e){this.cache=null,this.store.close(e)}destroy(e){this.cache=null,this.store.destroy(e)}}}).call(this,n(4))},function(e,t,n){var r=n(18),i=n(7);function o(e){if(!(this instanceof o))return new o(e);"number"==typeof e&&(e={max:e}),e||(e={}),r.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=e.max||1e3,this.maxAge=e.maxAge||0}e.exports=o,i(o,r.EventEmitter),Object.defineProperty(o.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),o.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},o.prototype.remove=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];return delete this.cache[e],this._unlink(e,t.prev,t.next),t.value}},o.prototype._unlink=function(e,t,n){this.length--,0===this.length?this.head=this.tail=null:this.head===e?(this.head=t,this.cache[this.head].next=null):this.tail===e?(this.tail=n,this.cache[this.tail].prev=null):(this.cache[t].next=n,this.cache[n].prev=t)},o.prototype.peek=function(e){if(this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return t.value}},o.prototype.set=function(e,t){var n;if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){if((n=this.cache[e]).value=t,this.maxAge&&(n.modified=Date.now()),e===this.head)return t;this._unlink(e,n.prev,n.next)}else n={value:t,modified:0,next:null,prev:null},this.maxAge&&(n.modified=Date.now()),this.cache[e]=n,this.length===this.max&&this.evict();return this.length++,n.next=null,n.prev=this.head,this.head&&(this.cache[this.head].next=e),this.head=e,this.tail||(this.tail=e),t},o.prototype._checkAge=function(e,t){return!(this.maxAge&&Date.now()-t.modified>this.maxAge&&(this.remove(e),this.emit("evict",{key:e,value:t.value}),1))},o.prototype.get=function(e){if("string"!=typeof e&&(e=""+e),this.cache.hasOwnProperty(e)){var t=this.cache[e];if(this._checkAge(e,t))return this.head!==e&&(e===this.tail?(this.tail=t.next,this.cache[this.tail].prev=null):this.cache[t.prev].next=t.next,this.cache[t.next].prev=t.prev,this.cache[this.head].next=e,t.prev=this.head,t.next=null,this.head=e),t.value}},o.prototype.evict=function(){if(this.tail){var e=this.tail,t=this.remove(this.tail);this.emit("evict",{key:e,value:t})}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24).videojsUntyped.getComponent("Component"),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.partEls_=[],r.on(t,"progress",r.update),r}return i(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},t.prototype.dispose=function(){this.partEls_=null,e.prototype.dispose.call(this)},t.prototype.update=function(){var e=this.player().peertube().getTorrent();e&&(this.el_.style.width=100*e.progress+"%")},t}(o);o.registerComponent("PeerTubeLoadProgressBar",s)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),s=n(164),a=function(e){function t(n,r){var i=e.call(this,n,r)||this;return!0===s.getStoredTheater()&&(i.player_.addClass(t.THEATER_MODE_CLASS),i.handleTheaterChange()),i}return i(t,e),t.prototype.buildCSSClass=function(){return"vjs-theater-control "+e.prototype.buildCSSClass.call(this)},t.prototype.handleTheaterChange=function(){this.isTheaterEnabled()?this.controlText("Normal mode"):this.controlText("Theater mode"),s.saveTheaterInStore(this.isTheaterEnabled())},t.prototype.handleClick=function(){this.player_.toggleClass(t.THEATER_MODE_CLASS),this.handleTheaterChange()},t.prototype.isTheaterEnabled=function(){return this.player_.hasClass(t.THEATER_MODE_CLASS)},t.THEATER_MODE_CLASS="vjs-theater-enabled",t}(o.videojsUntyped.getComponent("Button"));a.prototype.controlText_="Theater mode",a.registerComponent("TheaterButton",a)},,function(e,t){}]);